{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bb976d52-ba96-4a8a-9b63-cebb35a05b74",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import numpy as np\n",
    "import tensorflow as tf\n",
    "from keras.layers import Input, Dense, Lambda, concatenate, BatchNormalization, Activation\n",
    "from keras.models import Model\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "import keras.backend as K"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c0754754-a1ee-4a97-b25c-1f4a32750ceb",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from drl import DRL\n",
    "from envs import TradingEnv\n",
    "from replay_buffer import PrioritizedReplayBuffer\n",
    "from schedules import LinearSchedule"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "28a94fb3-5288-450e-858d-c81528a6f854",
   "metadata": {},
   "outputs": [],
   "source": [
    "class DDPG(DRL):\n",
    "    \"\"\"\n",
    "    Deep Deterministic Policy Gradient\n",
    "    \"\"\"\n",
    "\n",
    "    def __init__(self, env):\n",
    "        super(DDPG, self).__init__()\n",
    "\n",
    "        self.sess = K.get_session()\n",
    "\n",
    "        self.env = env\n",
    "        self.upper_bound = self.env.action_space.high[0]\n",
    "        self.lower_bound = self.env.action_space.low[0]\n",
    "\n",
    "        # update rate for target model.\n",
    "        # for 2nd round training, use 0.000001 \n",
    "        self.TAU = 0.00001\n",
    "\n",
    "        # learning rate for actor and critic\n",
    "        # for 2nd round training, use 1e-5\n",
    "        self.actor_lr = 1e-4\n",
    "        self.critic_lr = 1e-4\n",
    "\n",
    "        # risk averse constant\n",
    "        self.ra_c = 1.5\n",
    "\n",
    "        # actor: policy function\n",
    "        # critic: Q functions; Q_ex, Q_ex2, and Q\n",
    "        self.actor = self._build_actor(learning_rate=self.actor_lr)\n",
    "        self.critic_Q_ex, self.critic_Q_ex2, self.critic_Q = self._build_critic(learning_rate=self.critic_lr)\n",
    "\n",
    "        self.critic_Q.summary()\n",
    "\n",
    "        # target networks for actor and three critics\n",
    "        self.actor_hat = self._build_actor(learning_rate=self.actor_lr)\n",
    "        self.actor_hat.set_weights(self.actor.get_weights())\n",
    "\n",
    "        self.critic_Q_ex_hat, self.critic_Q_ex2_hat, self.critic_Q_hat = self._build_critic(learning_rate=self.critic_lr)\n",
    "        self.critic_Q_ex_hat.set_weights(self.critic_Q_ex.get_weights())\n",
    "        self.critic_Q_ex2_hat.set_weights(self.critic_Q_ex2.get_weights())\n",
    "\n",
    "        # epsilon of epsilon-greedy\n",
    "        self.epsilon = 1.0\n",
    "\n",
    "        # discount rate for epsilon\n",
    "        self.epsilon_decay = 0.99994\n",
    "        # self.epsilon_decay = 0.9994\n",
    "\n",
    "        # min epsilon of epsilon-greedy.\n",
    "        self.epsilon_min = 0.1\n",
    "\n",
    "        # memory buffer for experience replay\n",
    "        buffer_size = 600000\n",
    "        prioritized_replay_alpha = 0.6\n",
    "        self.replay_buffer = PrioritizedReplayBuffer(buffer_size, alpha=prioritized_replay_alpha)\n",
    "\n",
    "        prioritized_replay_beta0 = 0.4\n",
    "\n",
    "        # need not be the same as training episode (see schedules.py)\n",
    "        prioritized_replay_beta_iters = 50001\n",
    "\n",
    "        self.beta_schedule = LinearSchedule(prioritized_replay_beta_iters,\n",
    "                                       initial_p=prioritized_replay_beta0,\n",
    "                                       final_p=1.0)\n",
    "\n",
    "        # for numerical stabiligy\n",
    "        self.prioritized_replay_eps = 1e-6\n",
    "\n",
    "        self.t = None\n",
    "\n",
    "        # memory sample batch size\n",
    "        self.batch_size = 128\n",
    "\n",
    "        # may use for 2nd round training\n",
    "        # self.policy_noise = 5\n",
    "        # self.noise_clip = 5\n",
    "\n",
    "        # gradient function\n",
    "        self.get_critic_grad = self.critic_gradient()\n",
    "        self.actor_optimizer()\n",
    "\n",
    "    def load(self, tag=\"\"):\n",
    "        \"\"\"load two Qs for test\"\"\"\n",
    "        if tag == \"\":\n",
    "            actor_file = \"model/ddpg_actor.h5\"\n",
    "            critic_Q_ex_file = \"model/ddpg_critic_Q_ex.h5\"\n",
    "            critic_Q_ex2_file = \"model/ddpg_critic_Q_ex2.h5\"\n",
    "        else:\n",
    "            actor_file = \"model/ddpg_actor_\" + tag + \".h5\"\n",
    "            critic_Q_ex_file = \"model/ddpg_critic_Q_ex_\" + tag + \".h5\"\n",
    "            critic_Q_ex2_file = \"model/ddpg_critic_Q_ex2_\" + tag + \".h5\"\n",
    "\n",
    "        if os.path.exists(actor_file):\n",
    "            self.actor.load_weights(actor_file)\n",
    "            self.actor_hat.load_weights(actor_file)\n",
    "        if os.path.exists(critic_Q_ex_file):\n",
    "            self.critic_Q_ex.load_weights(critic_Q_ex_file)\n",
    "            self.critic_Q_ex_hat.load_weights(critic_Q_ex_file)\n",
    "        if os.path.exists(critic_Q_ex2_file):\n",
    "            self.critic_Q_ex2.load_weights(critic_Q_ex2_file)\n",
    "            self.critic_Q_ex2_hat.load_weights(critic_Q_ex2_file)\n",
    "\n",
    "    def _build_actor(self, learning_rate=1e-3):\n",
    "        \"\"\"basic NN model.\n",
    "        \"\"\"\n",
    "        inputs = Input(shape=(self.env.num_state,))\n",
    "\n",
    "        # bn after input\n",
    "        x = BatchNormalization()(inputs)\n",
    "\n",
    "        # bn after activation\n",
    "        x = Dense(32, activation=\"relu\")(x)\n",
    "        x = BatchNormalization()(x)\n",
    "\n",
    "        x = Dense(64, activation=\"relu\")(x)\n",
    "        x = BatchNormalization()(x)\n",
    "\n",
    "        # no bn for output layer\n",
    "        x = Dense(1, activation=\"sigmoid\")(x)\n",
    "\n",
    "        output = Lambda(lambda x: x * self.env.num_contract * 100)(x)\n",
    "\n",
    "        model = Model(inputs=inputs, outputs=output)\n",
    "\n",
    "        # compile the model using mse loss, but won't use mse to train\n",
    "        model.compile(loss=\"mse\", optimizer=Adam(learning_rate))\n",
    "\n",
    "        return model\n",
    "\n",
    "    def _build_critic(self, learning_rate=1e-3):\n",
    "        \"\"\"basic NN model.\n",
    "        \"\"\"\n",
    "        # inputs\n",
    "        s_inputs = Input(shape=(self.env.num_state,))\n",
    "        a_inputs = Input(shape=(1,))\n",
    "\n",
    "        # combine inputs\n",
    "        x = concatenate([s_inputs, a_inputs])\n",
    "\n",
    "        # bn after input\n",
    "        x = BatchNormalization()(x)\n",
    "        \n",
    "        # Q_ex network\n",
    "\n",
    "        # bn after activation\n",
    "        x1 = Dense(32, activation=\"relu\")(x)\n",
    "        x1 = BatchNormalization()(x1)\n",
    "\n",
    "        x1 = Dense(64, activation=\"relu\")(x1)\n",
    "        x1 = BatchNormalization()(x1)\n",
    "\n",
    "        # no bn for output layer\n",
    "        output1 = Dense(1, activation=\"linear\")(x1)\n",
    "\n",
    "        model_Q_ex = Model(inputs=[s_inputs, a_inputs], outputs=output1)\n",
    "        model_Q_ex.compile(loss=\"mse\", optimizer=Adam(learning_rate))\n",
    "\n",
    "        # Q_ex2 network\n",
    "\n",
    "        # bn after activation\n",
    "        x2 = Dense(32, activation=\"relu\")(x)\n",
    "        x2 = BatchNormalization()(x2)\n",
    "\n",
    "        # bn after activation\n",
    "        x2 = Dense(64, activation=\"relu\")(x2)\n",
    "        x2 = BatchNormalization()(x2)\n",
    "\n",
    "        # no bn for output layer\n",
    "        output2 = Dense(1, activation=\"linear\")(x2)\n",
    "\n",
    "        model_Q_ex2 = Model(inputs=[s_inputs, a_inputs], outputs=output2)\n",
    "        model_Q_ex2.compile(loss=\"mse\", optimizer=Adam(learning_rate))\n",
    "\n",
    "        # Q\n",
    "        output3 = Lambda(lambda o: o[0] - self.ra_c * K.sqrt(K.max(o[1] - o[0] * o[0], 0)))([output1, output2])\n",
    "        model_Q = Model(inputs=[s_inputs, a_inputs], outputs=output3)\n",
    "        model_Q.compile(loss=\"mse\", optimizer=Adam(learning_rate))\n",
    "\n",
    "        return model_Q_ex, model_Q_ex2, model_Q\n",
    "\n",
    "    def actor_optimizer(self):\n",
    "        \"\"\"actor_optimizer.\n",
    "        Returns:\n",
    "            function, opt function for actor.\n",
    "        \"\"\"\n",
    "        self.ainput = self.actor.input\n",
    "        aoutput = self.actor.output\n",
    "        trainable_weights = self.actor.trainable_weights\n",
    "        self.action_gradient = tf.placeholder(tf.float32, shape=(None, 1))\n",
    "\n",
    "        # tf.gradients calculates dy/dx with a initial gradients for y\n",
    "        # action_gradient is dq/da, so this is dq/da * da/dparams\n",
    "        params_grad = tf.gradients(aoutput, trainable_weights, -self.action_gradient)\n",
    "        grads = zip(params_grad, trainable_weights)\n",
    "        self.opt = tf.train.AdamOptimizer(self.actor_lr).apply_gradients(grads)\n",
    "        self.sess.run(tf.global_variables_initializer())\n",
    "\n",
    "    def critic_gradient(self):\n",
    "        \"\"\"get critic gradient function.\n",
    "        Returns:\n",
    "            function, gradient function for critic.\n",
    "        \"\"\"\n",
    "        cinput = self.critic_Q.input\n",
    "        coutput = self.critic_Q.output\n",
    "\n",
    "        # compute the gradient of the action with q value, dq/da.\n",
    "        action_grads = K.gradients(coutput, cinput[1])\n",
    "\n",
    "        return K.function([cinput[0], cinput[1]], action_grads)\n",
    "\n",
    "    def egreedy_action(self, X):\n",
    "        \"\"\"get actor action with ou noise.\n",
    "        Arguments:\n",
    "            X: state value.\n",
    "        \"\"\"\n",
    "        # do the epsilon greedy way; not using OU\n",
    "        if np.random.rand() <= self.epsilon:\n",
    "            action = env.action_space.sample()\n",
    "\n",
    "            # may use for 2nd round training\n",
    "            # action = self.actor.predict(X)[0][0]\n",
    "            # noise = np.clip(np.random.normal(0, self.policy_noise), -self.noise_clip, self.noise_clip)\n",
    "            # action = np.clip(action + noise, 0, self.env.num_contract * 100)\n",
    "        else:\n",
    "            action = self.actor.predict(X)[0][0]\n",
    "\n",
    "        return action, None, None\n",
    "\n",
    "    def update_epsilon(self):\n",
    "        \"\"\"update epsilon\n",
    "        \"\"\"\n",
    "        if self.epsilon >= self.epsilon_min:\n",
    "            self.epsilon *= self.epsilon_decay\n",
    "\n",
    "    def remember(self, state, action, reward, next_state, done):\n",
    "        \"\"\"add data to experience replay.\n",
    "        Arguments:\n",
    "            state: observation\n",
    "            action: action\n",
    "            reward: reward\n",
    "            next_state: next_observation\n",
    "            done: if game is done.\n",
    "        \"\"\"\n",
    "        self.replay_buffer.add(state, action, reward, next_state, done)\n",
    "\n",
    "    def process_batch(self, batch_size):\n",
    "        \"\"\"process batch data\n",
    "        Arguments:\n",
    "            batch: batch size\n",
    "        Returns:\n",
    "            states: batch of states\n",
    "            actions: batch of actions\n",
    "            target_q_ex, target_q_ex2: batch of targets;\n",
    "            weights: priority weights\n",
    "        \"\"\"\n",
    "        # prioritized sample from experience replay buffer\n",
    "        experience = self.replay_buffer.sample(batch_size, beta=self.beta_schedule.value(self.t))\n",
    "        (states, actions, rewards, next_states, dones, weights, batch_idxes) = experience\n",
    "\n",
    "        actions = actions.reshape(-1, 1)\n",
    "        rewards = rewards.reshape(-1, 1)\n",
    "        dones = dones.reshape(-1, 1)\n",
    "\n",
    "        # get next_actions\n",
    "        next_actions = self.actor_hat.predict(next_states)\n",
    "\n",
    "        # prepare targets for Q_ex and Q_ex2 training\n",
    "        q_ex_next = self.critic_Q_ex_hat.predict([next_states, next_actions])\n",
    "        q_ex2_next = self.critic_Q_ex2_hat.predict([next_states, next_actions])\n",
    "\n",
    "        target_q_ex = rewards + (1 - dones) * q_ex_next\n",
    "        target_q_ex2 = rewards ** 2 + (1 - dones) * (2 * rewards * q_ex_next + q_ex2_next)\n",
    "\n",
    "        # use Q2 TD error as priority weight\n",
    "        td_errors = self.critic_Q_ex2.predict([states, actions]) - target_q_ex2\n",
    "        new_priorities = (np.abs(td_errors) + self.prioritized_replay_eps).flatten()\n",
    "        self.replay_buffer.update_priorities(batch_idxes, new_priorities)\n",
    "\n",
    "        return states, actions, target_q_ex, target_q_ex2, weights\n",
    "\n",
    "    def update_model(self, X1, X2, y1, y2, weights):\n",
    "        \"\"\"update ddpg model.\n",
    "        Arguments:\n",
    "            X1: states\n",
    "            X2: actions\n",
    "            y1: target for Q_ex\n",
    "            y2: target for Q_ex2\n",
    "            weights: priority weights\n",
    "        Returns:\n",
    "            loss_ex: critic Q_ex loss\n",
    "            loss_ex2: critic Q_ex2 loss\n",
    "        \"\"\"\n",
    "        # flatten to prepare for training with weights\n",
    "        weights = weights.flatten()\n",
    "\n",
    "        # default batch size is 32\n",
    "        loss_ex = self.critic_Q_ex.fit([X1, X2], y1, sample_weight=weights, verbose=0)\n",
    "        loss_ex = np.mean(loss_ex.history['loss'])\n",
    "\n",
    "        # default batch size is 32\n",
    "        loss_ex2 = self.critic_Q_ex2.fit([X1, X2], y2, sample_weight=weights, verbose=0)\n",
    "        loss_ex2 = np.mean(loss_ex2.history['loss'])\n",
    "\n",
    "        X3 = self.actor.predict(X1)\n",
    "\n",
    "        a_grads = np.array(self.get_critic_grad([X1, X3]))[0]\n",
    "        self.sess.run(self.opt, feed_dict={\n",
    "            self.ainput: X1,\n",
    "            self.action_gradient: a_grads\n",
    "        })\n",
    "\n",
    "        return loss_ex, loss_ex2\n",
    "\n",
    "    def update_target_model(self):\n",
    "        \"\"\"soft update target model.\n",
    "        \"\"\"\n",
    "        critic_Q_ex_weights = self.critic_Q_ex.get_weights()\n",
    "        critic_Q_ex2_weights = self.critic_Q_ex2.get_weights()\n",
    "        actor_weights = self.actor.get_weights()\n",
    "\n",
    "        critic_Q_ex_hat_weights = self.critic_Q_ex_hat.get_weights()\n",
    "        critic_Q_ex2_hat_weights = self.critic_Q_ex2_hat.get_weights()\n",
    "        actor_hat_weights = self.actor_hat.get_weights()\n",
    "\n",
    "        for i in range(len(critic_Q_ex_weights)):\n",
    "            critic_Q_ex_hat_weights[i] = self.TAU * critic_Q_ex_weights[i] + (1 - self.TAU) * critic_Q_ex_hat_weights[i]\n",
    "\n",
    "        for i in range(len(critic_Q_ex2_weights)):\n",
    "            critic_Q_ex2_hat_weights[i] = self.TAU * critic_Q_ex2_weights[i] + (1 - self.TAU) * critic_Q_ex2_hat_weights[i]\n",
    "\n",
    "        for i in range(len(actor_weights)):\n",
    "            actor_hat_weights[i] = self.TAU * actor_weights[i] + (1 - self.TAU) * actor_hat_weights[i]\n",
    "\n",
    "        self.critic_Q_ex_hat.set_weights(critic_Q_ex_hat_weights)\n",
    "        self.critic_Q_ex2_hat.set_weights(critic_Q_ex2_hat_weights)\n",
    "        self.actor_hat.set_weights(actor_hat_weights)\n",
    "\n",
    "    def train(self, episode):\n",
    "        \"\"\"training\n",
    "        Arguments:\n",
    "            episode: total episodes to run\n",
    "\n",
    "        Returns:\n",
    "            history: training history\n",
    "        \"\"\"\n",
    "\n",
    "        # some statistics\n",
    "        history = {\"episode\": [], \"episode_w_T\": [], \"loss_ex\": [], \"loss_ex2\": []}\n",
    "\n",
    "        for i in range(episode):\n",
    "            observation = self.env.reset()\n",
    "            done = False\n",
    "\n",
    "            # for recording purpose\n",
    "            y_action = np.empty(0, dtype=int)\n",
    "            reward_store = np.empty(0)\n",
    "\n",
    "            self.t = i\n",
    "\n",
    "            # steps in an episode\n",
    "            while not done:\n",
    "\n",
    "                # prepare state\n",
    "                x = np.array(observation).reshape(1, -1)\n",
    "\n",
    "                # chocie action from epsilon-greedy.\n",
    "                action, _, _ = self.egreedy_action(x)\n",
    "\n",
    "                # one step\n",
    "                observation, reward, done, info = self.env.step(action)\n",
    "\n",
    "                # record action and reward\n",
    "                y_action = np.append(y_action, action)\n",
    "                reward_store = np.append(reward_store, reward)\n",
    "\n",
    "                # store to memory\n",
    "                self.remember(x[0], action, reward, observation, done)\n",
    "\n",
    "                if len(self.replay_buffer) > self.batch_size:\n",
    "\n",
    "                    # draw from memory\n",
    "                    X1, X2, y_ex, y_ex2, weights = self.process_batch(self.batch_size)\n",
    "\n",
    "                    # update model\n",
    "                    loss_ex, loss_ex2 = self.update_model(X1, X2, y_ex, y_ex2, weights)\n",
    "\n",
    "                    # soft update target\n",
    "                    self.update_target_model()\n",
    "\n",
    "            # reduce epsilon per episode\n",
    "            self.update_epsilon()\n",
    "\n",
    "            # print/store some statistics every 1000 episodes\n",
    "            if i % 1000 == 0 and i != 0:\n",
    "\n",
    "            # may want to print/store some statistics every 100 episodes\n",
    "            # if i % 100 == 0 and i >= 1000:\n",
    "\n",
    "                # get w_T for statistics\n",
    "                w_T = np.sum(reward_store)\n",
    "\n",
    "                history[\"episode\"].append(i)\n",
    "                history[\"episode_w_T\"].append(w_T)\n",
    "                history[\"loss_ex\"].append(loss_ex)\n",
    "                history[\"loss_ex2\"].append(loss_ex2)\n",
    "\n",
    "                path_row = info[\"path_row\"]\n",
    "                print(info)\n",
    "                print(\n",
    "                    \"episode: {} | episode final wealth: {:.3f} | loss_ex: {:.3f} | loss_ex2: {:.3f} | epsilon:{:.2f}\".format(\n",
    "                        i, w_T, loss_ex, loss_ex2, self.epsilon\n",
    "                    )\n",
    "                )\n",
    "\n",
    "                with np.printoptions(precision=2, suppress=True):\n",
    "                    print(\"episode: {} | rewards {}\".format(i, reward_store))\n",
    "                    print(\"episode: {} | actions taken {}\".format(i, y_action))\n",
    "                    print(\"episode: {} | deltas {}\".format(i, self.env.delta_path[path_row] * 100))\n",
    "                    print(\"episode: {} | stock price {}\".format(i, self.env.path[path_row]))\n",
    "                    print(\"episode: {} | option price {}\\n\".format(i, self.env.option_price_path[path_row] * 100))\n",
    "\n",
    "                # may want to save model every 100 episode\n",
    "                # if i % 100 == 0:\n",
    "                #     self.actor.save_weights(\"model/ddpg_actor_\" + str(int(i/100)) + \".h5\")\n",
    "                #     self.critic_Q_ex.save_weights(\"model/ddpg_critic_Q_ex_\" + str(int(i/100)) + \".h5\")\n",
    "                #     self.critic_Q_ex2.save_weights(\"model/ddpg_critic_Q_ex2_\" + str(int(i/100)) + \".h5\")\n",
    "                self.actor.save_weights(\"model/ddpg_actor_\" + str(int(i/1000)) + \".h5\")\n",
    "                self.critic_Q_ex.save_weights(\"model/ddpg_critic_Q_ex_\" + str(int(i/1000)) + \".h5\")\n",
    "                self.critic_Q_ex2.save_weights(\"model/ddpg_critic_Q_ex2_\" + str(int(i/1000)) + \".h5\")\n",
    "\n",
    "        # save weights once training is done\n",
    "        self.actor.save_weights(\"model/ddpg_actor.h5\")\n",
    "        self.critic_Q_ex.save_weights(\"model/ddpg_critic_Q_ex.h5\")\n",
    "        self.critic_Q_ex2.save_weights(\"model/ddpg_critic_Q_ex2.h5\")\n",
    "\n",
    "        return history\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "205d93bc-33b6-4d3c-9d53-3eec35b4c79f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found GPU at: /device:GPU:0\n"
     ]
    }
   ],
   "source": [
    "device_name = tf.test.gpu_device_name()\n",
    "if device_name != '/device:GPU:0':\n",
    "  raise SystemError('GPU device not found')\n",
    "print('Found GPU at: {}'.format(device_name))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "883c0d44-84af-4392-aaac-7d0ae7dd7d83",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:From C:\\Users\\nidhi\\anaconda3\\lib\\site-packages\\tensorflow\\python\\compat\\v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.\n",
      "Instructions for updating:\n",
      "non-resource variables are not supported in the long term\n"
     ]
    }
   ],
   "source": [
    "# tf.compat.v1.disable_eager_execution()\n",
    "import tensorflow.compat.v1 as tf\n",
    "tf.disable_v2_behavior()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "319f9a0b-4105-4d5d-aba9-5ca59c055386",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1. generate asset price paths (sabr)\n",
      "2. generate BS price, BS delta, and Bartlett delta\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\nidhi\\Hedging\\utils.py:135: RuntimeWarning: invalid value encountered in true_divide\n",
      "  SABRIV = np.where(F == K, vol * B / (F ** (1 - beta)), A * B * Phi / Chi)\n",
      "C:\\Users\\nidhi\\Hedging\\utils.py:155: RuntimeWarning: divide by zero encountered in true_divide\n",
      "  d1 = (np.log(S / K) + (r - q + iv * iv / 2) * T) / (iv * np.sqrt(T))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "simulation done!\n",
      "WARNING:tensorflow:From C:\\Users\\nidhi\\anaconda3\\lib\\site-packages\\keras\\layers\\normalization\\batch_normalization.py:532: _colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
      "Instructions for updating:\n",
      "Colocations handled automatically by placer.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\nidhi\\anaconda3\\lib\\site-packages\\gym\\spaces\\box.py:73: UserWarning: \u001b[33mWARN: Box bound precision lowered by casting to float32\u001b[0m\n",
      "  logger.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"model_3\"\n",
      "__________________________________________________________________________________________________\n",
      " Layer (type)                   Output Shape         Param #     Connected to                     \n",
      "==================================================================================================\n",
      " input_2 (InputLayer)           [(None, 3)]          0           []                               \n",
      "                                                                                                  \n",
      " input_3 (InputLayer)           [(None, 1)]          0           []                               \n",
      "                                                                                                  \n",
      " concatenate (Concatenate)      (None, 4)            0           ['input_2[0][0]',                \n",
      "                                                                  'input_3[0][0]']                \n",
      "                                                                                                  \n",
      " batch_normalization_3 (BatchNo  (None, 4)           16          ['concatenate[0][0]']            \n",
      " rmalization)                                                                                     \n",
      "                                                                                                  \n",
      " dense_3 (Dense)                (None, 32)           160         ['batch_normalization_3[0][0]']  \n",
      "                                                                                                  \n",
      " dense_6 (Dense)                (None, 32)           160         ['batch_normalization_3[0][0]']  \n",
      "                                                                                                  \n",
      " batch_normalization_4 (BatchNo  (None, 32)          128         ['dense_3[0][0]']                \n",
      " rmalization)                                                                                     \n",
      "                                                                                                  \n",
      " batch_normalization_6 (BatchNo  (None, 32)          128         ['dense_6[0][0]']                \n",
      " rmalization)                                                                                     \n",
      "                                                                                                  \n",
      " dense_4 (Dense)                (None, 64)           2112        ['batch_normalization_4[0][0]']  \n",
      "                                                                                                  \n",
      " dense_7 (Dense)                (None, 64)           2112        ['batch_normalization_6[0][0]']  \n",
      "                                                                                                  \n",
      " batch_normalization_5 (BatchNo  (None, 64)          256         ['dense_4[0][0]']                \n",
      " rmalization)                                                                                     \n",
      "                                                                                                  \n",
      " batch_normalization_7 (BatchNo  (None, 64)          256         ['dense_7[0][0]']                \n",
      " rmalization)                                                                                     \n",
      "                                                                                                  \n",
      " dense_5 (Dense)                (None, 1)            65          ['batch_normalization_5[0][0]']  \n",
      "                                                                                                  \n",
      " dense_8 (Dense)                (None, 1)            65          ['batch_normalization_7[0][0]']  \n",
      "                                                                                                  \n",
      " lambda_1 (Lambda)              (None, 1)            0           ['dense_5[0][0]',                \n",
      "                                                                  'dense_8[0][0]']                \n",
      "                                                                                                  \n",
      "==================================================================================================\n",
      "Total params: 5,458\n",
      "Trainable params: 5,066\n",
      "Non-trainable params: 392\n",
      "__________________________________________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "env = TradingEnv(continuous_action_flag=True, sabr_flag=True, dg_random_seed=1, init_ttm=20, trade_freq=1, spread=0.01, num_contract=1, num_sim=50002)\n",
    "ddpg = DDPG(env)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "dac7b689-614b-4cc9-abbf-19151487ac48",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\nidhi\\AppData\\Local\\Temp/ipykernel_15040/901092598.py:364: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  x = np.array(observation).reshape(1, -1)\n",
      "C:\\Users\\nidhi\\Hedging\\replay_buffer.py:45: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  obses_tp1.append(np.array(obs_tp1, copy=False))\n",
      "C:\\Users\\nidhi\\anaconda3\\lib\\site-packages\\keras\\engine\\training_v1.py:2079: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.\n",
      "  updates=self.state_updates,\n",
      "C:\\Users\\nidhi\\Hedging\\replay_buffer.py:47: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  return np.array(obses_t), np.array(actions), np.array(rewards), np.array(obses_tp1), np.array(dones)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'path_row': 1000}\n",
      "episode: 1000 | episode final wealth: -1073.068 | loss_ex: 233.816 | loss_ex2: 10608262.250 | epsilon:0.94\n",
      "episode: 1000 | rewards [ -49.14  -36.1  -187.42  -47.76    6.84   14.86    8.07   -7.24  -87.67\n",
      " -148.71  -54.25  -22.82    4.76  -43.29  -50.78  -26.05 -127.55  -38.35\n",
      "   14.91 -195.38]\n",
      "episode: 1000 | actions taken [54.01 19.19 83.65 37.02 34.35 61.11 48.56 22.   25.19  1.18 36.97 53.77\n",
      " 56.46 98.75 70.64 96.48 64.02 74.86  4.18 94.02]\n",
      "episode: 1000 | deltas [ 51.13  56.05  57.68  34.25  32.55  29.61  39.67  49.18  43.69  69.72\n",
      "  84.51  88.26  88.75  90.06  89.22  96.66  98.25  99.99 100.   100.\n",
      " 100.  ]\n",
      "episode: 1000 | stock price [100.   100.69 100.9   97.69  97.42  97.16  98.56  99.8   99.18 102.15\n",
      " 103.95 104.39 104.53 104.45 103.87 105.06 105.34 107.98 109.04 108.08\n",
      " 107.6 ]\n",
      "episode: 1000 | option price [225.84 258.41 263.45 117.18 109.58  90.91 136.05 175.51 142.61 302.07\n",
      " 428.38 461.8  474.33 462.59 404.22 509.45 535.88 798.26 904.23 808.24\n",
      " 759.77]\n",
      "\n",
      "{'path_row': 2000}\n",
      "episode: 2000 | episode final wealth: -447.248 | loss_ex: 109.513 | loss_ex2: 5319292.938 | epsilon:0.89\n",
      "episode: 2000 | rewards [-69.55  10.08  -0.4    4.97  -6.01 -16.55  -9.27 -65.38  24.11 -27.69\n",
      " -34.03 -60.    -4.49 -57.91 -26.26 -30.77 -25.95  30.68  -0.6  -82.24]\n",
      "episode: 2000 | actions taken [82.19 71.91 13.33 21.22  3.89 22.56 81.25 32.46 73.07 42.24 14.14 68.69\n",
      " 63.14  9.8  37.33 27.3  20.61 20.96 43.08 51.87]\n",
      "episode: 2000 | deltas [51.13 49.69 50.83 37.96 29.81 26.69 20.11 23.9  14.69 19.89 20.49 32.58\n",
      " 27.34 25.13 31.26 27.17  5.97  0.97  2.28  0.48  0.  ]\n",
      "episode: 2000 | stock price [100.    99.82  99.99  98.55  97.59  97.24  96.36  97.05  95.7   96.72\n",
      "  96.81  98.39  98.02  97.91  98.56  98.28  96.08  94.87  96.38  96.84\n",
      "  96.37]\n",
      "episode: 2000 | option price [225.84 198.77 189.99 112.72  79.57  67.3   45.83  54.84  29.18  40.6\n",
      "  42.09  71.29  52.32  44.53  56.51  45.16   6.22   0.69   1.49   0.18\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 3000}\n",
      "episode: 3000 | episode final wealth: -575.447 | loss_ex: 103.912 | loss_ex2: 4350496.750 | epsilon:0.84\n",
      "episode: 3000 | rewards [ -46.54  -46.98   -6.42    5.29   -1.42    3.06   -2.27   -7.39    8.06\n",
      "   -7.01  -53.6    36.35  -54.24  -60.56  -84.82  -13.96   95.26 -172.06\n",
      "  -92.07  -74.15]\n",
      "episode: 3000 | actions taken [17.07 72.51 75.86 70.1  67.45 66.28 67.74 65.63 66.46 82.63 52.23 30.19\n",
      " 81.06 67.52 18.77 58.58 16.43  8.32 64.57 73.54]\n",
      "episode: 3000 | deltas [ 51.13  57.24  55.83  55.51  62.46  68.29  80.02  78.38  83.36  83.77\n",
      "  80.76  88.45  85.65  90.67  97.83  98.93  98.96  97.03  99.96 100.\n",
      " 100.  ]\n",
      "episode: 3000 | stock price [100.   100.87 100.64 100.6  101.56 102.42 104.03 103.82 104.55 104.4\n",
      " 103.54 104.49 103.59 104.27 106.07 106.5  105.82 104.12 105.94 106.85\n",
      " 106.34]\n",
      "episode: 3000 | option price [225.84 270.13 244.36 244.56 300.85 357.92 459.73 446.47 500.02 480.72\n",
      " 399.66 471.82 385.16 441.61 609.94 651.04 582.56 414.87 593.54 685.24\n",
      " 633.67]\n",
      "\n",
      "{'path_row': 4000}\n",
      "episode: 4000 | episode final wealth: -852.634 | loss_ex: 80.996 | loss_ex2: 9559875.875 | epsilon:0.79\n",
      "episode: 4000 | rewards [ -26.92  -23.06  -42.83   -1.73  -19.65  -34.44   44.98  -59.66  -75.18\n",
      "  -55.36  -28.18  -12.5   -27.57  -15.36   41.81  -54.11  -68.68 -105.8\n",
      " -117.75 -170.65]\n",
      "episode: 4000 | actions taken [33.65 65.79 34.26 50.66  1.36 40.3  33.07  4.07 81.17 48.08 19.81 33.15\n",
      " 49.95 53.08 62.04 17.25 41.7   3.31  2.65 85.77]\n",
      "episode: 4000 | deltas [ 51.13  55.97  64.96  66.89  61.8   58.54  65.08  43.07  51.7   48.68\n",
      "  31.61  34.46  43.96  31.82  23.46  33.62  46.36  80.23  92.86  99.82\n",
      " 100.  ]\n",
      "episode: 4000 | stock price [100.   100.64 101.85 102.14 101.39 100.94 101.62  99.14 100.09  99.8\n",
      "  97.99  98.36  99.36  98.2   97.45  98.63  99.71 102.13 103.05 104.32\n",
      " 103.96]\n",
      "episode: 4000 | option price [225.84 240.8  310.55 331.18 278.39 247.45 270.01 135.43 170.23 144.36\n",
      "  79.81  87.58 120.11  73.33  45.76  68.05  96.65 242.13 311.75 432.19\n",
      " 395.95]\n",
      "\n",
      "{'path_row': 5000}\n",
      "episode: 5000 | episode final wealth: -832.880 | loss_ex: 62.269 | loss_ex2: 2779375.375 | epsilon:0.74\n",
      "episode: 5000 | rewards [-133.48   -3.95   -5.06   -9.2     3.14  -14.21   25.69  -55.79  146.65\n",
      "  -11.88   25.05  -65.5   -36.61  -82.58    0.16  -24.5  -150.28  -84.98\n",
      " -212.92 -142.64]\n",
      "episode: 5000 | actions taken [90.19 71.9  55.15 49.44 37.33 41.92 64.04 84.72 93.28 36.75 84.27 37.02\n",
      " 90.85 26.76 54.6  84.18  0.89 56.44  8.38 69.5 ]\n",
      "episode: 5000 | deltas [ 51.13  43.9   42.33  41.63  37.88  38.54  28.51  38.54  33.99  64.32\n",
      "  43.96  62.89  74.31  83.64  89.34  86.9   86.65  95.92  99.51 100.\n",
      " 100.  ]\n",
      "episode: 5000 | stock price [100.    98.98  98.86  98.85  98.39  98.61  97.4   98.69  98.1  101.5\n",
      "  99.29 101.18 102.19 103.06 103.47 102.79 102.5  103.28 103.98 105.76\n",
      " 105.91]\n",
      "episode: 5000 | option price [225.84 176.92 154.59 142.31 123.08 116.17  75.4  110.24  95.7  257.88\n",
      " 131.23 218.71 273.63 334.6  362.07 295.74 265.4  331.02 398.24 576.13\n",
      " 590.57]\n",
      "\n",
      "{'path_row': 6000}\n",
      "episode: 6000 | episode final wealth: -496.860 | loss_ex: 73.420 | loss_ex2: 7095911.875 | epsilon:0.70\n",
      "episode: 6000 | rewards [ -29.22  -78.43   63.59   22.32 -141.33    2.31  -46.88  -20.13  -36.18\n",
      "  -28.08  122.51  -55.37   40.9    -8.11   -3.9    13.41  -11.36 -135.47\n",
      "  -57.5  -109.94]\n",
      "episode: 6000 | actions taken [27.36 80.44 90.8  93.47 35.3  49.51 44.81 60.79 76.68 70.89  3.33 52.3\n",
      " 52.63 73.01 71.48 69.47 65.33  6.11 57.18 79.21]\n",
      "episode: 6000 | deltas [ 51.13  56.29  45.83  59.01  65.42  84.48  83.05  90.5   93.23  97.47\n",
      "  99.16  97.12  98.14  97.08  96.41  98.03  98.5   99.72 100.   100.\n",
      " 100.  ]\n",
      "episode: 6000 | stock price [100.   100.7   99.37 100.94 101.71 104.14 103.75 104.87 105.13 106.29\n",
      " 107.12 105.08 105.19 104.3  103.8  103.94 103.45 103.68 104.47 104.56\n",
      " 104.75]\n",
      "episode: 6000 | option price [225.84 246.75 164.93 233.76 281.02 448.68 412.34 504.78 523.78 631.97\n",
      " 713.11 511.43 521.1  433.04 383.06 395.35 345.87 367.69 446.58 456.26\n",
      " 475.24]\n",
      "\n",
      "{'path_row': 7000}\n",
      "episode: 7000 | episode final wealth: -743.569 | loss_ex: 44.944 | loss_ex2: 3296018.500 | epsilon:0.66\n",
      "episode: 7000 | rewards [ -27.29   17.8   -23.06  -16.97  -94.95  -40.3     9.62  -27.76  -16.05\n",
      "    1.09  -54.24 -160.56   29.88   -9.62  -74.41  -51.7    42.93   -2.35\n",
      "  -75.69 -169.92]\n",
      "episode: 7000 | actions taken [12.95 95.34 71.43 76.91 78.48 24.8  20.6  42.63  9.56  8.74 46.98 82.95\n",
      " 74.21 36.81 70.97 46.15 27.29 52.87 95.3  85.42]\n",
      "episode: 7000 | deltas [51.13 53.31 71.81 69.92 63.19 34.67 34.36 26.21 21.88  7.58  6.24  3.69\n",
      "  0.77  0.55  0.73  0.24  0.02  0.11  0.02  0.    0.  ]\n",
      "episode: 7000 | stock price [100.   100.31 103.01 102.68 101.68  97.94  98.06  97.1   96.58  94.2\n",
      "  94.06  93.57  91.99  92.5   93.18  92.57  91.95  94.16  94.57  94.19\n",
      "  93.25]\n",
      "episode: 7000 | option price [225.84 244.22 401.04 376.   310.15 110.04 100.85  67.28  51.62  12.94\n",
      "   9.88   5.01   0.79   0.48   0.64   0.18   0.01   0.06   0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 8000}\n",
      "episode: 8000 | episode final wealth: -703.598 | loss_ex: 46.920 | loss_ex2: 3887726.750 | epsilon:0.62\n",
      "episode: 8000 | rewards [-114.54   31.86   57.7   -90.54   77.02  -30.2   -78.67   32.14  -85.78\n",
      "   19.63  -61.63   11.62  -19.18 -236.58  -85.04    9.06    5.04    2.96\n",
      "  -19.42 -129.05]\n",
      "episode: 8000 | actions taken [67.04 80.99 82.1  84.85 79.6  14.66 78.35 73.11  3.61  2.05 61.9  59.66\n",
      " 62.03 36.26 71.41 62.32 79.35 78.78 94.3  80.9 ]\n",
      "episode: 8000 | deltas [ 51.13  38.54  43.04  56.05  37.7   52.67  46.74  43.    54.7   59.07\n",
      "  58.25  71.53  55.21  85.22  99.18  99.94  99.96  99.96 100.   100.\n",
      " 100.  ]\n",
      "episode: 8000 | stock price [100.    98.15  98.91 100.68  98.23 100.21  99.51  99.07 100.44 100.91\n",
      " 100.76 102.18 100.42 103.56 107.27 108.95 108.45 107.31 107.14 107.63\n",
      " 109.02]\n",
      "episode: 8000 | option price [225.84 149.42 165.09 251.71 131.44 207.03 161.94 142.72 205.19 222.86\n",
      " 201.35 290.75 171.84 383.45 727.74 895.33 845.04 731.17 714.42 763.43\n",
      " 901.84]\n",
      "\n",
      "{'path_row': 9000}\n",
      "episode: 9000 | episode final wealth: -307.482 | loss_ex: 34.755 | loss_ex2: 2521394.875 | epsilon:0.58\n",
      "episode: 9000 | rewards [  40.96    7.88    1.18   36.94  -80.79  -10.02  -83.24 -137.96   40.93\n",
      "  107.19  -67.16    6.28  -14.05   -1.04  -11.89  -21.69  -12.71  -46.55\n",
      "  -40.5   -21.23]\n",
      "episode: 9000 | actions taken [ 4.64  7.71  3.73 14.11 37.99 24.12 99.76 86.97 50.42 80.75 14.36 21.59\n",
      " 54.21 47.72 40.8  75.03 39.75 43.64 35.65 43.76]\n",
      "episode: 9000 | deltas [51.13 44.13 46.32 46.48 30.01 10.48 10.48  9.92  4.94  8.49 18.8  25.73\n",
      " 23.94 23.47 21.95 14.6  13.45 13.7   2.09  0.01  0.  ]\n",
      "episode: 9000 | stock price [100.    99.03  99.43  99.47  97.41  94.19  94.3   94.17  92.59  94.21\n",
      "  96.21  97.29  97.39  97.61  97.6   97.05  97.16  97.64  96.36  95.41\n",
      "  96.06]\n",
      "episode: 9000 | option price [225.84 175.73 167.91 162.94  86.6   21.68  21.3   19.88   8.63  15.43\n",
      "  41.46  60.3   49.06  43.15  37.31  20.18  16.8   14.49   1.34   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 10000}\n",
      "episode: 10000 | episode final wealth: -690.480 | loss_ex: 30.610 | loss_ex2: 1795511.594 | epsilon:0.55\n",
      "episode: 10000 | rewards [ -58.91  -48.73  -54.21  -58.5    -0.05  -65.61 -113.    -51.22   12.46\n",
      " -130.1    42.43  -40.31   14.17  162.52  -88.12  -68.32 -117.3    45.67\n",
      "   -0.74  -72.61]\n",
      "episode: 10000 | actions taken [ 3.82 55.61 72.97 76.68 71.64 63.34 95.77 52.55 97.49 53.82 57.9  72.59\n",
      " 41.44 57.97 44.67 95.73 44.55 24.68 22.66 18.01]\n",
      "episode: 10000 | deltas [51.13 58.69 44.81 34.09 23.6  22.97 15.1   9.01  7.47  9.03  2.99  3.75\n",
      "  2.17  3.47 23.9   4.08  2.04  0.1   1.77  0.06  0.  ]\n",
      "episode: 10000 | stock price [100.   101.09  99.16  97.78  96.45  96.46  95.15  94.12  93.84  94.44\n",
      "  92.56  93.37  92.97  94.05  97.78  95.25  95.02  93.44  96.08  96.09\n",
      "  93.24]\n",
      "episode: 10000 | option price [225.84 285.08 174.19 111.04  63.37  59.39  34.34  17.18  13.39  16.37\n",
      "   4.29   5.26   2.65   4.27  42.02   4.32   1.75   0.06   1.16   0.02\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 11000}\n",
      "episode: 11000 | episode final wealth: -392.933 | loss_ex: 31.166 | loss_ex2: 1974199.156 | epsilon:0.52\n",
      "episode: 11000 | rewards [-113.21  -42.26  -18.58  -18.13   19.46   -8.87  -11.34   32.88   -8.46\n",
      "  -17.9    -5.54  -26.2   -71.02 -125.17   49.91  -41.7    -1.5    35.92\n",
      "   16.07  -37.29]\n",
      "episode: 11000 | actions taken [ 4.15 54.99 81.52 63.44 65.9  72.06 75.2  73.52 95.1  70.69 78.83 21.43\n",
      " 97.09 18.72 44.44 66.01 77.09 48.44 28.9  19.54]\n",
      "episode: 11000 | deltas [ 51.13  66.15  59.63  61.69  53.34  72.82  65.98  56.71  77.13  81.31\n",
      "  81.89  85.31  81.87  83.32  90.29  76.86  92.91  94.33  80.91  81.17\n",
      " 100.  ]\n",
      "episode: 11000 | stock price [100.   102.15 101.18 101.46 100.3  102.82 101.87 100.67 102.95 103.32\n",
      " 103.2  103.53 103.01 102.88 103.61 101.84 103.24 102.92 101.4  100.98\n",
      " 101.22]\n",
      "episode: 11000 | option price [225.84 343.81 280.87 295.19 221.66 365.9  299.7  217.63 350.53 372.04\n",
      " 356.63 379.3  334.98 315.82 373.95 218.69 330.95 296.28 157.51 109.35\n",
      " 122.18]\n",
      "\n",
      "{'path_row': 12000}\n",
      "episode: 12000 | episode final wealth: -763.853 | loss_ex: 30.365 | loss_ex2: 4516232.656 | epsilon:0.49\n",
      "episode: 12000 | rewards [ -64.25   18.43  -20.9   -33.49  -45.26   30.9   -47.54   64.65  -22.24\n",
      "    2.85  -27.19    9.57   -1.09  -90.11    4.8  -306.02 -103.07   -0.78\n",
      "  -74.69  -58.41]\n",
      "episode: 12000 | actions taken [67.47 70.72 14.48 17.47 92.62 88.52 47.74 42.41 64.87 57.51 69.5  78.71\n",
      " 85.43 35.55 71.05 12.61 78.04 19.01 36.95 31.89]\n",
      "episode: 12000 | deltas [ 51.13  50.89  59.33  54.32  62.34  69.02  91.49  92.11  87.67  87.75\n",
      "  87.37  90.61  85.6   85.74  92.38  79.04  97.74  99.87  99.91 100.\n",
      " 100.  ]\n",
      "episode: 12000 | stock price [100.    99.97 101.15 100.44 101.47 102.3  106.33 106.44 105.03 105.01\n",
      " 104.76 105.51 104.1  103.86 104.7  102.39 105.6  107.26 106.49 107.37\n",
      " 107.64]\n",
      "episode: 12000 | option price [225.84 220.58 282.44 236.12 284.65 330.51 651.97 661.68 531.57 528.6\n",
      " 503.68 570.51 440.59 413.98 482.23 276.02 562.66 725.76 648.56 736.75\n",
      " 764.13]\n",
      "\n",
      "{'path_row': 13000}\n",
      "episode: 13000 | episode final wealth: -639.666 | loss_ex: 21.955 | loss_ex2: 1781734.969 | epsilon:0.46\n",
      "episode: 13000 | rewards [  -6.81  -27.11  -64.17  -23.68    4.44  -28.37  -46.21  -54.     -1.39\n",
      "   -3.09    3.1     1.34 -224.19  -35.17   63.91  -43.94  -63.27  -60.58\n",
      "  -24.43   -6.03]\n",
      "episode: 13000 | actions taken [ 6.05 12.19 71.3  73.9  72.87 39.99 87.45  2.9  15.37 10.59 11.73 12.89\n",
      " 93.07 48.37 45.34 78.73 40.77 33.02 13.14  3.67]\n",
      "episode: 13000 | deltas [51.13 52.16 55.69 53.53 46.24 43.7  35.03 33.58 27.61  8.73  9.95  9.43\n",
      "  7.27  2.54  2.21  4.25  3.09  1.01  0.01  0.    0.  ]\n",
      "episode: 13000 | stock price [100.   100.15 100.64 100.34  99.34  99.06  97.98  97.87  97.32  94.38\n",
      "  94.75  94.93  94.73  93.06  93.18  94.7   94.53  93.79  92.15  91.69\n",
      "  93.34]\n",
      "episode: 13000 | option price [225.84 227.49 254.46 237.55 184.97 159.39 111.96 101.85  71.49  15.65\n",
      "  18.12  16.07  11.09   3.22   2.63   5.08   3.36   0.88   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 14000}\n",
      "episode: 14000 | episode final wealth: -602.647 | loss_ex: 18.551 | loss_ex2: 1812902.547 | epsilon:0.43\n",
      "episode: 14000 | rewards [-100.2    -9.81 -107.2   -25.9   -45.4    10.83  -18.44   44.6   -84.59\n",
      " -156.51 -108.66   15.86  -38.38  158.83  -20.74   -8.63   -9.88  -86.29\n",
      "   59.8   -71.96]\n",
      "episode: 14000 | actions taken [17.39 32.17 11.11  8.17 44.78 61.66 66.07 10.54 78.51 10.62 40.77 67.35\n",
      " 68.22  9.17 52.78 58.12 53.48 96.84 60.95 99.74]\n",
      "episode: 14000 | deltas [ 51.13  65.36  66.52  75.76  78.83  80.46  71.3   82.23  73.42  59.88\n",
      "  73.33  86.8   76.5   92.81  77.83  66.73  39.11  25.83  13.35  48.66\n",
      " 100.  ]\n",
      "episode: 14000 | stock price [100.   102.08 102.17 103.64 104.05 104.31 102.68 104.38 102.88 101.04\n",
      " 102.69 104.76 102.69 105.19 102.43 101.32  99.14  98.29  97.58  99.93\n",
      " 102.24]\n",
      "episode: 14000 | option price [225.84 344.79 342.58 444.52 470.77 489.69 360.55 487.22 368.84 238.68\n",
      " 344.11 506.44 322.86 531.46 285.14 202.55  79.46  39.3   14.19  62.47\n",
      " 224.49]\n",
      "\n",
      "{'path_row': 15000}\n",
      "episode: 15000 | episode final wealth: -228.598 | loss_ex: 20.888 | loss_ex2: 2259311.938 | epsilon:0.41\n",
      "episode: 15000 | rewards [  4.68 -18.46 -17.86 -54.14  15.48 -60.49   3.97  14.94  -5.3    4.31\n",
      "   7.19  -9.54   1.18 -13.98  -1.35  -4.77 -13.73 -15.78 -16.75 -48.21]\n",
      "episode: 15000 | actions taken [15.04 41.31 91.31 87.22 81.35 12.33 16.8  18.48 16.47 18.48 22.   27.84\n",
      " 23.46 26.13 22.45 32.02 36.47 34.54 40.38  9.24]\n",
      "episode: 15000 | deltas [51.13 49.62 34.76 39.88 30.62 30.79 30.79 31.34 22.07 26.26 28.92 31.2\n",
      " 14.77 14.66  6.38  4.71  2.88  0.88  0.09  0.    0.  ]\n",
      "episode: 15000 | stock price [100.    99.81  97.86  98.51  97.36  97.56  97.71  97.95  97.05  97.56\n",
      "  98.04  98.48  96.98  97.15  96.22  96.21  96.28  95.97  95.56  95.28\n",
      "  94.22]\n",
      "episode: 15000 | option price [225.84 203.22 114.98 143.66  93.36  88.25  83.26  79.04  45.8   57.51\n",
      "  60.14  59.05  21.11  19.68   6.65   4.27   2.1    0.49   0.03   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 16000}\n",
      "episode: 16000 | episode final wealth: -600.117 | loss_ex: 12.996 | loss_ex2: 1206284.328 | epsilon:0.38\n",
      "episode: 16000 | rewards [ -40.98  -31.6   -11.49   -5.24    7.97    4.49  -88.09   19.78  -67.14\n",
      "   25.45    9.7     0.08   -1.32 -136.27   10.95   10.29  -15.78    7.03\n",
      " -180.96 -116.99]\n",
      "episode: 16000 | actions taken [17.53 49.1  56.81 36.89 32.26 30.34 23.71 35.97 38.17 50.19 55.1  51.78\n",
      " 39.73 81.99 52.   38.38 51.75 56.2  26.36 78.36]\n",
      "episode: 16000 | deltas [ 51.13  54.75  55.64  55.07  43.47  32.79  36.71  62.95  57.31  75.11\n",
      "  57.23  59.07  39.    42.66  19.44  24.5   43.14  79.63  87.35  99.97\n",
      " 100.  ]\n",
      "episode: 16000 | stock price [100.   100.52 100.65 100.58  98.84  97.22  97.93 101.63 100.8  103.24\n",
      " 100.78 100.95  98.71  99.17  96.97  97.87  99.51 101.76 101.83 104.02\n",
      " 103.19]\n",
      "episode: 16000 | option price [225.84 258.48 264.68 264.01 185.   120.25 135.69 304.85 242.8  401.\n",
      " 239.6  234.05 114.56 122.6   35.96  42.77  82.23 201.12 193.66 401.83\n",
      " 318.85]\n",
      "\n",
      "{'path_row': 17000}\n",
      "episode: 17000 | episode final wealth: -114.323 | loss_ex: 13.729 | loss_ex2: 1790007.188 | epsilon:0.36\n",
      "episode: 17000 | rewards [ -7.6  -64.57 -19.31  27.38  32.8   31.97   0.71 -19.13  15.54  -0.36\n",
      "  -0.94 -16.23  -4.56 -25.05   5.57  18.25 -37.56 -13.01  18.58 -56.8 ]\n",
      "episode: 17000 | actions taken [23.29 87.64 90.55 78.58 76.77 74.61 73.64 70.95 64.2  60.77 59.66 53.9\n",
      " 42.43 45.17 41.43 44.33 48.11 38.46 23.75 36.84]\n",
      "episode: 17000 | deltas [51.13 47.32 44.86 39.77 44.27 47.36 58.97 56.88 46.74 58.2  59.2  48.23\n",
      " 34.25 30.03 15.42 14.3  16.95  5.55  2.17  4.12  0.  ]\n",
      "episode: 17000 | stock price [100.    99.47  99.17  98.58  99.23  99.65 100.8  100.57  99.63 100.65\n",
      " 100.72  99.81  98.71  98.49  97.28  97.42  97.94  96.93  96.76  98.16\n",
      "  97.9 ]\n",
      "episode: 17000 | option price [225.84 197.71 172.71 135.77 147.42 144.91 196.48 178.27 128.06 170.89\n",
      " 172.22 117.58  68.64  52.52  20.62  17.08  18.91   4.41   1.26   1.75\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 18000}\n",
      "episode: 18000 | episode final wealth: -105.395 | loss_ex: 11.313 | loss_ex2: 1309298.906 | epsilon:0.34\n",
      "episode: 18000 | rewards [-35.69 -37.1   59.81  17.64  21.04 -65.54  12.45  14.75 -29.    -0.13\n",
      " -43.99 -33.77  19.02  10.01  10.68  10.22   1.64 -40.82  22.45 -19.08]\n",
      "episode: 18000 | actions taken [85.92 85.42 82.67 87.21 88.54 90.24 84.19 84.18 55.63 12.58 12.4  58.91\n",
      " 61.31 58.2  59.94 58.01 54.23 45.92 35.95 10.04]\n",
      "episode: 18000 | deltas [51.13 60.24 50.15 68.48 75.03 83.75 58.37 66.31 71.   73.95 68.74 77.\n",
      " 76.16 65.33 66.25 58.33 63.56 34.91  6.79  9.5   0.  ]\n",
      "episode: 18000 | stock price [100.   101.25  99.88 102.35 103.2  104.35 100.84 101.81 102.32 102.61\n",
      " 101.92 102.78 102.48 101.24 101.19 100.52 100.78  99.21  97.6   98.51\n",
      "  99.65]\n",
      "episode: 18000 | option price [225.84 283.3  202.81 344.27 395.89 475.62 222.66 285.43 313.42 329.69\n",
      " 276.91 331.4  299.76 202.19 185.99 133.59 136.16  45.88   4.68   4.99\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 19000}\n",
      "episode: 19000 | episode final wealth: 1.907 | loss_ex: 10.434 | loss_ex2: 1259328.344 | epsilon:0.32\n",
      "episode: 19000 | rewards [  54.41   -4.46    4.28   13.71   -5.15    2.58  -12.94   73.59   -2.53\n",
      "  -47.53   33.8    18.49   -4.29    8.73    9.73   -3.74    7.02    3.32\n",
      "   20.16 -167.28]\n",
      "episode: 19000 | actions taken [18.74 15.33 17.55 17.95 14.56 16.66 27.36 79.48 74.11 70.06 62.65 59.6\n",
      " 60.2  57.59 58.36 48.93 60.98 57.14 56.66 31.08]\n",
      "episode: 19000 | deltas [ 51.13  30.94  33.09  30.99  18.17  19.11  21.54  30.92  53.52  48.3\n",
      "  34.11  45.78  62.01  50.48  50.97  70.27  75.2   62.64  77.66  80.39\n",
      " 100.  ]\n",
      "episode: 19000 | stock price [100.    97.23  97.61  97.36  95.36  95.48  96.1   97.4  100.3   99.73\n",
      "  98.2   99.51 101.04  99.98 100.03 101.54 101.77 100.73 101.41 101.16\n",
      " 102.96]\n",
      "episode: 19000 | option price [225.84 100.7  107.77  96.84  46.85  50.51  56.39  94.61 200.68 155.38\n",
      "  91.88 132.63 202.43 142.16 133.5  211.48 216.72 133.85 165.98 130.87\n",
      " 296.4 ]\n",
      "\n",
      "{'path_row': 20000}\n",
      "episode: 20000 | episode final wealth: -337.907 | loss_ex: 8.552 | loss_ex2: 809241.594 | epsilon:0.30\n",
      "episode: 20000 | rewards [ 20.73  11.99 -17.07  -8.39  14.88   0.06  -7.97 -50.64 -77.2   -0.37\n",
      " -36.83 -57.31  -5.69  18.28  -1.31 -49.99  24.29 -64.06 -10.92 -40.39]\n",
      "episode: 20000 | actions taken [21.08 24.   25.55 31.56 35.93 38.9  10.15 32.84 42.5  38.31 10.21 63.83\n",
      " 68.8  71.53 60.81 65.11 72.84 70.2  69.94 54.41]\n",
      "episode: 20000 | deltas [ 51.13  41.56  41.56  52.87  55.88  51.26  56.16  51.03  62.37  81.47\n",
      "  83.02  86.09  88.19  90.36  87.48  89.01  98.18  97.07  99.99 100.\n",
      " 100.  ]\n",
      "episode: 20000 | stock price [100.    98.7   98.82 100.23 100.56 100.04 100.54 100.02 101.19 103.52\n",
      " 103.56 103.75 103.95 104.14 103.27 103.14 104.8  103.58 105.72 106.07\n",
      " 105.34]\n",
      "episode: 20000 | option price [225.84 156.68 144.56 196.1  209.13 171.16 187.37 161.21 227.52 393.73\n",
      " 391.32 401.06 415.38 428.58 345.86 327.75 481.65 360.68 571.63 607.05\n",
      " 533.79]\n",
      "\n",
      "{'path_row': 21000}\n",
      "episode: 21000 | episode final wealth: -190.028 | loss_ex: 8.336 | loss_ex2: 825066.734 | epsilon:0.28\n",
      "episode: 21000 | rewards [ 18.12  52.96 -69.47 -12.42 -31.68 -56.59 -51.04 -72.88  59.71 -71.48\n",
      " -34.65  13.32 -33.12  37.55 -83.11  57.95 -70.62 140.72   4.2   12.5 ]\n",
      "episode: 21000 | actions taken [ 0.56  3.92 22.6  35.6  63.3  66.21 62.54 54.87 42.66 84.52 64.52 51.87\n",
      " 40.1  72.88 85.45 80.25 53.14 75.02 45.19 47.34]\n",
      "episode: 21000 | deltas [51.13 50.79 41.26 58.74 60.59 49.15 30.24 19.35 10.03 23.5  19.74 14.84\n",
      " 15.09  8.59 12.61  5.42  6.83  1.5  10.45 10.62  0.  ]\n",
      "episode: 21000 | stock price [100.    99.97  98.75 100.96 101.16  99.8   97.64  96.27  94.63  97.08\n",
      "  96.59  96.13  96.58  95.71  96.73  95.77  96.57  95.62  97.87  98.56\n",
      "  99.74]\n",
      "episode: 21000 | option price [225.84 207.14 146.04 247.06 253.59 170.93  81.33  43.29  18.75  52.18\n",
      "  41.44  26.96  24.72  11.82  17.17   5.81   6.71   1.04   8.24   5.79\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 22000}\n",
      "episode: 22000 | episode final wealth: -333.124 | loss_ex: 6.665 | loss_ex2: 628064.156 | epsilon:0.27\n",
      "episode: 22000 | rewards [ -18.63    4.43  -29.55  -62.92   21.76  -22.82  -58.16  -62.15  -11.02\n",
      "  -11.06  -10.22 -106.01   35.58   30.05  -75.76   13.39  -18.24   -2.71\n",
      "  115.84  -64.91]\n",
      "episode: 22000 | actions taken [23.7  30.65 65.07 66.04 59.62 49.69 45.54 56.38 41.59 28.64 21.15 80.86\n",
      " 60.16 40.18 37.38 27.86 21.04 29.22 52.28 25.07]\n",
      "episode: 22000 | deltas [51.13 49.97 53.23 49.09 30.24 30.48 29.02 13.43  7.88  8.48  6.55  5.78\n",
      "  2.65  4.36  7.36  0.85  0.84  0.1   0.02  0.08  0.  ]\n",
      "episode: 22000 | stock price [100.    99.84 100.28  99.77  97.43  97.75  97.45  95.17  94.01  94.11\n",
      "  93.98  93.76  93.07  94.02  95.34  93.14  93.93  93.34  93.51  96.14\n",
      "  95.55]\n",
      "episode: 22000 | option price [225.84 216.9  219.26 181.1   87.98  79.43  77.69  27.78  14.18  15.64\n",
      "  10.75   9.24   3.42   5.9   10.07   0.77   0.68   0.06   0.01   0.03\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 23000}\n",
      "episode: 23000 | episode final wealth: -242.320 | loss_ex: 6.709 | loss_ex2: 1265060.031 | epsilon:0.25\n",
      "episode: 23000 | rewards [ -10.9    10.96   17.9     6.91   19.88   -8.73    3.34  -95.42  -38.27\n",
      "    9.91   -0.44  -13.33   11.41  -18.11    2.02 -123.19   60.39  -18.37\n",
      "   12.61  -70.88]\n",
      "episode: 23000 | actions taken [22.94 31.12 31.13 30.69 31.   26.18 25.26  4.59 41.09 46.02 47.1  49.07\n",
      " 44.83 43.68 43.94 92.92 56.82 44.48 45.37 22.2 ]\n",
      "episode: 23000 | deltas [51.13 51.8  46.78 43.54 43.94 25.09 27.09 35.73 54.19 58.97 54.65 53.48\n",
      " 31.95 38.47 19.94 15.18  5.54 20.56 10.14  4.32  0.  ]\n",
      "episode: 23000 | stock price [100.   100.1   99.46  99.12  99.21  97.14  97.31  98.47 100.34 100.8\n",
      " 100.36 100.25  98.28  98.98  97.36  97.14  96.16  98.17  97.66  97.82\n",
      "  96.51]\n",
      "episode: 23000 | option price [225.84 216.05 177.04 148.4  143.85  59.69  68.14  93.24 176.89 197.46\n",
      " 162.07 156.43  71.24  86.81  33.21  21.07   5.47  24.9    8.6    2.2\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 24000}\n",
      "episode: 24000 | episode final wealth: -260.447 | loss_ex: 5.702 | loss_ex2: 604348.883 | epsilon:0.24\n",
      "episode: 24000 | rewards [   3.64   -4.21   20.36   -0.25    4.26    5.51   -1.65    0.67    4.32\n",
      "  -39.28   -7.25 -136.48   34.81   16.87  -39.45   35.21  -30.55  -89.71\n",
      "  -13.22  -24.07]\n",
      "episode: 24000 | actions taken [23.9  27.07 29.79 26.36 28.19 30.1  29.98 25.49 39.46 33.32 23.82 86.57\n",
      " 42.82 33.9  35.21 42.9  27.98 49.19 29.64  6.7 ]\n",
      "episode: 24000 | deltas [51.13 43.4  46.39 35.66 39.07 41.19 39.02 27.66 24.75 27.42 11.22  9.16\n",
      "  4.63 10.52 14.78  4.2   6.54  1.98  0.04  0.    0.  ]\n",
      "episode: 24000 | stock price [100.    98.92  99.36  97.96  98.5   98.84  98.62  97.1   96.79  97.36\n",
      "  94.93  94.77  93.78  95.77  96.72  95.12  96.16  95.39  93.94  94.12\n",
      "  94.69]\n",
      "episode: 24000 | option price [225.84 172.42 185.55 120.63 131.82 135.4  121.43  77.21  64.39  69.05\n",
      "  21.37  15.79   6.67  16.18  22.87   4.63   6.99   1.57   0.02   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 25000}\n",
      "episode: 25000 | episode final wealth: -565.508 | loss_ex: 4.419 | loss_ex2: 522338.359 | epsilon:0.22\n",
      "episode: 25000 | rewards [  -0.08    5.79   -3.67 -120.62    5.22  -51.41   -3.14    2.7   -22.36\n",
      "   -2.77  -21.37    5.27   -1.07  -92.33  -57.68   -5.8   -14.28  -10.32\n",
      "   23.1  -200.69]\n",
      "episode: 25000 | actions taken [19.36 21.97 21.85 23.17 36.11 42.36 51.74 60.51 70.06 79.51 84.19 88.82\n",
      " 88.12 11.24 76.56 89.33 89.83 98.29 89.6  57.4 ]\n",
      "episode: 25000 | deltas [ 51.13  44.68  41.71  42.65  67.46  62.91  71.61  72.73  72.2   81.88\n",
      "  88.88  96.57  95.32  97.1   98.53  98.56  98.59  99.87 100.    99.99\n",
      " 100.  ]\n",
      "episode: 25000 | stock price [100.    99.05  98.6   98.74 102.51 101.79 103.35 103.43 103.19 105.04\n",
      " 106.16 108.61 107.47 107.86 108.   107.46 106.74 108.24 108.97 105.84\n",
      " 108.29]\n",
      "episode: 25000 | option price [225.84 188.13 170.01 176.49 383.24 338.8  449.76 447.2  421.06 563.41\n",
      " 644.86 867.42 756.64 790.99 801.96 747.73 675.44 823.81 897.47 584.19\n",
      " 829.36]\n",
      "\n",
      "{'path_row': 26000}\n",
      "episode: 26000 | episode final wealth: -464.924 | loss_ex: 4.453 | loss_ex2: 509251.719 | epsilon:0.21\n",
      "episode: 26000 | rewards [  -2.4   -48.59   -5.07    0.37   -4.32   10.72  -72.45  -60.54   19.66\n",
      "  -24.85  -71.97  -23.03  -35.54   18.36   -1.57   15.42   -3.77  -12.3\n",
      "  -29.65 -133.4 ]\n",
      "episode: 26000 | actions taken [22.84 30.3  40.28 46.54 53.65 60.26 66.64 62.11 39.07 36.98 29.47 18.17\n",
      " 15.46 11.69 17.09 12.58 16.96 32.04 11.51 65.31]\n",
      "episode: 26000 | deltas [51.13 45.72 60.55 58.71 58.71 50.91 53.16 30.61 21.1  28.98 13.78  3.07\n",
      "  1.39  0.1   0.37  0.32  0.38  0.1   0.01  0.    0.  ]\n",
      "episode: 26000 | stock price [100.    99.24 101.32 101.06 101.03  99.98 100.27  97.48  96.02  97.57\n",
      "  95.67  92.72  91.89  89.65  91.53  91.72  93.28  93.28  93.33  92.42\n",
      "  92.06]\n",
      "episode: 26000 | option price [225.84 188.01 292.39 276.76 268.8  209.46 209.47  89.5   55.05  74.01\n",
      "  26.24   4.35   1.7    0.09   0.34   0.28   0.29   0.06   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 27000}\n",
      "episode: 27000 | episode final wealth: -358.241 | loss_ex: 4.141 | loss_ex2: 396835.867 | epsilon:0.20\n",
      "episode: 27000 | rewards [ -71.35   14.53   22.77    8.23  -65.96   25.5    11.29    3.39  -38.53\n",
      "   10.39    1.98   -4.8   -32.    -29.04    6.13   46.48   18.95    2.61\n",
      " -210.76  -78.02]\n",
      "episode: 27000 | actions taken [27.8  15.68 33.88 35.76 34.96 43.5  46.02 44.68 54.9  48.17 43.69 40.11\n",
      " 37.62 32.89 28.18 28.61 30.96 31.48 77.84 81.08]\n",
      "episode: 27000 | deltas [51.13 60.88 58.73 50.79 45.61 70.07 57.65 47.19 38.66 25.8  31.6  27.77\n",
      " 19.65  9.25  3.12  3.51  9.46 13.77  6.97  0.    0.  ]\n",
      "episode: 27000 | stock price [100.   101.43 101.06  99.97  99.33 102.44 100.81  99.57  98.63  97.15\n",
      "  97.9   97.63  96.91  95.5   94.44  94.83  96.71  97.54  97.33  95.13\n",
      "  95.16]\n",
      "episode: 27000 | option price [225.84 309.15 276.56 198.52 165.46 339.12 234.1  163.16 116.33  63.73\n",
      "  83.01  64.67  37.38  13.9    3.46   3.8   10.71  15.25   5.43   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 28000}\n",
      "episode: 28000 | episode final wealth: -393.008 | loss_ex: 3.229 | loss_ex2: 402347.367 | epsilon:0.19\n",
      "episode: 28000 | rewards [-22.44  -4.42 -35.11 -18.92 -12.35   5.03  22.45 -47.68  -2.45 -27.99\n",
      " -44.45 -29.38 -21.9  -12.63  -5.79   0.9  -33.21   0.03 -18.33 -84.36]\n",
      "episode: 28000 | actions taken [24.94 34.41 38.8  44.47 49.94 56.57  5.32 49.62 54.99 61.68 50.68 66.1\n",
      " 80.13 95.56 81.32 80.67 81.08 77.39 77.36 71.37]\n",
      "episode: 28000 | deltas [ 51.13  56.56  59.24  68.14  73.9   78.05  76.72  67.27  71.43  70.67\n",
      "  80.12  87.96  90.41  95.57  95.49  95.68  98.13  99.89  99.99 100.\n",
      " 100.  ]\n",
      "episode: 28000 | stock price [100.   100.71 101.01 102.18 102.9  103.4  103.08 101.89 102.33 102.22\n",
      " 103.58 104.75 105.31 106.29 105.59 105.14 105.26 107.08 106.91 107.71\n",
      " 107.75]\n",
      "episode: 28000 | option price [225.84 241.14 246.14 322.24 367.68 399.14 369.07 287.46 311.88 302.57\n",
      " 407.68 499.9  550.59 636.15 565.49 519.89 527.38 707.96 690.6  771.41\n",
      " 774.93]\n",
      "\n",
      "{'path_row': 29000}\n",
      "episode: 29000 | episode final wealth: -206.071 | loss_ex: 2.976 | loss_ex2: 361194.320 | epsilon:0.18\n",
      "episode: 29000 | rewards [ -22.17  -15.12  -48.35  -15.86  -36.14  -10.14  -18.74  -13.3   -18.86\n",
      "   -5.61  -34.44    3.92  -68.74   19.05    4.29  -21.26   -0.99  -15.42\n",
      "  242.36 -130.58]\n",
      "episode: 29000 | actions taken [23.86 30.79 34.87 42.62 89.83 80.13 63.41 56.69 68.58 41.9  63.26 48.24\n",
      " 67.6  81.14 83.84 84.34 86.63 86.59 10.81  3.26]\n",
      "episode: 29000 | deltas [ 51.13  49.75  51.72  66.26  74.06  78.32  78.69  79.3   80.68  86.49\n",
      "  85.75  90.01  89.51  97.12  89.81  91.48  99.03  99.5   99.98  99.68\n",
      " 100.  ]\n",
      "episode: 29000 | stock price [100.    99.8  100.08 102.23 103.21 103.84 103.91 104.01 104.27 105.19\n",
      " 104.79 105.48 105.1  107.13 104.6  104.48 106.59 106.52 107.7  104.07\n",
      " 105.3 ]\n",
      "episode: 29000 | option price [225.84 219.34 236.27 355.3  404.97 449.14 454.82 462.7  483.86 553.14\n",
      " 514.13 569.91 531.63 716.93 478.59 460.91 660.18 652.89 770.08 406.83\n",
      " 530.14]\n",
      "\n",
      "{'path_row': 30000}\n",
      "episode: 30000 | episode final wealth: -639.979 | loss_ex: 3.459 | loss_ex2: 493756.453 | epsilon:0.17\n",
      "episode: 30000 | rewards [ -88.35  -41.8   -33.35  -37.88  -28.17  -12.12  -13.85  -18.31   32.56\n",
      "   23.87  -11.75    9.37  -12.99    1.3   -41.63    7.99  -14.05   17.37\n",
      " -134.39 -243.81]\n",
      "episode: 30000 | actions taken [87.58 71.24 65.79 60.62 15.48 20.19 26.97 30.23 44.97 35.89 36.95 36.12\n",
      " 41.02  6.22 51.5  55.23 49.34 83.74 68.02 88.45]\n",
      "episode: 30000 | deltas [51.13 48.68 42.27 36.94 27.52 21.09 34.23 37.44 13.77 19.14 31.82 25.16\n",
      " 37.49 61.71 55.74 57.87 39.85 20.53 23.04  0.43  0.  ]\n",
      "episode: 30000 | stock price [100.    99.68  98.8   97.99  96.64  95.77  97.88  98.26  94.65  95.99\n",
      "  97.95  97.07  98.57 101.09 100.48 100.66  99.15  97.82  98.41  96.25\n",
      "  94.66]\n",
      "episode: 30000 | option price [225.84 198.44 161.12 135.79  87.13  58.18 108.31 125.8   31.91  45.37\n",
      "  83.11  61.48 105.62 217.06 176.76 182.51  86.87  29.45  28.     0.19\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 31000}\n",
      "episode: 31000 | episode final wealth: -188.013 | loss_ex: 2.516 | loss_ex2: 296805.125 | epsilon:0.16\n",
      "episode: 31000 | rewards [  5.24  15.41 -57.39  -9.27 -67.57 -15.19 -31.95  -1.87  -8.09   4.01\n",
      " -18.54 -19.5  -20.29 -28.43   4.29 -20.77  91.05   5.17  -4.35  -9.98]\n",
      "episode: 31000 | actions taken [21.31 25.4  61.41 54.78 48.5  34.54 19.93 13.08 16.56 16.   20.89 17.92\n",
      " 18.13 15.77 12.26 82.08 41.72 20.28  9.35  1.66]\n",
      "episode: 31000 | deltas [51.13 42.4  37.85 31.39 29.25 15.49 14.43  7.15  4.94  2.66  2.53  1.38\n",
      "  0.43  0.07  0.01  0.    0.    0.01  0.01  0.    0.  ]\n",
      "episode: 31000 | stock price [100.    98.73  98.16  97.25  96.98  94.62  94.45  92.5   92.37  91.78\n",
      "  92.04  91.28  90.27  89.14  87.46  88.06  88.56  91.6   92.82  93.44\n",
      "  92.69]\n",
      "episode: 31000 | option price [225.84 172.12 138.25 104.31  92.78  39.63  35.86  15.05   8.87   4.03\n",
      "   3.64   1.79   0.46   0.06   0.01   0.     0.     0.01   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 32000}\n",
      "episode: 32000 | episode final wealth: -224.202 | loss_ex: 2.311 | loss_ex2: 302476.656 | epsilon:0.15\n",
      "episode: 32000 | rewards [-42.64  -5.06  22.83  -9.45   5.08 -24.76 -31.49  29.6  -10.08  -0.37\n",
      "  -3.83  16.78   2.28 -25.5  -52.09 -34.6  -40.65 -25.35  11.47  -6.35]\n",
      "episode: 32000 | actions taken [20.29 29.28 31.11 61.96 64.83 65.88 60.79 53.51 50.67 47.55 46.32 45.87\n",
      " 46.68  4.22 49.9  44.53 35.32 22.22  9.73  2.36]\n",
      "episode: 32000 | deltas [51.13 55.36 52.16 46.37 58.81 57.61 43.57 33.83 40.59 36.04 34.57 30.1\n",
      " 39.76 30.61 27.27 18.6   7.76  2.7   0.51  1.84  0.  ]\n",
      "episode: 32000 | stock price [100.   100.61 100.15  99.33 101.09 100.88  99.03  97.75  98.8   98.25\n",
      "  98.12  97.64  98.81  97.96  97.82  97.15  96.    94.91  94.23  96.68\n",
      "  97.55]\n",
      "episode: 32000 | option price [225.84 260.55 242.99 192.83 280.69 259.4  161.18 109.77 129.38 108.88\n",
      " 100.03  80.21 116.51  73.7   57.03  31.04   9.44   2.62   0.35   1.03\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 33000}\n",
      "episode: 33000 | episode final wealth: -317.527 | loss_ex: 1.904 | loss_ex2: 208608.654 | epsilon:0.14\n",
      "episode: 33000 | rewards [-101.3   -16.15   13.14   -7.15  -20.63  -14.22   16.71    2.26    9.99\n",
      "    6.42   -8.55  -19.71    4.04    5.39  -56.47   32.41  -30.33    0.9\n",
      "  -15.08 -119.2 ]\n",
      "episode: 33000 | actions taken [29.44 43.69 53.15 82.34 77.99 71.36 66.55 71.82 70.66 71.83 68.85 73.15\n",
      " 76.59 77.2  66.47 69.91 68.7  63.74 61.12 48.85]\n",
      "episode: 33000 | deltas [ 51.13  67.2   72.    67.27  75.26  62.3   53.65  74.91  70.89  79.89\n",
      "  73.69  82.72  91.29  90.95  91.57  98.48  96.07  99.49  99.85 100.\n",
      " 100.  ]\n",
      "episode: 33000 | stock price [100.   102.39 102.99 102.15 103.15 101.37 100.31 102.71 102.09 102.86\n",
      " 102.07 103.02 104.26 103.94 103.76 105.4  104.12 105.16 105.   105.32\n",
      " 106.38]\n",
      "episode: 33000 | option price [225.84 368.14 395.57 328.21 387.82 265.64 197.47 335.3  283.31 326.68\n",
      " 262.28 332.87 438.68 406.89 387.05 541.21 415.78 516.4  499.98 531.82\n",
      " 638.  ]\n",
      "\n",
      "{'path_row': 34000}\n",
      "episode: 34000 | episode final wealth: -149.107 | loss_ex: 1.643 | loss_ex2: 199394.066 | epsilon:0.13\n",
      "episode: 34000 | rewards [-89.69  16.75  -5.39  -0.01  -5.47 -32.82 -31.9   -2.59  -2.28   0.42\n",
      "   4.88   9.69 -38.84 -28.54 -20.06   6.84 -11.79  -6.42  77.91  10.21]\n",
      "episode: 34000 | actions taken [74.8  70.43 54.85 64.41 70.18 19.51 44.16 53.58 56.82 54.84 57.94 54.73\n",
      " 54.87 62.58 65.63 65.25 63.13 56.32 42.56 22.14]\n",
      "episode: 34000 | deltas [ 51.13  49.71  55.62  68.12  64.61  59.63  58.15  67.45  66.54  54.82\n",
      "  69.36  52.48  60.01  86.84  93.1   97.28  98.43  99.65  99.92  99.81\n",
      " 100.  ]\n",
      "episode: 34000 | stock price [100.    99.78 100.65 102.34 101.75 101.06 100.84 101.85 101.69 100.42\n",
      " 101.91 100.16 100.82 103.46 104.33 105.01 104.85 105.13 105.12 103.51\n",
      " 102.82]\n",
      "episode: 34000 | option price [225.84 224.48 264.45 346.75 299.21 250.42 227.67 279.39 263.81 190.81\n",
      " 269.75 160.81 183.9  367.23 442.4  503.83 485.83 513.65 512.18 351.33\n",
      " 281.84]\n",
      "\n",
      "{'path_row': 35000}\n",
      "episode: 35000 | episode final wealth: -16.592 | loss_ex: 1.490 | loss_ex2: 139958.500 | epsilon:0.12\n",
      "episode: 35000 | rewards [ 11.3    1.61  17.55  -0.6    0.34  -9.29   0.88  -6.66 -17.42  -7.23\n",
      "  11.52 -28.89   5.11   7.24  12.74   3.24 -22.08  11.9    0.33  -8.2 ]\n",
      "episode: 35000 | actions taken [25.43 27.81 28.56 27.71 23.07 17.63 12.13 18.1  16.48 16.47 15.04 46.98\n",
      " 28.08 19.39 20.86 18.89 17.22 11.92  7.03  1.54]\n",
      "episode: 35000 | deltas [51.13 42.03 42.29 38.99 29.37 20.28  9.1  10.58  9.04  3.17  1.53  1.95\n",
      "  1.55  2.33  3.02  3.97  4.18  0.59  0.77  0.19  0.  ]\n",
      "episode: 35000 | stock price [100.    98.78  98.85  98.53  97.13  95.78  93.58  94.3   94.02  92.28\n",
      "  91.67  92.55  92.55  93.39  94.22  94.95  95.22  93.8   95.21  95.87\n",
      "  94.85]\n",
      "episode: 35000 | option price [225.84 158.04 155.93 128.53  89.64  53.53  18.92  21.63  17.54   4.8\n",
      "   1.96   2.42   1.79   2.75   3.42   4.41   4.5    0.44   0.48   0.08\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 36000}\n",
      "episode: 36000 | episode final wealth: -228.456 | loss_ex: 1.017 | loss_ex2: 109407.184 | epsilon:0.12\n",
      "episode: 36000 | rewards [-25.03 -35.69  22.17  10.97 -16.01   2.24  -6.   -49.42   9.53 -11.31\n",
      "  11.18 -59.27 -17.91  -0.98 -39.44 -15.99  -6.94  -1.25   1.38  -0.69]\n",
      "episode: 36000 | actions taken [27.54 35.16 44.3  47.   49.34 44.91 43.28 39.88 58.61 44.03 37.47 31.86\n",
      " 19.87 17.5  16.35  8.52  6.15  4.43  2.59  0.6 ]\n",
      "episode: 36000 | deltas [51.13 54.45 60.78 53.98 51.93 32.73 40.13 32.09 16.7  18.88 18.96 26.14\n",
      "  7.78  4.38  3.62  0.3   0.03  0.    0.    0.    0.  ]\n",
      "episode: 36000 | stock price [100.   100.45 101.36 100.38 100.12  97.83  98.72  97.77  95.31  95.86\n",
      "  95.92  97.01  93.63  92.9   92.88  90.22  89.15  88.36  88.42  89.58\n",
      "  92.31]\n",
      "episode: 36000 | option price [225.84 235.82 295.87 220.7  194.8   95.49 129.22  92.13  40.19  45.39\n",
      "  45.18  68.69  14.71   6.98   5.36   0.3    0.03   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 37000}\n",
      "episode: 37000 | episode final wealth: -52.560 | loss_ex: 1.095 | loss_ex2: 117875.641 | epsilon:0.11\n",
      "episode: 37000 | rewards [-29.83   1.18   3.06   7.59   1.88   6.98   0.92  -3.64 -17.61  -8.38\n",
      " -17.13   3.73   3.05   5.6    6.23  11.09   8.39  -3.2   -5.18 -27.27]\n",
      "episode: 37000 | actions taken [27.38 36.28 40.09 42.86 28.06 32.87 32.94 39.16 49.77 60.7  77.93 71.89\n",
      " 74.87 71.87 71.66 69.96 64.72 55.07 35.63 15.07]\n",
      "episode: 37000 | deltas [51.13 54.21 55.58 55.53 49.43 47.23 32.4  43.66 50.02 67.58 66.48 59.75\n",
      " 83.19 68.58 75.91 79.74 74.97 57.77 37.01 19.24  0.  ]\n",
      "episode: 37000 | stock price [100.   100.43 100.59 100.57  99.81  99.58  97.83  99.21  99.91 101.73\n",
      " 101.59 100.82 103.15 101.49 102.02 102.2  101.59 100.39  99.41  98.93\n",
      "  98.61]\n",
      "episode: 37000 | option price [225.84 240.04 235.73 228.01 185.22 161.99  92.63 137.21 162.34 259.81\n",
      " 248.49 188.26 345.67 215.6  245.04 251.4  195.99 104.31  43.81  12.8\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 38000}\n",
      "episode: 38000 | episode final wealth: -220.094 | loss_ex: 1.194 | loss_ex2: 170004.941 | epsilon:0.10\n",
      "episode: 38000 | rewards [-14.66  22.43  11.89   1.74   5.15  -8.47 -11.23 -58.11 -46.75 -21.66\n",
      "  13.58   7.19   6.83  -5.93   1.39  13.65  -9.98   3.67 -81.29 -49.54]\n",
      "episode: 38000 | actions taken [26.54 30.22 32.68 32.34 30.91 30.91 36.28 40.33 59.42 69.21 78.3  76.06\n",
      " 72.43 72.35 74.36 74.35 71.61 69.63 63.1  42.67]\n",
      "episode: 38000 | deltas [ 51.13  47.89  44.6   40.1   36.79  36.59  45.68  41.53  72.9   86.38\n",
      "  90.34  83.54  74.38  77.85  88.62  90.72  88.99  94.75  98.08 100.\n",
      " 100.  ]\n",
      "episode: 38000 | stock price [100.    99.55  99.18  98.67  98.25  98.29  99.39  98.84 102.72 104.6\n",
      " 105.33 103.6  102.27 102.41 103.53 103.58 102.99 103.54 103.48 105.53\n",
      " 105.24]\n",
      "episode: 38000 | option price [225.84 201.9  164.71 133.73 118.05 112.87 155.31 141.26 351.72 490.52\n",
      " 552.3  394.06 283.11 282.84 369.55 369.7  312.71 359.21 349.07 553.08\n",
      " 523.56]\n",
      "\n",
      "{'path_row': 39000}\n",
      "episode: 39000 | episode final wealth: -172.158 | loss_ex: 0.872 | loss_ex2: 90341.443 | epsilon:0.10\n",
      "episode: 39000 | rewards [  2.45   6.92   3.45 -14.89 -47.54  -1.85 -11.26   9.21  -8.36 -18.35\n",
      "  29.65  -6.07  -3.26 -11.02  37.61   5.06 -80.5  -23.7  -24.32 -15.38]\n",
      "episode: 39000 | actions taken [24.34 29.22 22.58 97.77 38.88 35.04 30.7  33.23 69.92 56.68 51.3  53.27\n",
      " 54.45 53.08 48.92 52.13 45.78 30.38 15.78  1.38]\n",
      "episode: 39000 | deltas [51.13 44.87 26.05 21.24 25.15 28.   29.85 40.35 32.06 38.68 33.84 46.21\n",
      " 39.48 34.28 24.38 42.12 35.95  6.31  1.3   0.01  0.  ]\n",
      "episode: 39000 | stock price [100.    99.14  96.29  95.7   96.43  96.93  97.2   98.62  97.62  98.46\n",
      "  97.91  99.49  98.78  98.28  97.37  99.26  98.86  95.8   95.3   94.58\n",
      "  94.24]\n",
      "episode: 39000 | option price [225.84 178.22  83.13  59.94  73.81  83.96  91.66 142.29  97.36 128.9\n",
      " 102.79 149.11 115.13  89.9   51.54 102.43  72.96   7.23   0.92   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 40000}\n",
      "episode: 40000 | episode final wealth: -273.833 | loss_ex: 0.899 | loss_ex2: 112222.410 | epsilon:0.10\n",
      "episode: 40000 | rewards [-144.71  -57.24    5.53    6.39    5.95   -0.12    5.5    -5.2   -15.84\n",
      "   11.23   -0.57    5.37    8.81  -13.16  -24.17   -2.39    5.44  -25.71\n",
      "    0.87  -39.8 ]\n",
      "episode: 40000 | actions taken [27.79 47.67 64.28 70.51 74.22 75.26 76.17 71.96 71.78 64.45 66.49 63.26\n",
      " 62.22 59.67 98.76 87.64 80.42 70.07 61.36 36.37]\n",
      "episode: 40000 | deltas [ 51.13  74.03  82.12  66.63  72.02  72.22  78.74  71.88  72.43  50.33\n",
      "  65.62  55.02  74.67  74.25  83.    90.83  90.69  80.6   96.38  99.12\n",
      " 100.  ]\n",
      "episode: 40000 | stock price [100.   103.47 104.87 102.23 102.91 102.78 103.79 102.58 102.68  99.94\n",
      " 101.58 100.42 102.34 102.15 103.01 103.84 103.25 101.9  103.14 102.94\n",
      " 102.58]\n",
      "episode: 40000 | option price [225.84 439.16 542.81 349.74 385.09 365.61 440.87 342.52 350.03 169.42\n",
      " 256.66 177.6  290.64 268.82 330.57 397.   335.58 214.7  316.53 294.57\n",
      " 258.27]\n",
      "\n",
      "{'path_row': 41000}\n",
      "episode: 41000 | episode final wealth: -133.526 | loss_ex: 0.765 | loss_ex2: 70502.009 | epsilon:0.10\n",
      "episode: 41000 | rewards [-59.17 -12.8  -16.71  20.25   8.51  -5.92   2.17 -68.25  -8.09  -6.65\n",
      "  18.91   2.73 -23.14  -1.92   5.19   3.63   0.81  -7.75  15.65  -0.97]\n",
      "episode: 41000 | actions taken [26.19 36.71 41.73 50.92 57.29 60.32 61.47 30.63 59.02 58.1  55.34 56.95\n",
      " 68.43 59.77 49.58 40.4  33.58 20.88  7.17  0.92]\n",
      "episode: 41000 | deltas [51.13 57.43 59.85 71.03 58.46 57.65 58.8  60.93 71.6  51.01 48.64 55.67\n",
      " 47.41 38.93 34.72 39.78 41.74 18.02 38.08 12.47  0.  ]\n",
      "episode: 41000 | stock price [100.   100.93 101.27 102.73 100.94 100.78 100.93 101.18 102.44 100.02\n",
      "  99.78 100.45  99.72  99.03  98.8   99.27  99.48  98.17  99.5   98.69\n",
      "  97.83]\n",
      "episode: 41000 | option price [225.84 283.1  297.81 370.37 249.72 225.73 237.65 249.23 324.88 161.34\n",
      " 152.79 168.57 122.54  87.11  66.83  74.56  70.41  18.96  41.97   6.9\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 42000}\n",
      "episode: 42000 | episode final wealth: -141.702 | loss_ex: 0.667 | loss_ex2: 61912.852 | epsilon:0.10\n",
      "episode: 42000 | rewards [ 18.86  -2.66  16.6    0.56  -3.73  -0.07 -19.66   0.86 -23.26   6.37\n",
      " -18.86  33.83   5.55 -18.72  16.35   0.88 -41.18 -44.04 -39.61 -29.76]\n",
      "episode: 42000 | actions taken [27.38 27.17 24.82 19.55 17.51 18.58 25.35 38.11 46.78 47.82 45.74 42.41\n",
      " 47.61 47.26 41.76 38.01 32.73 75.74 56.32 27.6 ]\n",
      "episode: 42000 | deltas [51.13 38.51 35.83 25.22 21.21 22.2  29.21 43.36 38.99 26.65 26.61 20.\n",
      " 29.49 30.03 17.62 19.46 14.66  2.82  0.65  0.01  0.  ]\n",
      "episode: 42000 | stock price [100.    98.35  97.91  96.54  96.    96.13  97.36  99.15  98.74  97.4\n",
      "  97.5   96.71  98.08  98.26  97.18  97.7   97.54  95.99  95.93  95.55\n",
      "  96.43]\n",
      "episode: 42000 | option price [225.84 134.51 125.06  72.11  55.9   59.86  81.8  140.13 111.34  63.28\n",
      "  60.75  41.2   62.35  60.03  27.57  27.66  17.05   2.2    0.34   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 43000}\n",
      "episode: 43000 | episode final wealth: -121.386 | loss_ex: 0.486 | loss_ex2: 51101.396 | epsilon:0.10\n",
      "episode: 43000 | rewards [ -36.47   14.95   13.05   21.71 -105.21  -68.8     0.78   11.44   -8.71\n",
      "   18.09   10.31  -44.23   21.21   15.28   17.56    7.97   13.35   10.46\n",
      "  -28.66   -5.46]\n",
      "episode: 43000 | actions taken [25.13 34.35 33.76 32.24 85.44 34.75 24.78 22.82 38.71 38.82 41.15 47.02\n",
      " 44.18 44.1  44.27 42.91 31.87 20.35 35.87 18.7 ]\n",
      "episode: 43000 | deltas [51.13 53.84 49.14 45.61 33.92 27.44 17.97 22.66 23.71 28.54 31.58 39.68\n",
      " 19.21 22.35 27.43 32.66 53.58 38.18 11.05  1.66  0.  ]\n",
      "episode: 43000 | stock price [100.   100.39  99.74  99.3   97.9   96.98  95.46  96.41  96.91  97.51\n",
      "  98.07  98.97  96.79  97.43  98.03  98.64 100.21  99.23  97.65  97.02\n",
      "  98.56]\n",
      "episode: 43000 | option price [225.84 246.91 200.56 171.98 103.77  78.33  44.92  58.31  56.28  72.79\n",
      "  76.54 100.86  37.01  41.3   52.42  61.37 119.44  64.03   9.96   0.82\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 44000}\n",
      "episode: 44000 | episode final wealth: -317.582 | loss_ex: 0.447 | loss_ex2: 37862.909 | epsilon:0.10\n",
      "episode: 44000 | rewards [ -24.33   10.89   25.25    1.56  -35.45  -74.2    -6.68  -25.78  -56.39\n",
      "   16.1    -8.56  -38.73   36.96    0.55   -3.94    4.68   -7.24  -40.11\n",
      "   35.18 -127.36]\n",
      "episode: 44000 | actions taken [24.58 25.43 24.14 19.64 16.69 27.09 48.76  5.09 65.64 64.79 65.09 60.75\n",
      " 51.09 51.4  48.95 41.8  28.69 26.83 24.38 10.96]\n",
      "episode: 44000 | deltas [ 51.13  50.41  46.32  36.56  31.53  44.33  65.01  57.78  58.32  50.03\n",
      "  66.79  47.35  27.04  50.11  46.18  32.81  32.06  46.77  75.03  75.29\n",
      " 100.  ]\n",
      "episode: 44000 | stock price [100.    99.89  99.3   97.9   97.04  99.04 101.91 100.89 100.89  99.91\n",
      " 101.75  99.65  97.71  99.96  99.64  98.64  98.73  99.79 101.28 100.91\n",
      " 102.28]\n",
      "episode: 44000 | option price [225.84 223.   196.2  135.73 112.91 178.94 320.41 255.34 237.06 168.23\n",
      " 270.4  142.43  58.45 127.04 110.08  62.33  54.28  79.21 157.4  110.58\n",
      " 228.27]\n",
      "\n",
      "{'path_row': 45000}\n",
      "episode: 45000 | episode final wealth: -33.286 | loss_ex: 0.353 | loss_ex2: 29897.971 | epsilon:0.10\n",
      "episode: 45000 | rewards [-31.76  -2.49   0.67   1.68   0.83  -4.11  -7.53 -11.06   8.78  18.64\n",
      "   2.01  18.89 -10.49   7.75   3.2    1.2   -8.22  -7.71 -11.53  -2.04]\n",
      "episode: 45000 | actions taken [28.52 36.11 65.62 64.73 67.26 64.59 62.11 58.41 54.63 54.26 56.49 50.35\n",
      " 49.27 42.93 41.42 39.94 30.41 19.01  3.81  0.59]\n",
      "episode: 45000 | deltas [51.13 54.41 48.46 58.81 68.61 62.32 58.57 50.18 42.64 48.76 59.44 36.43\n",
      " 45.46 30.8  41.26 48.25 22.51 10.35  5.7   0.69  0.  ]\n",
      "episode: 45000 | stock price [100.   100.46  99.62 101.05 102.46 101.5  100.99  99.89  98.96  99.73\n",
      " 100.95  98.63  99.56  98.34  99.28  99.83  98.04  97.35  97.22  97.04\n",
      "  99.45]\n",
      "episode: 45000 | option price [225.84 242.14 206.83 270.53 359.06 291.09 259.4  196.6  149.45 179.15\n",
      " 226.11  90.75 112.75  61.79  88.5  106.47  32.38  10.06   4.18   0.27\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 46000}\n",
      "episode: 46000 | episode final wealth: -197.416 | loss_ex: 0.188 | loss_ex2: 12902.795 | epsilon:0.10\n",
      "episode: 46000 | rewards [-29.13  27.51   4.32  -0.08  -9.17 -17.38 -36.06 -38.2   12.77  11.82\n",
      "   0.42   3.73 -41.61 -21.36 -14.95 -10.33  -6.99  11.81 -93.48  48.94]\n",
      "episode: 46000 | actions taken [22.92 30.01 27.07 26.16 29.49 37.67 49.64 57.95 64.69 67.15 65.84 66.8\n",
      " 68.94 73.5  76.36 79.61 82.08 82.4  28.34 26.91]\n",
      "episode: 46000 | deltas [ 51.13  53.6   44.95  42.37  43.64  48.7   59.24  71.66  82.56  84.41\n",
      "  73.34  80.94  84.24  94.42  97.84  99.39  99.85  99.99 100.   100.\n",
      " 100.  ]\n",
      "episode: 46000 | stock price [100.   100.35  99.2   98.87  99.06  99.71 100.99 102.58 104.25 104.01\n",
      " 102.5  103.27 103.47 105.43 106.28 106.87 107.23 107.48 106.79 107.29\n",
      " 106.21]\n",
      "episode: 46000 | option price [225.84 240.03 170.93 154.78 158.89 184.1  241.36 344.53 470.96 435.58\n",
      " 319.45 368.6  377.42 552.   630.83 687.79 723.19 747.91 678.89 728.78\n",
      " 620.63]\n",
      "\n",
      "{'path_row': 47000}\n",
      "episode: 47000 | episode final wealth: -135.680 | loss_ex: 0.161 | loss_ex2: 10365.810 | epsilon:0.10\n",
      "episode: 47000 | rewards [-35.56  17.77  -3.85 -20.54  15.91  -4.39 -27.17 -49.41 -28.96  -2.91\n",
      "  13.11   5.89   6.84 -36.8   37.98  -7.7   -3.21   1.94 -12.13  -2.49]\n",
      "episode: 47000 | actions taken [29.91 38.03 40.47 47.86 47.3  50.45 52.48 24.56 49.22 47.28 43.77 42.58\n",
      " 39.83 37.35 29.37 29.4  22.61 15.65  3.47  0.58]\n",
      "episode: 47000 | deltas [51.13 57.15 43.53 50.27 38.29 44.51 45.25 37.47 47.34 36.6  27.49 24.31\n",
      " 21.58 21.73  9.74 20.58 10.06  6.44  3.9   0.04  0.  ]\n",
      "episode: 47000 | stock price [100.   100.82  99.02  99.9   98.3   99.19  99.27  98.16  99.51  98.11\n",
      "  97.09  97.03  96.92  97.11  95.43  97.58  96.61  96.5   96.83  95.95\n",
      "  97.38]\n",
      "episode: 47000 | option price [225.84 255.97 161.62 198.81 135.11 160.73 166.32 132.83 187.97 123.8\n",
      "  76.28  57.4   45.49  43.53  15.34  32.73  12.14   6.25   2.74   0.01\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 48000}\n",
      "episode: 48000 | episode final wealth: -249.518 | loss_ex: 0.221 | loss_ex2: 11695.276 | epsilon:0.10\n",
      "episode: 48000 | rewards [  38.21   16.31    9.2    -8.23    6.83    2.35 -131.91  -49.99  -67.29\n",
      "  -20.96   -4.22  -16.82    3.54   10.27   10.42    3.24    9.58  -31.69\n",
      "  -47.91   19.56]\n",
      "episode: 48000 | actions taken [15.33 18.26 18.21 20.44 23.66 24.89 78.13 46.24 40.62 25.78 11.47 11.8\n",
      "  7.17  8.18 11.02 15.08 16.18 18.8   8.45  2.41]\n",
      "episode: 48000 | deltas [ 51.13  38.22  33.18  33.14  36.64  33.82  34.99  24.67  18.24   9.1\n",
      "   4.55   5.96   1.18   1.91   4.08  11.21   9.66  26.31  66.3   90.21\n",
      " 100.  ]\n",
      "episode: 48000 | stock price [100.    98.15  97.51  97.66  98.14  97.84  98.06  96.55  95.62  93.47\n",
      "  92.74  93.72  91.61  92.82  94.52  96.59  96.8   98.72 100.62 101.35\n",
      " 101.11]\n",
      "episode: 48000 | option price [225.84 144.02 113.01 106.49 122.48 105.42 107.34  68.38  44.71  19.25\n",
      "   7.52   9.73   1.42   2.29   4.96  14.65  10.76  31.17  95.96 139.61\n",
      " 110.92]\n",
      "\n",
      "{'path_row': 49000}\n",
      "episode: 49000 | episode final wealth: -198.296 | loss_ex: 0.117 | loss_ex2: 11758.829 | epsilon:0.10\n",
      "episode: 49000 | rewards [-18.78 -13.08  -6.57  14.81  12.41   5.18   1.09 -20.74 -22.75 -54.39\n",
      " -36.02 -19.78   6.15   5.61 -34.24  -7.24  -6.89   1.78  -2.4   -2.46]\n",
      "episode: 49000 | actions taken [32.69 34.02 40.1  37.12 39.38 39.49 42.75 49.91 48.61 42.87 32.55 25.2\n",
      " 17.26 15.51 15.38  9.37  6.55  4.59  1.99  0.55]\n",
      "episode: 49000 | deltas [51.13 43.28 55.38 55.27 47.87 45.17 44.42 46.2  29.37 19.31  8.13  2.61\n",
      "  1.47  1.42  1.16  0.02  0.01  0.    0.    0.    0.  ]\n",
      "episode: 49000 | stock price [100.    98.87 100.58 100.57  99.58  99.27  99.2   99.44  97.51  96.32\n",
      "  94.51  93.38  92.81  93.58  94.02  91.74  91.55  90.89  91.67  91.66\n",
      "  90.48]\n",
      "episode: 49000 | option price [225.84 175.1  245.05 244.91 190.33 163.69 155.65 161.31  78.66  42.53\n",
      "  13.71   3.2    1.62   1.4    1.     0.01   0.     0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 50000}\n",
      "episode: 50000 | episode final wealth: -455.030 | loss_ex: 0.124 | loss_ex2: 10001.970 | epsilon:0.10\n",
      "episode: 50000 | rewards [ -90.42   11.83    7.1    14.43 -136.56  -76.66    8.06   -5.25    1.53\n",
      "   -5.13   -3.99    3.98   11.91   -2.35  -33.89   -8.97  -53.17    1.02\n",
      "   -1.04  -97.46]\n",
      "episode: 50000 | actions taken [31.75 46.54 52.97 56.02  1.64 80.53 76.17 62.84 67.03 90.38 82.12 78.75\n",
      " 75.04 75.3  32.51 37.2  89.29 75.4  60.94 41.97]\n",
      "episode: 50000 | deltas [51.13 67.78 53.16 57.3  60.62 73.23 71.03 75.18 76.95 76.86 89.93 91.77\n",
      " 88.96 70.65 59.64 59.27 63.59 55.91 59.99 44.36  0.  ]\n",
      "episode: 50000 | stock price [100.   102.4  100.29 100.82 101.16 102.62 102.21 102.51 102.53 102.42\n",
      " 103.78 103.76 103.22 101.31 100.54 100.47 100.7  100.25 100.35  99.86\n",
      "  98.2 ]\n",
      "episode: 50000 | option price [225.84 360.63 235.36 250.1  251.6  335.55 298.51 309.04 302.05 288.37\n",
      " 393.11 386.79 336.67 177.58 121.42 110.24 123.02  82.88  75.75  32.25\n",
      "   0.  ]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "history = ddpg.train(50001)\n",
    "ddpg.save_history(history, \"ddpg.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "99489377-336b-449e-ac15-e858b344d4e1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1. generate asset price paths (sabr)\n",
      "2. generate BS price, BS delta, and Bartlett delta\n",
      "simulation done!\n",
      "Model: \"model_11\"\n",
      "__________________________________________________________________________________________________\n",
      " Layer (type)                   Output Shape         Param #     Connected to                     \n",
      "==================================================================================================\n",
      " input_8 (InputLayer)           [(None, 3)]          0           []                               \n",
      "                                                                                                  \n",
      " input_9 (InputLayer)           [(None, 1)]          0           []                               \n",
      "                                                                                                  \n",
      " concatenate_2 (Concatenate)    (None, 4)            0           ['input_8[0][0]',                \n",
      "                                                                  'input_9[0][0]']                \n",
      "                                                                                                  \n",
      " batch_normalization_19 (BatchN  (None, 4)           16          ['concatenate_2[0][0]']          \n",
      " ormalization)                                                                                    \n",
      "                                                                                                  \n",
      " dense_21 (Dense)               (None, 32)           160         ['batch_normalization_19[0][0]'] \n",
      "                                                                                                  \n",
      " dense_24 (Dense)               (None, 32)           160         ['batch_normalization_19[0][0]'] \n",
      "                                                                                                  \n",
      " batch_normalization_20 (BatchN  (None, 32)          128         ['dense_21[0][0]']               \n",
      " ormalization)                                                                                    \n",
      "                                                                                                  \n",
      " batch_normalization_22 (BatchN  (None, 32)          128         ['dense_24[0][0]']               \n",
      " ormalization)                                                                                    \n",
      "                                                                                                  \n",
      " dense_22 (Dense)               (None, 64)           2112        ['batch_normalization_20[0][0]'] \n",
      "                                                                                                  \n",
      " dense_25 (Dense)               (None, 64)           2112        ['batch_normalization_22[0][0]'] \n",
      "                                                                                                  \n",
      " batch_normalization_21 (BatchN  (None, 64)          256         ['dense_22[0][0]']               \n",
      " ormalization)                                                                                    \n",
      "                                                                                                  \n",
      " batch_normalization_23 (BatchN  (None, 64)          256         ['dense_25[0][0]']               \n",
      " ormalization)                                                                                    \n",
      "                                                                                                  \n",
      " dense_23 (Dense)               (None, 1)            65          ['batch_normalization_21[0][0]'] \n",
      "                                                                                                  \n",
      " dense_26 (Dense)               (None, 1)            65          ['batch_normalization_23[0][0]'] \n",
      "                                                                                                  \n",
      " lambda_5 (Lambda)              (None, 1)            0           ['dense_23[0][0]',               \n",
      "                                                                  'dense_26[0][0]']               \n",
      "                                                                                                  \n",
      "==================================================================================================\n",
      "Total params: 5,458\n",
      "Trainable params: 5,066\n",
      "Non-trainable params: 392\n",
      "__________________________________________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "    # setup for testing; use another instance for testing\n",
    "    env_test = TradingEnv(continuous_action_flag=True, sabr_flag=True, dg_random_seed=2, init_ttm=20, trade_freq=1, spread=0.01, num_contract=1, num_sim=100001)\n",
    "    ddpg_test = DDPG(env_test)\n",
    "    ddpg_test.load()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a6cdcd6f-30a2-4137-8ae0-ba511c83e85d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "testing...\n",
      "{'path_row': 0}\n",
      "episode: 0 | final wealth: -78.51; so far mean and variance of final wealth was -78.51312288068264 and 0.0\n",
      "episode: 0 | so far Y(0): 78.51\n",
      "episode: 0 | rewards: [-16.29   5.58   1.07   3.85   7.78  -4.08   1.84 -23.76 -24.42 -21.14\n",
      "   4.66  26.25  -4.72 -22.77   5.95 -10.31  -4.19   6.51  -6.77  -3.55]\n",
      "episode: 0 | action taken: [32.57 34.87 36.36 29.78 31.07 24.14 28.66 33.35 26.34 17.12 13.23 15.32\n",
      " 25.22 23.71 18.4  16.61 11.86  7.96  3.74  0.84]\n",
      "episode: 0 | deltas [51.13 47.33 46.73 27.87 41.8  24.96 17.44 21.16 10.9   4.42  1.8   1.74\n",
      "  8.15  6.4   2.35  2.43  0.85  0.32  0.85  0.    0.  ]\n",
      "episode: 0 | stock price [100.    99.49  99.43  96.82  98.92  96.85  95.89  96.48  95.02  93.82\n",
      "  92.85  93.46  95.86  95.92  94.81  95.4   94.8   94.79  96.1   95.26\n",
      "  95.28]\n",
      "episode: 0 | option price [225.84 192.82 182.92  85.59 137.86  64.55  38.62  49.43  20.01   6.22\n",
      "   2.1    1.85  10.51   7.18   2.21   2.05   0.6    0.18   0.45   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 1000}\n",
      "episode: 1000 | final wealth: -255.52; so far mean and variance of final wealth was -133.7295597466971 and 21884.34738718073\n",
      "episode: 1000 | so far Y(0): 355.63\n",
      "episode: 1000 | rewards: [-23.94 -27.57 -26.31 -18.49 -31.28 -47.83 -27.74  -1.17  -3.3    8.57\n",
      "  -6.16   9.96   9.61  -3.65   2.45  36.02 -44.71   3.95 -41.01 -22.93]\n",
      "episode: 1000 | action taken: [32.57 35.78 44.59 46.18 49.35 58.08 70.61 79.51 80.79 82.92 82.48 82.88\n",
      " 81.25 79.09 76.88 73.69 67.7  61.   50.41 33.26]\n",
      "episode: 1000 | deltas [ 51.13  49.66  63.61  71.58  74.94  81.25  90.14  94.35  94.08  96.4\n",
      "  93.18  96.47  94.55  95.69  97.61  98.36  96.97  99.7   99.91 100.\n",
      " 100.  ]\n",
      "episode: 1000 | stock price [100.    99.8  101.68 102.75 103.3  104.35 106.02 106.92 106.51 106.89\n",
      " 105.87 106.6  105.79 105.35 105.57 105.41 103.87 105.14 104.86 105.46\n",
      " 105.01]\n",
      "episode: 1000 | option price [225.84 210.68 302.24 367.26 409.77 489.72 625.09 703.16 662.19 695.24\n",
      " 599.07 665.24 588.06 540.82 559.18 542.09 389.71 513.75 485.78 546.12\n",
      " 501.03]\n",
      "\n",
      "{'path_row': 2000}\n",
      "episode: 2000 | final wealth: 22.27; so far mean and variance of final wealth was -137.1652281254834 and 21179.83632309478\n",
      "episode: 2000 | so far Y(0): 355.46\n",
      "episode: 2000 | rewards: [-32.52   5.33  -5.42   8.45  10.5    5.28  10.39  -2.4   -6.58  11.16\n",
      "  13.3   21.02   6.95   4.84  -4.07  10.91 -14.57 -10.13  -8.57  -1.59]\n",
      "episode: 2000 | action taken: [32.57 37.07 38.97 42.59 39.16 40.12 45.01 47.34 45.81 41.99 43.01 46.88\n",
      " 50.42 49.01 46.99 43.77 34.27 21.85  6.87  1.61]\n",
      "episode: 2000 | deltas [51.13 52.84 47.59 56.51 50.35 50.23 52.01 45.65 33.71 24.3  25.03 31.87\n",
      " 43.87 45.46 50.32 60.92 38.56 14.62  4.56 11.39  0.  ]\n",
      "episode: 2000 | stock price [100.   100.24  99.51 100.72  99.91  99.91 100.13  99.44  98.24  97.36\n",
      "  97.66  98.4   99.51  99.66  99.99 100.65  99.31  97.82  97.36  98.68\n",
      "  98.2 ]\n",
      "episode: 2000 | option price [225.84 233.68 196.79 247.48 200.89 186.94 189.3  143.35  86.49  51.3\n",
      "  49.08  66.24  93.49  90.66 100.58 133.73  60.84  15.1    2.87   5.96\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 3000}\n",
      "episode: 3000 | final wealth: -163.78; so far mean and variance of final wealth was -134.07482628666614 and 20736.38818613779\n",
      "episode: 3000 | so far Y(0): 350.08\n",
      "episode: 3000 | rewards: [ -52.13  -28.24    7.24   21.58  -13.54   -5.46    6.81    9.02   -1.97\n",
      "  -10.15   -5.97    1.23   27.93   -0.17   -9.46   16.02    8.46   -5.03\n",
      "   53.38 -183.33]\n",
      "episode: 3000 | action taken: [32.57 40.77 51.42 53.19 55.96 60.47 65.32 69.89 69.21 68.21 68.39 65.96\n",
      " 65.03 61.93 58.53 54.36 48.66 39.41 27.95  8.28]\n",
      "episode: 3000 | deltas [ 51.13  61.33  72.32  66.3   61.58  72.86  71.46  77.98  73.69  72.5\n",
      "  83.55  86.44  87.64  78.78  81.21  88.8   89.04  88.87  94.39  92.31\n",
      " 100.  ]\n",
      "episode: 3000 | stock price [100.   101.4  102.8  101.92 101.2  102.54 102.4  102.93 102.21 102.1\n",
      " 103.38 103.78 103.79 102.45 102.57 103.12 102.73 102.46 102.51 101.61\n",
      " 103.34]\n",
      "episode: 3000 | option price [225.84 291.02 368.19 304.72 243.03 328.53 320.74 343.59 279.4  273.64\n",
      " 369.89 403.26 399.6  283.99 288.29 326.37 284.64 257.62 255.05 164.62\n",
      " 333.74]\n",
      "\n",
      "{'path_row': 4000}\n",
      "episode: 4000 | final wealth: -96.76; so far mean and variance of final wealth was -135.35026792461713 and 20912.888670707747\n",
      "episode: 4000 | so far Y(0): 352.27\n",
      "episode: 4000 | rewards: [-19.17   9.54 -14.56  -2.2   20.24   2.92  -9.92   1.01   0.6  -26.34\n",
      " -16.97 -33.59  18.     2.44  -3.04  23.31  -9.88 -29.65  -5.32  -4.18]\n",
      "episode: 4000 | action taken: [32.57 35.79 35.15 37.68 38.19 41.78 46.02 51.83 48.79 45.18 40.71 37.48\n",
      " 32.05 28.7  25.21 20.85 20.79 14.45  3.7   0.94]\n",
      "episode: 4000 | deltas [51.13 49.64 42.55 51.54 54.6  55.29 52.   59.5  37.11 32.88 17.92 11.74\n",
      "  6.17  8.46  6.79  4.41 10.49  2.58  0.02  0.    0.  ]\n",
      "episode: 4000 | stock price [100.    99.8   98.86 100.06 100.46 100.51 100.12 100.99  98.57  98.21\n",
      "  96.66  95.98  94.89  95.71  95.79  95.66  97.27  96.37  94.62  95.93\n",
      "  95.25]\n",
      "episode: 4000 | option price [225.84 206.08 159.57 215.74 230.55 211.5  188.88 234.22 101.88  80.99\n",
      "  33.51  18.53   8.42  11.53   8.07   4.42  10.57   1.77   0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 5000}\n",
      "episode: 5000 | final wealth: -176.87; so far mean and variance of final wealth was -136.8233559196759 and 20585.439774185576\n",
      "episode: 5000 | so far Y(0): 352.04\n",
      "episode: 5000 | rewards: [ -6.25  -0.84 -11.65   1.2  -16.47  -2.71 -23.19 -15.48  14.17   5.22\n",
      "  20.2  -13.15   5.6    8.73 -69.43 -58.04  -2.35  -8.02  -3.51  -0.89]\n",
      "episode: 5000 | action taken: [32.57 30.8  27.51 26.56 29.88 36.49 45.27 41.04 37.18 37.53 36.37 40.76\n",
      " 40.53 37.85 34.   22.12  8.89  4.96  1.74  0.44]\n",
      "episode: 5000 | deltas [51.13 37.02 35.23 38.56 40.83 47.78 47.44 27.85 21.04 27.74 23.04 33.35\n",
      " 21.73 18.18 18.29  2.22  0.21  0.2   0.01  0.    0.  ]\n",
      "episode: 5000 | stock price [100.    98.02  97.75  98.2   98.58  99.54  99.51  96.84  95.87  96.99\n",
      "  96.55  98.05  96.77  96.59  96.84  94.    91.78  92.88  91.97  91.66\n",
      "  93.27]\n",
      "episode: 5000 | option price [225.84 134.99 125.89 146.54 154.62 196.64 191.42  85.04  56.62  80.43\n",
      "  58.37  91.71  48.25  35.12  33.12   2.34   0.16   0.14   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 6000}\n",
      "episode: 6000 | final wealth: -393.05; so far mean and variance of final wealth was -136.66136719485334 and 20524.547886909815\n",
      "episode: 6000 | so far Y(0): 351.56\n",
      "episode: 6000 | rewards: [-40.14 -25.19  12.06   0.34   5.97   1.02 -22.03 -24.89  -8.47  -5.57\n",
      " -11.86 -11.5  -20.13 -75.36 -15.65 -12.36  -3.52 -52.68   0.34 -83.43]\n",
      "episode: 6000 | action taken: [32.57 38.23 47.22 47.04 46.76 50.07 55.9  62.88 68.63 71.01 72.85 71.62\n",
      " 70.55 70.13 72.9  75.21 75.81 74.56 73.2  55.3 ]\n",
      "episode: 6000 | deltas [ 51.13  55.71  63.57  50.59  65.27  66.69  68.23  78.87  85.97  84.65\n",
      "  89.1   92.42  94.58  97.3   99.72  99.86  99.97 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 6000 | stock price [100.   100.64 101.75  99.94 101.79 101.89 102.01 103.33 104.4  104.32\n",
      " 104.9  105.57 106.09 106.92 109.55 110.02 110.42 110.54 112.55 112.48\n",
      " 112.51]\n",
      "episode: 6000 | option price [ 225.84  254.33  316.02  209.37  295.92  294.51  296.26  385.86  470.82\n",
      "  467.78  512.29  570.75  618.68  695.81  955.04 1002.01 1041.94 1053.81\n",
      " 1255.39 1248.44 1250.85]\n",
      "\n",
      "{'path_row': 7000}\n",
      "episode: 7000 | final wealth: -144.05; so far mean and variance of final wealth was -136.68095035378872 and 20516.242112586613\n",
      "episode: 7000 | so far Y(0): 351.53\n",
      "episode: 7000 | rewards: [-19.12  18.45   2.76  -4.35   5.21  -5.27  -9.89 -14.22 -37.65 -12.84\n",
      "  -6.36  -1.21 -12.71 -21.05 -11.05  -0.57   1.41  -8.93  -5.01  -1.67]\n",
      "episode: 7000 | action taken: [32.57 33.16 30.71 23.63 21.97 24.81 46.05 45.35 42.48 36.45 31.44 26.13\n",
      " 20.98 15.47  9.61  6.05  5.39  4.6   1.5   0.33]\n",
      "episode: 7000 | deltas [51.13 43.35 36.7  27.32 27.79 30.09 35.8  36.   26.39 15.48 14.58  9.87\n",
      "  8.49  3.36  1.13  0.3   0.1   0.03  0.    0.    0.  ]\n",
      "episode: 7000 | stock price [100.    98.88  98.04  96.73  96.86  97.37  98.17  98.3   97.15  95.53\n",
      "  95.28  94.8   94.8   93.96  92.74  92.06  92.48  92.84  91.06  89.6\n",
      "  88.6 ]\n",
      "episode: 7000 | option price [225.84 175.94 129.13  83.53  84.1   88.56 110.89 105.85  67.35  33.35\n",
      "  31.43  17.74  13.95   4.14   1.17   0.25   0.06   0.01   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 8000}\n",
      "episode: 8000 | final wealth: 80.52; so far mean and variance of final wealth was -137.36536220955813 and 20583.719234635257\n",
      "episode: 8000 | so far Y(0): 352.57\n",
      "episode: 8000 | rewards: [-47.66  16.3  -36.6   22.57   7.81   9.62  10.63  -2.16  -3.74 -48.56\n",
      " -32.37  -6.76  13.67  26.31  46.23 -48.11 -16.09  98.62  61.72   9.07]\n",
      "episode: 8000 | action taken: [32.57 38.59 39.48 45.5  41.53 41.65 47.64 52.4  51.63 54.34 61.52 63.12\n",
      " 65.03 64.83 61.33 55.12 49.73 42.93 29.19  9.3 ]\n",
      "episode: 8000 | deltas [ 51.13  56.53  45.    66.27  51.35  50.15  57.01  58.25  48.52  69.3\n",
      "  87.52  93.04  95.54  95.73  94.12  83.55  95.37  98.26  90.32  79.28\n",
      " 100.  ]\n",
      "episode: 8000 | stock price [100.   100.77  99.15 102.09 100.04  99.89 100.69 100.76  99.77 101.82\n",
      " 103.98 104.93 105.21 104.78 103.98 102.31 103.62 103.89 101.94 100.8\n",
      " 100.51]\n",
      "episode: 8000 | option price [225.84 266.03 181.09 333.05 210.94 193.12 216.69 203.37 148.64 257.22\n",
      " 420.7  504.18 526.37 483.07 404.71 252.42 366.51 390.41 200.9   92.01\n",
      "  50.79]\n",
      "\n",
      "{'path_row': 9000}\n",
      "episode: 9000 | final wealth: -254.08; so far mean and variance of final wealth was -137.28580380857528 and 20576.76308742578\n",
      "episode: 9000 | so far Y(0): 352.45\n",
      "episode: 9000 | rewards: [-80.35 -62.64  17.56  12.31 -22.64  -0.4  -43.65 -17.62  -5.86 -10.95\n",
      " -22.7  -17.16  -7.84   1.22 -13.5    1.97   4.67   9.54   3.87   0.07]\n",
      "episode: 9000 | action taken: [32.57 45.52 53.21 57.33 57.27 51.98 47.45 37.43 30.8  23.95 18.25 13.2\n",
      "  9.3   6.64  6.09  2.81  3.59  4.13  2.97  1.22]\n",
      "episode: 9000 | deltas [51.13 66.98 78.82 69.08 54.36 37.9  37.17 18.23 14.34 13.66  8.39  3.79\n",
      "  1.25  0.96  0.68  0.05  0.15  0.17  1.16  4.69  0.  ]\n",
      "episode: 9000 | stock price [100.   102.24 104.16 102.61 100.44  98.26  98.21  95.68  95.13  95.07\n",
      "  94.29  92.84  91.57  91.08  91.56  89.31  91.08  92.58  95.18  97.52\n",
      "  97.66]\n",
      "episode: 9000 | option price [225.84 346.52 483.26 375.18 234.48 132.15 124.98  44.04  31.42  29.17\n",
      "  14.94   5.75   1.52   1.16   0.72   0.04   0.12   0.12   0.81   2.8\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 10000}\n",
      "episode: 10000 | final wealth: -435.97; so far mean and variance of final wealth was -137.07942705660716 and 20589.107801509115\n",
      "episode: 10000 | so far Y(0): 352.31\n",
      "episode: 10000 | rewards: [ -13.72   13.33   12.41   -8.44   -2.     -8.82  -11.8     8.15   -5.26\n",
      "    2.95   14.8     9.77  -10.29   15.54  -60.03 -109.71  -55.51  -47.49\n",
      " -115.91  -63.93]\n",
      "episode: 10000 | action taken: [32.57 34.81 34.12 32.37 32.17 34.68 53.6  55.7  56.73 57.23 57.66 57.35\n",
      " 55.42 55.5  54.11 52.94 51.88 48.57 44.27 37.81]\n",
      "episode: 10000 | deltas [ 51.13  47.13  41.79  40.02  43.08  44.92  54.62  53.78  62.03  69.16\n",
      "  73.06  74.07  68.28  79.05  78.69  95.37  99.83 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 10000 | stock price [100.    99.47  98.8   98.66  99.02  99.25 100.43 100.32 101.19 101.98\n",
      " 102.32 102.19 101.57 102.52 102.24 104.18 106.59 107.72 108.57 110.57\n",
      " 110.81]\n",
      "episode: 10000 | option price [ 225.84  189.59  150.85  133.05  151.33  160.64  207.86  194.89  233.03\n",
      "  281.72  297.62  275.16  229.72  290.29  259.1   422.9   658.84  772.\n",
      "  857.38 1057.02 1080.95]\n",
      "\n",
      "{'path_row': 11000}\n",
      "episode: 11000 | final wealth: -94.63; so far mean and variance of final wealth was -136.74592882925623 and 20420.4186575464\n",
      "episode: 11000 | so far Y(0): 351.10\n",
      "episode: 11000 | rewards: [-13.85  19.48   0.62   6.05  -9.97  -7.85 -31.21   9.92   7.28 -11.55\n",
      "   7.12 -20.11   6.33 -33.15 -10.69  -4.92  -4.88   3.13  -4.52  -1.87]\n",
      "episode: 11000 | action taken: [32.57 33.96 31.02 23.35 20.95 13.74 19.03 14.83 18.14 18.36 13.78 21.86\n",
      " 15.7  16.99  9.13  5.5   4.01  2.55  1.73  0.35]\n",
      "episode: 11000 | deltas [51.13 45.06 35.07 24.74 23.28 10.29  6.79  4.15  5.07  8.07  4.86 11.77\n",
      "  6.3   7.16  1.    0.36  0.04  0.    0.    0.    0.  ]\n",
      "episode: 11000 | stock price [100.    99.17  97.91  96.51  96.62  94.42  93.73  92.11  93.12  94.04\n",
      "  93.05  94.97  93.82  94.64  92.17  91.71  91.37  90.48  92.23  90.06\n",
      "  89.19]\n",
      "episode: 11000 | option price [225.84 179.98 116.27  69.51  58.65  20.25  11.79   7.15   8.35  14.64\n",
      "   7.94  22.98  10.38  11.03   1.07   0.32   0.03   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 12000}\n",
      "episode: 12000 | final wealth: -367.32; so far mean and variance of final wealth was -136.0142264098735 and 20372.084286323683\n",
      "episode: 12000 | so far Y(0): 350.11\n",
      "episode: 12000 | rewards: [  -8.25   -1.72    7.48  -40.38   15.59    8.31    1.7    -2.02  -11.67\n",
      "   -5.73    9.97   -1.79    2.9     0.1     3.56  -21.44  -20.85  -47.76\n",
      "  -64.16 -191.16]\n",
      "episode: 12000 | action taken: [32.57 34.82 37.7  39.71 44.74 48.02 54.03 57.3  56.04 51.25 47.27 51.69\n",
      " 53.73 52.11 48.42 44.9  42.59 36.54 28.8  10.98]\n",
      "episode: 12000 | deltas [ 51.13  47.01  49.95  50.8   70.29  64.99  65.19  61.21  49.72  43.13\n",
      "  37.87  49.68  62.36  62.49  52.54  63.85  77.22  88.15  96.73  99.95\n",
      " 100.  ]\n",
      "episode: 12000 | stock price [100.    99.47  99.86  99.98 102.34 101.62 101.55 101.08  99.89  99.22\n",
      "  98.71  99.9  101.05 101.03 100.16 101.05 102.08 102.83 103.66 104.49\n",
      " 106.3 ]\n",
      "episode: 12000 | option price [225.84 184.15 197.42 191.5  323.66 270.58 255.44 222.4  153.16 125.57\n",
      " 100.57 143.1  199.91 193.69 146.75 182.33 246.8  296.91 369.12 449.02\n",
      " 629.74]\n",
      "\n",
      "{'path_row': 13000}\n",
      "episode: 13000 | final wealth: -72.47; so far mean and variance of final wealth was -136.23901726967918 and 20433.9299434649\n",
      "episode: 13000 | so far Y(0): 350.66\n",
      "episode: 13000 | rewards: [-10.15   7.3    1.62  -0.74 -11.39  -6.61  -6.51   3.88  13.47   6.16\n",
      "   5.82   0.09  -5.31  11.9  -17.93 -11.54   3.93 -33.57 -17.68  -5.2 ]\n",
      "episode: 13000 | action taken: [32.57 33.87 36.51 37.01 37.6  42.75 48.49 54.26 51.5  50.16 52.09 54.66\n",
      " 52.79 48.64 43.85 35.23 25.51 18.1   4.75  0.72]\n",
      "episode: 13000 | deltas [51.13 44.7  49.44 46.81 51.93 57.75 56.77 61.58 42.32 50.03 57.42 59.8\n",
      " 59.69 39.83 36.57 20.97 13.05 13.63  0.41  0.    0.  ]\n",
      "episode: 13000 | stock price [100.    99.13  99.8   99.48 100.12 100.82 100.71 101.28  99.07  99.92\n",
      " 100.64 100.82 100.8   99.05  98.93  97.7   97.15  97.62  95.37  94.28\n",
      "  93.27]\n",
      "episode: 13000 | option price [225.84 175.16 189.36 173.18 197.07 234.28 231.01 259.42 129.71 157.4\n",
      " 185.91 187.78 183.8   95.04  73.09  32.35  15.99  14.53   0.22   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 14000}\n",
      "episode: 14000 | final wealth: -600.46; so far mean and variance of final wealth was -136.69324227400517 and 20407.385415238812\n",
      "episode: 14000 | so far Y(0): 350.97\n",
      "episode: 14000 | rewards: [ -61.07  -39.57  -20.41   10.07    1.36   11.01   11.49   -8.18   -0.46\n",
      "   10.17  -24.62  -26.5    -5.43  -12.59   26.3   -42.01  -21.85  -65.84\n",
      " -135.04 -207.32]\n",
      "episode: 14000 | action taken: [32.57 43.22 51.79 56.43 60.86 64.41 64.95 65.24 64.81 61.48 57.97 60.05\n",
      " 61.22 62.54 61.26 57.11 52.18 45.89 42.12 34.13]\n",
      "episode: 14000 | deltas [ 51.13  64.68  74.45  78.07  69.46  74.02  58.96  60.73  59.22  54.14\n",
      "  61.62  82.03  90.88  92.8   95.57  94.56  98.54  99.67 100.   100.\n",
      " 100.  ]\n",
      "episode: 14000 | stock price [100.   101.84 103.21 103.77 102.51 103.03 100.93 101.08 100.94 100.36\n",
      " 101.12 103.4  104.58 104.8  105.23 104.5  105.5  105.87 106.97 109.23\n",
      " 111.67]\n",
      "episode: 14000 | option price [ 225.84  314.3   402.17  442.65  357.01  382.22  232.69  229.99  229.17\n",
      "  191.31  224.81  377.69  472.95  490.53  529.12  456.35  551.36  587.4\n",
      "  696.95  923.27 1166.89]\n",
      "\n",
      "{'path_row': 15000}\n",
      "episode: 15000 | final wealth: -68.32; so far mean and variance of final wealth was -136.6648517970477 and 20574.48802603731\n",
      "episode: 15000 | so far Y(0): 351.82\n",
      "episode: 15000 | rewards: [-27.35   6.08  -5.79  -2.11   5.78   3.02 -12.36  -0.64 -12.21   4.47\n",
      "   5.34 -26.    56.55 -25.41   3.61  -3.13  -6.6  -11.12 -15.4   -5.04]\n",
      "episode: 15000 | action taken: [32.57 37.18 38.65 34.21 32.43 36.32 47.62 45.47 43.19 39.11 38.62 39.5\n",
      " 36.2  38.44 34.02 28.46 21.57 15.5   4.76  0.82]\n",
      "episode: 15000 | deltas [51.13 53.14 46.3  33.41 42.44 47.7  48.47 31.37 27.34 18.9  19.92 21.44\n",
      "  9.92 21.59 10.63  8.1   5.83  3.25  0.54  0.    0.  ]\n",
      "episode: 15000 | stock price [100.   100.28  99.35  97.48  98.83  99.59  99.7   97.79  97.43  96.54\n",
      "  96.79  97.03  95.68  97.82  96.7   96.79  96.76  96.63  96.16  95.04\n",
      "  94.42]\n",
      "episode: 15000 | option price [225.84 229.75 184.54 116.63 160.61 177.67 174.87  84.99  66.92  38.46\n",
      "  39.89  43.32  15.    32.8   12.99   8.17   5.     2.26   0.25   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 16000}\n",
      "episode: 16000 | final wealth: -168.84; so far mean and variance of final wealth was -136.4043405012912 and 20590.43466553527\n",
      "episode: 16000 | so far Y(0): 351.64\n",
      "episode: 16000 | rewards: [ -21.36    7.24    5.77   -4.42    3.15    0.48  -28.89  -57.66  -11.91\n",
      "   -4.74   16.03  -33.23    4.83   29.12  -76.72   73.98   88.48    4.16\n",
      " -117.81  -45.33]\n",
      "episode: 16000 | action taken: [32.57 37.58 41.34 41.41 34.97 34.83 49.11 55.32 63.08 66.96 69.17 67.16\n",
      " 67.62 65.97 62.55 60.59 54.56 43.98 30.34 11.81]\n",
      "episode: 16000 | deltas [ 51.13  54.22  52.    47.76  38.57  42.45  48.24  64.35  85.78  87.28\n",
      "  89.23  86.56  93.22  95.3   92.95  98.94  96.9   86.42  88.27  99.76\n",
      " 100.  ]\n",
      "episode: 16000 | stock price [100.   100.42 100.13  99.61  98.43  99.    99.7  101.57 104.52 104.75\n",
      " 104.96 104.19 105.61 105.6  104.59 106.79 104.8  102.44 102.26 103.91\n",
      " 104.06]\n",
      "episode: 16000 | option price [225.84 228.17 205.   174.2  129.64 140.24 163.92 270.15 485.08 503.24\n",
      " 517.71 446.48 572.63 566.68 469.43 679.94 483.66 259.99 236.8  390.73\n",
      " 406.38]\n",
      "\n",
      "{'path_row': 17000}\n",
      "episode: 17000 | final wealth: -116.17; so far mean and variance of final wealth was -136.852258270183 and 20529.174517035128\n",
      "episode: 17000 | so far Y(0): 351.77\n",
      "episode: 17000 | rewards: [-55.74 -55.63   0.85 -15.94   6.05 -11.36   6.95 -21.07  -4.82  -2.06\n",
      "   0.11  -6.51   6.2    3.23 -10.54  29.09  42.27   4.   -19.24 -12.01]\n",
      "episode: 17000 | action taken: [32.57 39.68 52.39 55.49 62.31 64.12 71.23 69.21 63.86 60.5  57.49 54.\n",
      " 51.14 52.16 50.33 49.67 43.56 28.53 13.52  1.1 ]\n",
      "episode: 17000 | deltas [51.13 59.09 72.87 67.22 75.15 68.85 79.15 67.67 51.74 53.51 61.91 53.46\n",
      " 51.46 59.81 62.82 76.37 70.59 31.64 29.58  0.24  0.  ]\n",
      "episode: 17000 | stock price [100.   101.14 103.21 102.32 103.52 102.46 104.04 102.09 100.09 100.31\n",
      " 101.36 100.3  100.06 101.02 101.33 102.71 101.87  98.52  98.65  94.99\n",
      "  95.64]\n",
      "episode: 17000 | option price [225.84 286.02 416.69 356.17 435.65 356.43 467.11 313.75 194.81 207.91\n",
      " 270.35 206.21 196.2  236.44 248.14 326.2  254.67  60.19  45.11   0.12\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 18000}\n",
      "episode: 18000 | final wealth: 89.51; so far mean and variance of final wealth was -136.95712466043398 and 20506.610105926622\n",
      "episode: 18000 | so far Y(0): 351.76\n",
      "episode: 18000 | rewards: [-38.24  11.18   7.11  -3.24  12.52  10.58  -4.41  -1.8   17.41  -7.46\n",
      "  -8.64  15.16  28.87  -4.44   4.86   4.1    0.21   4.34   6.29  35.11]\n",
      "episode: 18000 | action taken: [32.57 38.77 42.43 39.81 37.97 34.8  37.34 47.11 47.41 48.04 47.13 46.02\n",
      " 46.71 49.29 43.43 39.16 33.5  25.61 11.13  2.24]\n",
      "episode: 18000 | deltas [51.13 57.2  50.52 38.19 52.68 36.53 37.44 46.98 41.33 48.84 39.3  26.49\n",
      " 28.64 47.7  31.32 36.44 45.87 48.84 52.86 53.94  0.  ]\n",
      "episode: 18000 | stock price [100.   100.83  99.93  98.36 100.21  98.25  98.51  99.58  99.03  99.83\n",
      "  98.92  97.76  98.15  99.8   98.7   99.13  99.75  99.92 100.1  100.1\n",
      "  99.99]\n",
      "episode: 18000 | option price [225.84 258.6  206.23 129.   203.11 114.51 109.59 151.63 117.75 137.76\n",
      " 100.92  54.23  55.69 103.21  51.27  59.21  75.05  74.99  67.3   46.49\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 19000}\n",
      "episode: 19000 | final wealth: -210.67; so far mean and variance of final wealth was -136.65689957306392 and 20437.14367417938\n",
      "episode: 19000 | so far Y(0): 351.09\n",
      "episode: 19000 | rewards: [-25.59   9.16   6.4   10.15   1.82 -19.14 -15.14  14.68 -23.58  -8.19\n",
      "  -9.71  20.92 -32.19 -72.87 -18.73 -34.21 -12.39   5.68  -5.17  -2.57]\n",
      "episode: 19000 | action taken: [32.57 35.9  38.9  37.29 32.12 30.56 50.5  50.23 51.2  46.16 43.12 41.32\n",
      " 44.43 37.49 25.78 16.05  6.62  3.28  2.33  0.47]\n",
      "episode: 19000 | deltas [51.13 49.97 50.25 39.86 33.95 36.88 45.56 41.12 51.69 34.8  29.03 22.07\n",
      " 29.96 14.61  3.11  1.2   0.08  0.    0.02  0.    0.  ]\n",
      "episode: 19000 | stock price [100.    99.84  99.9   98.54  97.89  98.35  99.35  98.86 100.09  98.14\n",
      "  97.52  96.76  97.85  96.15  93.8   93.39  91.76  91.19  93.85  92.01\n",
      "  91.09]\n",
      "episode: 19000 | option price [225.84 213.72 203.16 140.99 104.89 112.9  160.99 131.89 178.51 101.42\n",
      "  75.91  50.03  72.42  26.04   3.83   1.15   0.05   0.     0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 20000}\n",
      "episode: 20000 | final wealth: -142.91; so far mean and variance of final wealth was -136.55873636381315 and 20466.410703758796\n",
      "episode: 20000 | so far Y(0): 351.15\n",
      "episode: 20000 | rewards: [-27.16  16.44 -11.19 -15.1  -15.37  -3.86  10.48 -81.6  -16.52   8.23\n",
      "   0.71  11.72   7.29 -16.    -4.56   4.67   6.67 -11.21  -3.22  -3.31]\n",
      "episode: 20000 | action taken: [32.57 35.64 32.32 30.03 33.6  40.46 40.58 44.   34.15 23.34 19.8  19.11\n",
      " 20.38 19.26 14.23 10.17  9.54  8.46  2.6   0.74]\n",
      "episode: 20000 | deltas [51.13 49.37 34.42 39.65 47.26 54.08 41.34 37.65 13.13  9.85 13.56 11.55\n",
      " 11.14  9.96  4.3   2.33  2.42  2.6   0.11  0.01  0.  ]\n",
      "episode: 20000 | stock price [100.    99.75  97.69  98.39  99.47 100.41  98.6   98.17  94.07  93.55\n",
      "  94.72  94.58  95.06  95.27  93.95  93.73  94.55  95.3   93.83  94.68\n",
      "  93.52]\n",
      "episode: 20000 | option price [225.84 212.35 119.24 149.94 195.09 238.63 162.41 134.39  32.28  21.61\n",
      "  30.68  23.86  20.6   16.44   5.85   2.61   2.41   2.3    0.06   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 21000}\n",
      "episode: 21000 | final wealth: -484.91; so far mean and variance of final wealth was -136.32701351278925 and 20456.32121407229\n",
      "episode: 21000 | so far Y(0): 350.87\n",
      "episode: 21000 | rewards: [ -78.09  -52.11  -24.92   22.75    4.58    9.22   -3.74  -10.67  -25.89\n",
      "   22.42  -20.89    0.62   43.66    6.6     1.8   -42.04  -76.72    5.02\n",
      "  -86.29 -180.23]\n",
      "episode: 21000 | action taken: [32.57 46.13 53.59 60.92 63.74 66.1  67.8  71.02 74.97 78.85 77.62 77.74\n",
      " 76.79 72.53 66.61 60.19 52.95 45.95 37.41 22.85]\n",
      "episode: 21000 | deltas [ 51.13  68.35  78.73  83.72  70.4   74.82  66.77  76.69  87.55  95.39\n",
      "  90.68  96.24  96.43  82.81  79.34  80.55  94.38  99.62  99.89 100.\n",
      " 100.  ]\n",
      "episode: 21000 | stock price [100.   102.37 103.95 104.75 102.59 103.06 101.87 103.16 104.68 106.31\n",
      " 104.65 106.01 105.99 102.97 102.39 102.31 103.81 105.4  105.18 106.41\n",
      " 108.23]\n",
      "episode: 21000 | option price [225.84 348.48 459.76 519.81 357.79 380.08 289.69 379.46 494.65 638.58\n",
      " 481.11 606.1  604.09 327.74 274.1  261.28 386.89 540.41 517.63 641.17\n",
      " 822.65]\n",
      "\n",
      "{'path_row': 22000}\n",
      "episode: 22000 | final wealth: -49.33; so far mean and variance of final wealth was -136.56011645740938 and 20473.802443534205\n",
      "episode: 22000 | so far Y(0): 351.19\n",
      "episode: 22000 | rewards: [-53.57  26.85   5.59 -15.34   1.15  -1.68   5.07  -8.35  -5.73  18.08\n",
      "  20.96   5.68  -1.36 -10.43 -17.7  -22.59  11.66   6.19  -6.66  -7.16]\n",
      "episode: 22000 | action taken: [32.57 40.41 40.59 39.16 30.68 24.12 33.68 38.09 34.97 32.86 34.68 41.38\n",
      " 50.78 48.18 42.31 34.42 24.21 18.26  7.14  1.47]\n",
      "episode: 22000 | deltas [51.13 60.55 42.66 38.51 23.82 26.32 21.94 27.94 17.66 17.52 25.29 35.95\n",
      " 47.78 41.41 27.63 14.11  5.    7.99 10.99  2.42  0.  ]\n",
      "episode: 22000 | stock price [100.   101.31  98.9   98.4   96.38  96.89  96.36  97.33  96.25  96.18\n",
      "  97.39  98.74  99.78  99.36  98.41  97.48  96.69  97.66  98.37  98.12\n",
      "  97.43]\n",
      "episode: 22000 | option price [225.84 289.59 157.32 131.19  65.91  72.46  55.04  73.33  36.26  36.38\n",
      "  55.95  80.07 111.13  81.57  43.66  16.31   4.07   5.88   6.91   0.85\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 23000}\n",
      "episode: 23000 | final wealth: -165.14; so far mean and variance of final wealth was -136.67458605987014 and 20550.3684951324\n",
      "episode: 23000 | so far Y(0): 351.71\n",
      "episode: 23000 | rewards: [ -29.68  -29.06   22.82   -5.53    7.54    6.32    4.23   -5.55    1.87\n",
      "    0.85   12.3     7.83    2.54    0.42    4.72   -2.37    5.35   -8.23\n",
      " -159.79   -1.72]\n",
      "episode: 23000 | action taken: [32.57 37.06 45.21 44.23 40.12 38.   37.82 47.73 48.9  51.44 55.77 54.25\n",
      " 50.47 49.96 45.28 40.64 35.99 28.5  15.13  3.91]\n",
      "episode: 23000 | deltas [ 51.13  52.84  61.69  46.75  49.73  42.79  36.4   48.26  47.15  60.17\n",
      "  70.1   58.81  48.16  51.47  43.63  44.89  56.92  62.9   74.57  99.36\n",
      " 100.  ]\n",
      "episode: 23000 | stock price [100.   100.24 101.49  99.45  99.83  98.96  98.2   99.69  99.58 101.01\n",
      " 101.95 100.75  99.79 100.07  99.44  99.58 100.43 100.71 101.16 103.2\n",
      " 103.06]\n",
      "episode: 23000 | option price [225.84 230.76 301.46 178.37 199.67 153.08 115.96 167.99 158.22 224.99\n",
      " 270.11 186.24 124.75 132.62 100.44  97.31 129.63 129.82 143.12 320.32\n",
      " 305.87]\n",
      "\n",
      "{'path_row': 24000}\n",
      "episode: 24000 | final wealth: -312.00; so far mean and variance of final wealth was -137.08180492343067 and 20642.011142358308\n",
      "episode: 24000 | so far Y(0): 352.59\n",
      "episode: 24000 | rewards: [-13.54 -19.69 -28.87 -23.67  26.51  11.82  -3.69 -25.07 -18.94 -31.58\n",
      "  -8.93  15.88   2.76  14.25  56.33 -19.84 -26.79 -55.69 -73.05 -90.21]\n",
      "episode: 24000 | action taken: [32.57 34.55 39.67 44.98 48.39 51.33 53.57 59.23 64.12 67.96 71.63 71.84\n",
      " 70.53 68.56 66.15 60.38 53.03 45.1  36.73 22.13]\n",
      "episode: 24000 | deltas [ 51.13  46.47  55.14  64.57  73.6   64.89  58.37  70.25  79.65  88.58\n",
      "  95.11  96.1   96.04  95.97  95.78  84.89  92.74  97.59  99.88 100.\n",
      " 100.  ]\n",
      "episode: 24000 | stock price [100.    99.37 100.55 101.87 103.09 101.78 100.9  102.29 103.61 104.82\n",
      " 106.16 106.41 105.85 105.71 105.2  102.93 103.66 104.2  105.1  106.12\n",
      " 106.77]\n",
      "episode: 24000 | option price [225.84 186.34 244.91 320.74 393.91 300.77 240.78 316.39 413.83 505.25\n",
      " 624.2  646.89 590.8  576.74 525.13 316.46 374.12 422.19 510.16 611.73\n",
      " 677.34]\n",
      "\n",
      "{'path_row': 25000}\n",
      "episode: 25000 | final wealth: -56.96; so far mean and variance of final wealth was -136.8029812459559 and 20639.0927712569\n",
      "episode: 25000 | so far Y(0): 352.30\n",
      "episode: 25000 | rewards: [-21.56 -88.07  13.59   5.08   4.2   10.03   6.88   5.63  13.79  -0.29\n",
      "  19.34   6.09   7.13 -18.64 -11.56  20.63   1.18 -16.3   46.3  -60.42]\n",
      "episode: 25000 | action taken: [32.57 36.9  52.64 55.23 55.18 52.46 52.39 54.49 55.4  54.35 55.34 53.24\n",
      " 53.93 52.33 52.16 50.04 44.47 35.62 25.42  6.49]\n",
      "episode: 25000 | deltas [ 51.13  52.44  77.    64.86  51.59  42.02  50.43  53.27  59.82  60.94\n",
      "  67.45  54.28  67.17  66.01  84.26  89.64  86.59  88.28  93.94  93.34\n",
      " 100.  ]\n",
      "episode: 25000 | stock price [100.   100.18 103.6  101.81 100.08  98.96  99.95 100.26 100.94 100.96\n",
      " 101.55 100.29 101.22 101.06 102.3  102.71 102.2  102.13 102.35 101.6\n",
      " 102.  ]\n",
      "episode: 25000 | option price [225.84 220.8  430.73 306.68 202.88 137.19 176.18 185.65 214.72 201.58\n",
      " 232.43 142.71 183.64 167.54 249.2  282.28 233.75 223.98 238.88 163.1\n",
      " 200.29]\n",
      "\n",
      "{'path_row': 26000}\n",
      "episode: 26000 | final wealth: -155.56; so far mean and variance of final wealth was -136.81268690263678 and 20667.123834483948\n",
      "episode: 26000 | so far Y(0): 352.45\n",
      "episode: 26000 | rewards: [-42.43  21.11   3.31  -1.94   7.19   6.45 -32.92  -1.54 -20.94   3.54\n",
      " -43.38  -4.49 -24.01 -17.31   0.55   3.93   0.36  -6.95  -5.18  -0.89]\n",
      "episode: 26000 | action taken: [32.57 37.02 34.99 29.38 24.32 24.25 43.54 41.88 40.87 36.03 33.63 25.62\n",
      " 17.76 10.85  5.88  5.73  5.73  4.53  1.59  0.34]\n",
      "episode: 26000 | deltas [51.13 52.7  37.86 32.14 31.08 28.7  32.74 30.48 27.76 18.38 20.26  8.37\n",
      "  6.59  2.41  0.54  0.44  0.36  0.12  0.    0.    0.  ]\n",
      "episode: 26000 | stock price [100.   100.22  98.13  97.36  97.25  97.1   97.82  97.39  97.08  95.75\n",
      "  96.12  93.9   93.84  92.46  91.2   92.04  92.73  92.76  91.45  89.89\n",
      "  91.49]\n",
      "episode: 26000 | option price [225.84 243.02 140.03 107.76 101.06  85.12  96.06  91.35  78.39  44.11\n",
      "  49.36  15.83  11.08   3.25   0.55   0.39   0.28   0.07   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 27000}\n",
      "episode: 27000 | final wealth: -128.36; so far mean and variance of final wealth was -136.9098113376463 and 20662.44145945948\n",
      "episode: 27000 | so far Y(0): 352.53\n",
      "episode: 27000 | rewards: [-43.71   8.84   2.45   8.16   0.5   14.71  -3.46 -36.48   4.4  -26.85\n",
      " -20.17   2.36  22.85 -11.42   3.69 -19.85 -10.42 -19.09  -2.95  -1.9 ]\n",
      "episode: 27000 | action taken: [32.57 38.51 43.65 42.75 37.72 39.46 40.98 45.01 40.69 40.52 34.8  28.21\n",
      " 23.1  23.93 20.06 18.5  11.64  6.64  1.78  0.51]\n",
      "episode: 27000 | deltas [51.13 56.39 54.8  51.13 45.9  49.56 41.45 38.87 22.67 27.54 14.76  8.55\n",
      "  8.3  13.73  6.32  6.35  1.84  0.36  0.    0.    0.  ]\n",
      "episode: 27000 | stock price [100.   100.74 100.5  100.01  99.35  99.83  98.92  98.61  96.49  97.14\n",
      "  95.4   94.5   94.76  96.34  95.3   95.64  94.33  93.87  91.66  92.5\n",
      "  92.  ]\n",
      "episode: 27000 | option price [225.84 261.1  236.98 208.13 170.81 183.42 131.18 120.29  57.26  75.27\n",
      "  31.39  14.84  13.55  22.25   8.06   7.55   1.74   0.24   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 28000}\n",
      "episode: 28000 | final wealth: -115.44; so far mean and variance of final wealth was -136.78279028086186 and 20642.244664735532\n",
      "episode: 28000 | so far Y(0): 352.29\n",
      "episode: 28000 | rewards: [ -9.07  -0.24 -12.54 -11.82  -4.89   3.56  -8.22 -29.18  12.66   7.33\n",
      " -17.87 -22.07 -18.69  -0.5    4.46   6.26  -3.99  -1.05  -7.67  -1.92]\n",
      "episode: 28000 | action taken: [32.57 34.13 26.37 16.37 11.75  9.09 19.03 22.04 13.52 22.7  23.38 16.86\n",
      " 13.05  8.05  7.19  7.15  7.5   5.17  2.25  0.42]\n",
      "episode: 28000 | deltas [51.13 45.32 20.11 15.21 11.83  6.06  7.45  8.06  3.38 10.67 12.04  4.13\n",
      "  1.48  0.46  0.37  0.22  0.16  0.    0.    0.    0.  ]\n",
      "episode: 28000 | stock price [100.    99.23  95.66  94.82  94.07  92.69  93.62  93.75  92.1   94.73\n",
      "  95.49  94.06  92.89  91.64  92.13  92.84  93.71  93.21  93.43  91.23\n",
      "  91.54]\n",
      "episode: 28000 | option price [225.84 177.14  53.98  37.05  27.04  11.46  13.81  15.26   5.37  20.39\n",
      "  21.57   5.43   1.62   0.44   0.32   0.15   0.1    0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 29000}\n",
      "episode: 29000 | final wealth: -50.50; so far mean and variance of final wealth was -136.9669536129708 and 20673.479494740543\n",
      "episode: 29000 | so far Y(0): 352.64\n",
      "episode: 29000 | rewards: [ -4.53  -3.84   3.26  -9.24  -8.27  -3.38 -20.   -21.58   5.52  12.73\n",
      "   3.28   2.79  -9.08  11.18   3.21  -0.08  -9.61  -2.35   1.52  -2.04]\n",
      "episode: 29000 | action taken: [32.57 32.78 32.   24.54 15.8   9.51 12.77  9.9   6.46  7.87 10.11 10.51\n",
      " 11.11  7.59 10.43 10.42  8.6   5.07  2.16  0.8 ]\n",
      "episode: 29000 | deltas [51.13 41.78 41.4  27.45 18.93  8.39  5.39  1.31  0.26  0.55  1.4   1.54\n",
      "  1.85  0.61  2.23  2.29  1.01  0.09  0.02  0.06  0.  ]\n",
      "episode: 29000 | stock price [100.    98.74  98.66  96.59  95.11  92.9   92.3   90.32  88.25  89.63\n",
      "  91.55  92.09  92.42  91.51  93.65  94.2   94.05  93.04  93.22  95.18\n",
      "  95.17]\n",
      "episode: 29000 | option price [225.84 156.87 157.8   87.65  53.27  18.3   10.14   1.85   0.31   0.66\n",
      "   1.77   1.88   2.29   0.62   2.48   2.37   0.84   0.05   0.01   0.02\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 30000}\n",
      "episode: 30000 | final wealth: -145.77; so far mean and variance of final wealth was -137.23182508306215 and 20685.913792579795\n",
      "episode: 30000 | so far Y(0): 352.97\n",
      "episode: 30000 | rewards: [-20.25  -2.39   8.3    9.16  -9.38  11.77   5.61  -7.3    5.79  -6.78\n",
      " -13.39 -69.84  17.81   5.19 -10.42 -16.93  49.78  58.86 -75.31 -86.05]\n",
      "episode: 30000 | action taken: [32.57 35.16 40.91 42.28 37.57 40.99 42.78 45.55 49.83 50.97 56.1  58.94\n",
      " 62.48 63.33 61.   57.21 51.95 44.35 31.3  12.62]\n",
      "episode: 30000 | deltas [ 51.13  48.1   56.79  52.7   46.04  53.5   43.94  40.66  55.33  57.32\n",
      "  72.82  79.93  93.32  92.34  94.07  95.89  97.81  96.36  93.62  99.82\n",
      " 100.  ]\n",
      "episode: 30000 | stock price [100.    99.58 100.74 100.21  99.42 100.3   99.23  98.92 100.48 100.65\n",
      " 102.12 102.81 105.14 104.54 104.48 104.76 105.12 103.95 102.71 103.69\n",
      " 104.3 ]\n",
      "episode: 30000 | option price [225.84 199.99 240.3  204.69 160.67 198.41 139.6  118.82 194.34 192.95\n",
      " 273.14 319.98 524.39 465.5  455.52 480.48 514.26 397.9  276.52 368.91\n",
      " 430.17]\n",
      "\n",
      "{'path_row': 31000}\n",
      "episode: 31000 | final wealth: -239.41; so far mean and variance of final wealth was -137.33346248077984 and 20758.180362575997\n",
      "episode: 31000 | so far Y(0): 353.45\n",
      "episode: 31000 | rewards: [ -15.07   16.25    8.79   -3.61  -11.31   -3.19   -8.45  -40.82   33.07\n",
      "  -10.71    0.49   -2.04   10.81   -4.95   11.62    7.55   33.04  -17.36\n",
      "  -36.07 -207.43]\n",
      "episode: 31000 | action taken: [32.57 34.28 31.36 27.49 20.44 27.55 48.77 51.14 45.16 47.16 52.48 54.15\n",
      " 53.91 52.8  51.5  47.55 41.27 30.55 18.19  3.12]\n",
      "episode: 31000 | deltas [ 51.13  45.87  35.59  34.01  22.92  34.6   39.42  50.19  23.51  47.37\n",
      "  61.51  57.27  64.26  66.29  75.38  71.45  73.67  62.04  74.94  91.53\n",
      " 100.  ]\n",
      "episode: 31000 | stock price [100.    99.28  97.94  97.86  96.25  98.05  98.73  99.93  97.    99.68\n",
      " 101.04 100.61 101.25 101.33 102.04 101.62 101.61 100.65 101.2  101.76\n",
      " 103.76]\n",
      "episode: 31000 | option price [225.84 184.87 120.88 106.81  62.4  103.81 118.56 164.8   53.57 135.52\n",
      " 208.21 179.99 215.28 208.28 249.73 214.83 202.81 123.91 147.25 181.02\n",
      " 376.13]\n",
      "\n",
      "{'path_row': 32000}\n",
      "episode: 32000 | final wealth: -719.09; so far mean and variance of final wealth was -137.3739306056261 and 20753.658440389067\n",
      "episode: 32000 | so far Y(0): 353.47\n",
      "episode: 32000 | rewards: [ -17.55  -38.32   11.26   14.92   -5.29  -24.29  -37.7    28.42    2.53\n",
      "  -46.67  -44.53   36.89   12.81   25.13  -80.4   -66.96   -2.73 -179.67\n",
      "   39.55 -346.47]\n",
      "episode: 32000 | action taken: [32.57 34.26 41.85 39.66 34.3  31.76 54.38 51.78 51.52 53.07 60.93 64.08\n",
      " 64.07 63.19 58.53 56.21 52.64 46.79 49.36 34.12]\n",
      "episode: 32000 | deltas [ 51.13  45.89  60.31  40.16  37.94  38.19  52.14  35.67  49.97  62.04\n",
      "  82.05  90.31  83.48  82.58  70.32  93.7   98.53  99.29 100.   100.\n",
      " 100.  ]\n",
      "episode: 32000 | stock price [100.    99.27 101.3   98.44  98.28  98.32 100.14  98.07  99.89 101.25\n",
      " 103.85 105.37 103.8  103.44 101.85 105.11 106.76 106.76 110.03 109.19\n",
      " 113.61]\n",
      "episode: 32000 | option price [ 225.84  187.1   293.3   154.68  131.2   132.43  212.28  114.62  177.86\n",
      "  245.24  427.94  557.49  416.54  380.71  253.76  520.2   677.65  676.52\n",
      " 1003.04  919.35 1361.15]\n",
      "\n",
      "{'path_row': 33000}\n",
      "episode: 33000 | final wealth: -387.41; so far mean and variance of final wealth was -137.54213506483984 and 20840.70783993198\n",
      "episode: 33000 | so far Y(0): 354.09\n",
      "episode: 33000 | rewards: [ -11.39   -3.     10.52   -9.01  -15.74  -37.99  -27.79   14.16    9.02\n",
      "   -8.93  -35.01   14.86    5.44   41.32   -7.87  -36.59   18.26 -200.4\n",
      "  -21.01  -86.24]\n",
      "episode: 33000 | action taken: [32.57 33.06 30.24 25.51 27.71 35.02 58.68 58.62 57.97 55.9  58.11 62.42\n",
      " 63.1  63.1  59.21 54.59 49.66 42.18 40.11 27.21]\n",
      "episode: 33000 | deltas [ 51.13  42.8   36.71  33.64  36.99  45.54  63.33  47.92  52.94  58.89\n",
      "  72.83  87.23  85.2   87.51  82.51  87.07  93.8   94.28  99.99 100.\n",
      " 100.  ]\n",
      "episode: 33000 | stock price [100.    98.85  97.89  97.58  98.06  99.25 101.6   99.62 100.24 100.92\n",
      " 102.54 104.47 103.86 103.91 102.63 102.97 103.91 103.47 106.9  107.22\n",
      " 107.81]\n",
      "episode: 33000 | option price [225.84 167.09 138.06 115.24 131.98 178.65 291.37 179.14 201.17 230.98\n",
      " 328.25 473.17 416.13 412.66 291.14 315.12 397.96 353.04 690.29 721.67\n",
      " 780.85]\n",
      "\n",
      "{'path_row': 34000}\n",
      "episode: 34000 | final wealth: 64.37; so far mean and variance of final wealth was -137.6561897022998 and 20802.827722365695\n",
      "episode: 34000 | so far Y(0): 354.00\n",
      "episode: 34000 | rewards: [-17.07 -13.92   3.6  -36.51  24.17  -6.23  -9.48  13.24  10.03  -1.18\n",
      "   7.01   2.55  -9.41  25.62  10.87  10.01 -13.56 -33.79  46.4   52.02]\n",
      "episode: 34000 | action taken: [32.57 34.23 37.98 38.6  42.84 45.88 52.08 51.19 49.96 50.79 51.98 53.47\n",
      " 48.76 43.45 44.31 43.31 36.71 29.56 17.2   2.88]\n",
      "episode: 34000 | deltas [ 51.13  45.79  52.13  47.41  64.06  58.96  63.12  40.55  45.21  55.66\n",
      "  55.67  53.79  39.45  28.61  41.94  58.04  54.68  68.41  85.91  79.7\n",
      " 100.  ]\n",
      "episode: 34000 | stock price [100.    99.26 100.14  99.49 101.83 101.03 101.55  98.68  99.31 100.54\n",
      " 100.55 100.32  98.86  97.86  99.3  100.52 100.27 101.05 101.9  101.15\n",
      " 100.6 ]\n",
      "episode: 34000 | option price [225.84 186.22 228.73 196.42 322.79 260.07 287.29 140.56 158.77 209.21\n",
      " 209.7  189.73 107.68  63.6   95.39 137.77 115.82 151.43 203.22 131.32\n",
      "  60.34]\n",
      "\n",
      "{'path_row': 35000}\n",
      "episode: 35000 | final wealth: -283.30; so far mean and variance of final wealth was -137.58304935028954 and 20782.08090538917\n",
      "episode: 35000 | so far Y(0): 353.82\n",
      "episode: 35000 | rewards: [-58.64 -66.85 -14.51  -7.63 -14.66   1.61 -43.39 -10.8   -9.18 -20.96\n",
      " -14.36   8.77  15.31  -7.79   6.14 -45.05   1.85   2.42  -2.65  -2.93]\n",
      "episode: 35000 | action taken: [32.57 40.34 52.71 56.83 55.99 49.73 43.64 35.   27.56 19.13 38.09 40.26\n",
      " 44.95 49.53 43.07 35.16 21.67 13.96  4.68  1.15]\n",
      "episode: 35000 | deltas [51.13 60.23 73.23 69.33 51.02 36.05 33.93 19.2  17.99 13.95 35.46 30.64\n",
      " 35.83 50.56 35.49 26.65  6.96  7.78  6.4   3.58  0.  ]\n",
      "episode: 35000 | stock price [100.   101.3  103.4  102.88  99.96  97.72  97.53  95.15  94.94  94.31\n",
      "  97.97  97.41  98.16  99.97  98.37  97.72  95.32  96.01  96.48  97.\n",
      "  96.38]\n",
      "episode: 35000 | option price [225.84 294.13 437.82 412.25 249.91 138.32 120.77  54.43  49.74  34.56\n",
      " 117.56  91.96 111.46 172.54  96.66  56.08   9.27   9.46   6.22   2.31\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 36000}\n",
      "episode: 36000 | final wealth: -69.23; so far mean and variance of final wealth was -137.61019100748695 and 20762.386733719362\n",
      "episode: 36000 | so far Y(0): 353.75\n",
      "episode: 36000 | rewards: [-16.05  11.48  15.26  -3.76  -1.67  11.51   0.99  -7.97  20.6    3.81\n",
      " -19.91 -16.59  -2.81 -17.71 -26.95  14.86 -15.97  -9.59  -6.29  -2.45]\n",
      "episode: 36000 | action taken: [32.57 34.15 34.85 29.07 25.77 25.2  43.97 43.73 42.4  46.16 46.64 44.18\n",
      " 41.32 37.54 31.21 23.13 18.36 11.25  3.5   0.86]\n",
      "episode: 36000 | deltas [51.13 45.58 44.83 29.86 32.24 28.96 32.52 33.14 27.05 39.17 37.89 18.41\n",
      " 11.58  8.15  4.45  1.62  3.13  0.57  0.03  0.    0.  ]\n",
      "episode: 36000 | stock price [100.    99.23  99.19  97.31  97.67  97.22  97.93  98.22  97.56  98.93\n",
      "  98.88  97.21  96.56  96.41  95.9   95.14  96.16  95.43  95.15  95.46\n",
      "  96.5 ]\n",
      "episode: 36000 | option price [225.84 184.33 169.69  88.41  97.04  83.84  89.62  82.9   61.99  98.2\n",
      "  88.37  29.79  15.58   9.18   4.24   1.27   2.43   0.32   0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 37000}\n",
      "episode: 37000 | final wealth: 76.88; so far mean and variance of final wealth was -137.63030861042827 and 20771.72171770349\n",
      "episode: 37000 | so far Y(0): 353.82\n",
      "episode: 37000 | rewards: [-27.71  10.11 -17.44   4.95  25.56  -2.21 -29.88   6.29  15.31 -16.52\n",
      "   6.64  22.44 -17.97  19.     4.6   20.15   7.2   -4.91  29.8   21.48]\n",
      "episode: 37000 | action taken: [32.57 35.08 30.41 28.02 27.95 21.24 38.35 37.22 33.79 35.56 31.59 30.88\n",
      " 35.7  35.77 37.4  39.47 33.33 24.37  9.79  1.91]\n",
      "episode: 37000 | deltas [51.13 48.07 31.29 39.53 38.48 22.97 26.9  20.63 21.78 28.37 13.91 19.15\n",
      " 30.3  22.26 34.66 52.83 45.33 40.42 50.87 33.04  0.  ]\n",
      "episode: 37000 | stock price [100.    99.56  97.11  98.28  98.18  96.15  96.91  95.97  96.24  97.37\n",
      "  95.59  96.37  98.03  97.03  98.52 100.18  99.64  99.36 100.02  99.34\n",
      "  98.96]\n",
      "episode: 37000 | option price [225.84 206.62 108.04 156.61 146.45  64.18  76.1   53.15  55.9   75.39\n",
      "  27.1   41.3   69.2   46.98  81.14 136.9   93.36  70.94  83.03  31.93\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 38000}\n",
      "episode: 38000 | final wealth: -85.17; so far mean and variance of final wealth was -137.7702793037886 and 20856.51129704734\n",
      "episode: 38000 | so far Y(0): 354.40\n",
      "episode: 38000 | rewards: [-14.66  10.83   9.91   6.01  -3.26  -8.94 -10.88   0.99  11.2  -10.34\n",
      " -25.62  -2.58  -9.59   7.9   27.13  -8.26 -36.01 -18.15  -6.2   -4.63]\n",
      "episode: 38000 | action taken: [32.57 35.46 36.64 33.78 30.63 32.97 54.34 57.25 58.87 56.79 50.18 46.88\n",
      " 44.92 40.03 36.4  34.42 26.79 16.07  4.54  1.09]\n",
      "episode: 38000 | deltas [51.13 48.74 45.73 37.49 37.   41.05 53.53 59.13 67.02 61.14 40.74 26.71\n",
      " 21.89 13.9  11.85 26.52 14.9   2.45  0.18  0.08  0.  ]\n",
      "episode: 38000 | stock price [100.    99.69  99.32  98.31  98.34  98.86 100.29 100.84 101.59 100.93\n",
      "  99.14  97.86  97.55  96.96  97.14  98.58  97.82  96.24  95.65  96.7\n",
      "  96.46]\n",
      "episode: 38000 | option price [225.84 197.79 171.14 122.99 115.07 131.19 184.89 204.4  243.57 191.89\n",
      "  98.09  53.06  37.78  19.02  13.58  35.28  15.64   1.71   0.07   0.02\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 39000}\n",
      "episode: 39000 | final wealth: -130.59; so far mean and variance of final wealth was -137.83578941922545 and 20806.865721117636\n",
      "episode: 39000 | so far Y(0): 354.20\n",
      "episode: 39000 | rewards: [-20.65   4.16  -2.52 -12.29 -39.28 -33.09 -11.17  -8.13  -0.28   7.97\n",
      " -20.67  -1.19  -9.72  16.57  28.77  13.56 -20.01  -1.11 -11.76  -9.76]\n",
      "episode: 39000 | action taken: [32.57 33.96 33.69 33.7  38.29 47.51 59.33 66.7  71.59 73.78 67.49 60.09\n",
      " 58.67 59.01 57.04 51.4  42.03 26.1  10.14  1.28]\n",
      "episode: 39000 | deltas [51.13 45.26 43.34 45.38 54.17 66.53 77.63 77.98 82.31 85.28 63.97 48.17\n",
      " 67.76 80.82 78.72 62.27 51.25 15.12 14.39  1.69  0.  ]\n",
      "episode: 39000 | stock price [100.    99.16  98.91  99.2  100.42 102.15 103.68 103.7  104.26 104.52\n",
      " 101.41  99.73 101.78 103.12 102.65 100.94 100.05  97.52  97.91  96.99\n",
      "  96.38]\n",
      "episode: 39000 | option price [225.84 186.71 172.4  184.49 237.97 338.94 435.08 435.34 473.44 487.13\n",
      " 247.39 148.3  264.95 352.05 307.42 179.08 113.93  18.23  14.09   0.84\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 40000}\n",
      "episode: 40000 | final wealth: -33.09; so far mean and variance of final wealth was -137.9190801680539 and 20789.85057899884\n",
      "episode: 40000 | so far Y(0): 354.20\n",
      "episode: 40000 | rewards: [-14.41  10.66 -14.33 -14.51  13.23   4.17 -28.04  -4.02  16.06 -22.1\n",
      "  13.35  -5.15  -1.97   8.24 -15.32   8.86   0.72   1.22  16.1   -5.87]\n",
      "episode: 40000 | action taken: [32.57 33.07 29.22 20.18 20.22 18.85 37.07 34.8  29.68 40.67 40.63 43.08\n",
      " 43.01 39.18 35.45 27.63 22.22 15.5   6.32  1.19]\n",
      "episode: 40000 | deltas [51.13 42.94 33.19 22.44 28.53 23.7  25.49 19.21 20.75 40.25 27.11 29.97\n",
      " 25.38 21.44 21.37 13.42 21.65 11.55 24.52  3.42  0.  ]\n",
      "episode: 40000 | stock price [100.    98.85  97.49  95.59  96.63  96.04  96.52  95.58  95.72  98.78\n",
      "  97.16  97.66  97.17  96.8   97.02  96.11  97.33  96.51  98.26  97.01\n",
      "  95.4 ]\n",
      "episode: 40000 | option price [225.84 170.16 114.    69.1   95.97  70.76  74.38  49.98  56.77 126.41\n",
      "  71.88  78.71  60.73  46.5   43.17  22.61  39.99  15.74  35.23   2.16\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 41000}\n",
      "episode: 41000 | final wealth: 71.96; so far mean and variance of final wealth was -137.87460490071493 and 20796.376098661578\n",
      "episode: 41000 | so far Y(0): 354.19\n",
      "episode: 41000 | rewards: [-76.39  -5.98  10.56   3.79   7.31  10.44  -6.19   7.49   1.15 -19.16\n",
      " -14.2    3.96 -17.2   46.22  -8.89 -54.89  17.84  27.25  30.74 108.13]\n",
      "episode: 41000 | action taken: [32.57 44.37 51.31 52.8  53.35 53.23 55.   59.08 59.52 59.85 61.54 61.86\n",
      " 62.79 63.78 59.98 55.54 51.01 44.34 33.56 15.81]\n",
      "episode: 41000 | deltas [ 51.13  65.42  66.75  58.78  51.93  50.85  58.29  64.24  59.    72.94\n",
      "  82.96  87.35  87.48  91.44  82.83  87.98  97.6   98.44  98.77  99.63\n",
      " 100.  ]\n",
      "episode: 41000 | stock price [100.   102.03 102.15 101.01 100.12  99.99 100.85 101.56 100.88 102.37\n",
      " 103.64 104.27 104.18 104.87 103.1  103.54 105.04 104.6  104.   103.37\n",
      " 101.68]\n",
      "episode: 41000 | option price [225.84 335.88 334.84 258.72 206.47 191.62 227.02 270.55 218.96 305.98\n",
      " 400.39 451.89 442.23 501.28 341.18 372.94 506.34 461.42 400.3  337.48\n",
      " 168.19]\n",
      "\n",
      "{'path_row': 42000}\n",
      "episode: 42000 | final wealth: -26.09; so far mean and variance of final wealth was -137.7782773933369 and 20798.271386565466\n",
      "episode: 42000 | so far Y(0): 354.10\n",
      "episode: 42000 | rewards: [-37.06  13.78  -7.66   4.96  -3.17  -3.23  -1.36  -8.49   6.98   5.28\n",
      "   6.05   7.75 -22.04  -3.42  -6.3    8.25   7.74  14.61  -4.74  -4.02]\n",
      "episode: 42000 | action taken: [32.57 37.56 36.26 37.45 37.41 39.81 43.7  49.5  53.27 55.08 55.36 52.62\n",
      " 53.21 47.38 40.   33.63 28.31 21.81  6.64  1.08]\n",
      "episode: 42000 | deltas [51.13 54.03 39.87 48.83 51.68 50.67 49.28 54.05 60.22 65.79 63.74 51.16\n",
      " 59.11 33.58 27.86 26.6  34.88 39.09 12.8   2.52  0.  ]\n",
      "episode: 42000 | stock price [100.   100.41  98.43  99.69 100.08  99.95  99.76 100.39 101.2  101.81\n",
      " 101.51 100.03 100.88  98.14  97.65  97.55  98.58  99.11  97.05  96.41\n",
      "  97.04]\n",
      "episode: 42000 | option price [225.84 243.66 150.5  202.65 211.24 209.3  202.55 227.83 270.32 291.89\n",
      " 268.42 180.2  214.22  90.02  64.62  59.64  79.83  81.91  15.95   1.7\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 43000}\n",
      "episode: 43000 | final wealth: -385.19; so far mean and variance of final wealth was -137.80249695055977 and 20766.606739172574\n",
      "episode: 43000 | so far Y(0): 353.96\n",
      "episode: 43000 | rewards: [ -89.11   11.01  -27.84    6.33    8.08   -6.61   -9.46   -9.57    4.01\n",
      "   15.15   -7.36   -9.42    2.49   -9.22   20.43  -28.28 -292.85   77.37\n",
      " -104.99   64.65]\n",
      "episode: 43000 | action taken: [32.57 46.73 53.23 58.02 62.8  62.7  62.86 61.34 58.01 51.99 52.16 56.77\n",
      " 52.38 47.29 41.3  38.82 37.9  45.41 37.67 23.61]\n",
      "episode: 43000 | deltas [ 51.13  68.69  60.99  72.97  73.65  64.12  54.04  49.15  40.56  38.57\n",
      "  55.8   67.39  41.53  35.15  29.49  40.22  69.85  99.7   99.23 100.\n",
      " 100.  ]\n",
      "episode: 43000 | stock price [100.   102.5  101.33 103.07 103.   101.61 100.37  99.78  98.79  98.64\n",
      " 100.51 101.73  99.08  98.58  98.07  99.22 101.4  106.97 105.4  106.96\n",
      " 105.59]\n",
      "episode: 43000 | option price [225.84 363.7  283.86 397.57 382.24 282.16 210.77 182.71 130.05 114.11\n",
      " 190.53 260.99 115.37  82.21  62.61  83.63 194.09 697.01 540.29 696.\n",
      " 559.04]\n",
      "\n",
      "{'path_row': 44000}\n",
      "episode: 44000 | final wealth: -255.21; so far mean and variance of final wealth was -137.74276731269114 and 20752.616641343513\n",
      "episode: 44000 | so far Y(0): 353.83\n",
      "episode: 44000 | rewards: [ -34.84  -21.44   -6.36  -11.77  -15.89   39.26  -15.17   10.7    17.4\n",
      "   10.89   10.3     8.1     5.37    7.59  -15.79    7.49   -6.39  -13.5\n",
      " -191.67  -39.49]\n",
      "episode: 44000 | action taken: [32.57 35.86 42.97 43.   44.35 51.   54.6  52.54 51.38 50.2  50.92 54.56\n",
      " 53.06 49.   45.98 35.89 30.77 24.51 10.37  3.65]\n",
      "episode: 44000 | deltas [ 51.13  49.98  59.22  53.24  63.13  70.86  62.24  36.67  47.5   50.52\n",
      "  52.7   59.79  61.68  38.28  45.6   18.74  36.49  49.44  65.8   99.67\n",
      " 100.  ]\n",
      "episode: 44000 | stock price [100.    99.83 101.16 100.31 101.75 102.84 101.37  98.33  99.6   99.97\n",
      " 100.19 100.82 100.91  99.09  99.66  97.88  99.22  99.95 100.65 103.05\n",
      " 103.35]\n",
      "episode: 44000 | option price [225.84 222.55 288.42 250.91 324.52 387.5  266.77 111.84 166.07 166.31\n",
      " 165.4  186.45 179.64  76.21  92.61  23.66  54.09  78.03 102.37 304.66\n",
      " 334.55]\n",
      "\n",
      "{'path_row': 45000}\n",
      "episode: 45000 | final wealth: -487.34; so far mean and variance of final wealth was -137.64819881068922 and 20732.012757350058\n",
      "episode: 45000 | so far Y(0): 353.63\n",
      "episode: 45000 | rewards: [ -39.39    9.76  -21.04 -112.99   50.75   -8.2    -3.43    6.25    6.77\n",
      "    2.62    1.91  -35.62  -28.54  -71.52   33.53  -73.17  -29.26  -31.5\n",
      "   10.32 -154.59]\n",
      "episode: 45000 | action taken: [32.57 39.18 41.96 44.5  53.64 60.19 67.85 71.99 71.95 67.05 63.12 58.37\n",
      " 59.17 60.67 61.59 58.49 54.83 49.27 43.99 34.37]\n",
      "episode: 45000 | deltas [ 51.13  58.31  47.97  61.32  84.6   73.81  79.14  78.3   76.89  62.61\n",
      "  60.38  67.15  85.59  92.08  98.13  98.03  99.81  99.99 100.   100.\n",
      " 100.  ]\n",
      "episode: 45000 | stock price [100.   100.97  99.58 101.38 105.25 103.11 103.77 103.57 103.16 101.23\n",
      " 100.94 101.57 103.64 104.66 106.7  105.8  107.53 108.1  108.6  108.31\n",
      " 109.94]\n",
      "episode: 45000 | option price [225.84 264.4  193.45 287.23 569.88 394.34 435.76 417.66 377.31 232.07\n",
      " 204.81 238.87 390.23 478.61 672.05 582.48 753.64 809.9  860.14 831.47\n",
      " 993.57]\n",
      "\n",
      "{'path_row': 46000}\n",
      "episode: 46000 | final wealth: -259.16; so far mean and variance of final wealth was -137.63015162874154 and 20772.458201169065\n",
      "episode: 46000 | so far Y(0): 353.82\n",
      "episode: 46000 | rewards: [-45.2  -44.45 -43.65  13.98  16.46  10.16   6.37  -2.43 -37.64 -16.42\n",
      "  16.16 -20.08   0.11 -23.83  -4.63 -56.5    5.49 -23.5   -6.24  -3.32]\n",
      "episode: 46000 | action taken: [32.57 39.75 51.43 56.76 63.63 64.59 65.92 64.43 61.3  54.24 45.26 49.26\n",
      " 47.09 43.82 36.77 29.58 17.97 11.25  2.92  0.71]\n",
      "episode: 46000 | deltas [51.13 59.56 70.97 82.14 79.2  70.21 62.61 57.44 47.16 30.48 22.93 40.7\n",
      " 30.23 27.89 14.27 10.09  1.07  1.95  0.03  0.    0.  ]\n",
      "episode: 46000 | stock price [100.   101.15 102.78 104.45 103.8  102.32 101.29 100.67  99.67  98.08\n",
      "  97.45  99.15  98.17  98.03  96.79  96.61  94.55  95.5   93.85  94.39\n",
      "  93.58]\n",
      "episode: 46000 | option price [225.84 275.99 377.78 495.68 439.09 321.14 243.49 194.92 131.33  68.55\n",
      "  43.57  95.93  63.86  54.86  21.01  12.23   0.83   1.5    0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 47000}\n",
      "episode: 47000 | final wealth: -89.55; so far mean and variance of final wealth was -137.7039296418849 and 20770.111980287962\n",
      "episode: 47000 | so far Y(0): 353.88\n",
      "episode: 47000 | rewards: [ -5.77   0.85  10.19 -10.65   4.12   3.78 -14.33  12.14 -14.27  11.1\n",
      "  -2.94   4.71   0.39   3.18 -41.77 -15.75 -22.44  -6.33  -2.26  -3.5 ]\n",
      "episode: 47000 | action taken: [32.57 32.25 33.35 31.44 31.96 33.66 45.03 43.32 42.95 40.45 50.58 49.41\n",
      " 48.7  46.14 41.16 30.39 20.34 10.71  3.33  1.  ]\n",
      "episode: 47000 | deltas [51.13 40.56 45.86 39.93 43.37 43.54 43.38 32.34 31.45 26.39 51.53 38.73\n",
      " 38.1  37.05 28.98 10.63  5.34  1.38  0.4   0.22  0.  ]\n",
      "episode: 47000 | stock price [100.    98.55  99.32  98.57  98.99  99.05  99.06  97.72  97.8   97.08\n",
      " 100.07  98.79  98.78  98.7   98.09  96.13  95.64  94.78  94.96  96.34\n",
      "  95.96]\n",
      "episode: 47000 | option price [225.84 151.96 175.58 139.29 161.31 158.31 153.18  96.12  85.58  68.82\n",
      " 176.27 104.27  97.87  92.66  59.1   15.13   5.84   1.11   0.23   0.08\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 48000}\n",
      "episode: 48000 | final wealth: -216.04; so far mean and variance of final wealth was -137.86589530095384 and 20760.56917151622\n",
      "episode: 48000 | so far Y(0): 353.99\n",
      "episode: 48000 | rewards: [-38.74 -17.69   3.38 -22.13  -1.93 -27.86  -2.36   0.8  -10.94 -57.91\n",
      " -12.18  -3.05  -7.85 -32.68  32.77  -1.54  15.94   0.4  -74.89  42.43]\n",
      "episode: 48000 | action taken: [32.57 37.42 43.81 43.26 45.17 48.93 58.1  64.82 68.24 72.04 77.05 80.07\n",
      " 80.92 81.63 82.75 80.74 77.89 73.54 67.55 49.58]\n",
      "episode: 48000 | deltas [ 51.13  53.66  57.79  53.37  65.4   64.53  70.75  73.31  72.84  87.47\n",
      "  96.79  97.91  98.36  99.22  99.92  99.67  99.82  99.89  99.99 100.\n",
      " 100.  ]\n",
      "episode: 48000 | stock price [100.   100.36 100.96 100.32 102.04 101.92 102.97 103.23 103.05 105.2\n",
      " 107.99 108.39 108.42 108.86 110.65 108.67 108.64 107.79 107.6  109.71\n",
      " 107.42]\n",
      "episode: 48000 | option price [ 225.84  243.73  279.01  241.08  337.04  331.91  407.01  415.14  395.57\n",
      "  549.59  804.83  842.35  844.93  887.47 1065.27  866.98  864.42  778.62\n",
      "  759.59  970.52  741.63]\n",
      "\n",
      "{'path_row': 49000}\n",
      "episode: 49000 | final wealth: -44.75; so far mean and variance of final wealth was -137.8649113581378 and 20780.98239119975\n",
      "episode: 49000 | so far Y(0): 354.10\n",
      "episode: 49000 | rewards: [-26.83   8.12   3.23   5.73  -4.02 -30.23 -20.62 -20.11  -9.16   5.31\n",
      " -22.81 -39.54   8.35  16.45   8.14 -28.56  47.64  12.74   4.27  37.15]\n",
      "episode: 49000 | action taken: [32.57 36.97 39.58 41.34 39.99 43.58 56.26 63.07 68.61 71.31 72.31 70.99\n",
      " 70.93 70.39 69.25 67.77 65.27 58.54 47.6  30.83]\n",
      "episode: 49000 | deltas [ 51.13  52.62  49.42  49.91  55.43  58.88  72.44  78.27  86.18  87.71\n",
      "  87.84  93.59  97.9   98.32  97.87  98.38  99.58  99.25  99.53  99.97\n",
      " 100.  ]\n",
      "episode: 49000 | stock price [100.   100.21  99.79  99.86 100.53 100.93 102.54 103.23 104.28 104.52\n",
      " 104.3  105.54 107.12 106.86 106.27 105.99 106.87 105.42 104.95 104.65\n",
      " 103.4 ]\n",
      "episode: 49000 | option price [225.84 226.92 198.72 195.83 216.19 234.78 331.33 378.17 457.25 477.21\n",
      " 453.13 564.58 715.32 688.36 629.65 601.17 687.75 542.48 495.04 465.24\n",
      " 340.07]\n",
      "\n",
      "{'path_row': 50000}\n",
      "episode: 50000 | final wealth: -214.18; so far mean and variance of final wealth was -137.89963306331782 and 20782.196154587935\n",
      "episode: 50000 | so far Y(0): 354.14\n",
      "episode: 50000 | rewards: [ -11.06   -5.27  -20.28    6.43   -6.77   19.14    6.64   -8.52  -17.31\n",
      "   14.41    8.2    -5.87  -25.38   14.76    8.62   19.32   15.27  -46.29\n",
      " -130.96  -49.26]\n",
      "episode: 50000 | action taken: [32.57 31.84 29.49 34.04 39.2  44.03 46.92 50.3  48.21 43.44 46.08 50.08\n",
      " 48.72 41.92 40.95 40.66 34.67 24.77 10.99  3.53]\n",
      "episode: 50000 | deltas [ 51.13  39.86  38.07  49.66  55.95  60.2   49.95  51.9   38.68  28.04\n",
      "  37.34  44.22  38.17  23.86  32.09  49.55  49.78  38.22  73.68  98.4\n",
      " 100.  ]\n",
      "episode: 50000 | stock price [100.    98.41  98.08  99.79 100.62 101.13  99.89 100.11  98.71  97.53\n",
      "  98.65  99.38  98.82  97.37  98.36  99.91  99.95  99.28 101.13 102.77\n",
      " 103.17]\n",
      "episode: 50000 | option price [225.84 152.39 146.65 215.07 232.43 253.79 175.28 176.09 110.43  68.94\n",
      "  98.7  121.48  95.47  48.95  68.99 122.89 104.73  60.4  142.65 277.65\n",
      " 317.03]\n",
      "\n",
      "{'path_row': 51000}\n",
      "episode: 51000 | final wealth: -128.07; so far mean and variance of final wealth was -137.85405810518188 and 20788.32204221779\n",
      "episode: 51000 | so far Y(0): 354.13\n",
      "episode: 51000 | rewards: [ -42.15    8.17   -0.34  -22.69  -47.5  -108.25   17.39   -1.06    7.63\n",
      "   13.49   -4.73   -6.59   -6.87   14.08    5.27   17.7    10.27  -77.52\n",
      "  139.82  -44.19]\n",
      "episode: 51000 | action taken: [32.57 38.37 41.41 42.53 43.69 52.67 68.49 75.41 73.01 73.48 68.24 62.71\n",
      " 58.07 57.39 53.55 48.22 39.33 28.56 16.4   2.41]\n",
      "episode: 51000 | deltas [ 51.13  56.06  49.36  53.15  62.21  75.73  90.64  83.86  74.1   79.9\n",
      "  66.13  60.06  50.02  67.36  55.15  61.24  54.35  52.68  85.79  43.27\n",
      " 100.  ]\n",
      "episode: 51000 | stock price [100.   100.69  99.76 100.28 101.54 103.58 106.84 105.04 103.24 103.92\n",
      " 101.71 100.99  99.92 101.75 100.42 100.94 100.29 100.14 102.24  99.74\n",
      " 100.77]\n",
      "episode: 51000 | option price [225.84 258.02 208.17 227.01 302.24 437.45 708.18 550.77 408.45 448.24\n",
      " 272.17 221.96 156.21 264.57 173.52 192.38 137.8  112.84 239.43  46.24\n",
      "  76.52]\n",
      "\n",
      "{'path_row': 52000}\n",
      "episode: 52000 | final wealth: -4.07; so far mean and variance of final wealth was -137.92862422116596 and 20751.496011576684\n",
      "episode: 52000 | so far Y(0): 354.01\n",
      "episode: 52000 | rewards: [-64.41  20.14 -28.06 -22.67  14.29  -2.79  -3.99   7.16  -4.07  12.31\n",
      " -24.93  23.82  22.42   6.84  16.16   5.23  18.7    7.56   5.31 -13.1 ]\n",
      "episode: 52000 | action taken: [32.57 41.23 47.94 48.34 50.25 54.11 60.3  65.57 67.38 64.29 61.59 61.39\n",
      " 61.25 60.3  56.7  49.56 41.42 28.63 14.04  1.59]\n",
      "episode: 52000 | deltas [51.13 61.68 56.16 60.53 70.32 66.21 70.68 68.45 67.24 56.47 65.06 83.52\n",
      " 78.46 69.95 67.29 51.39 59.97 42.27 37.95  2.31  0.  ]\n",
      "episode: 52000 | stock price [100.   101.51 100.67 101.34 102.81 102.13 102.69 102.36 102.06 100.65\n",
      " 101.61 103.98 103.04 101.87 101.53 100.06 100.66  99.51  99.41  97.46\n",
      "  97.14]\n",
      "episode: 52000 | option price [225.84 306.79 243.46 296.72 390.2  339.4  368.83 346.78 314.   221.79\n",
      " 267.68 436.06 354.17 260.15 231.93 128.52 145.77  71.51  48.35   1.08\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 53000}\n",
      "episode: 53000 | final wealth: -58.22; so far mean and variance of final wealth was -138.07496321213995 and 20735.33853802338\n",
      "episode: 53000 | so far Y(0): 354.07\n",
      "episode: 53000 | rewards: [-79.99  19.84 -22.7   22.11   4.79  -4.46 -14.98 -17.55  -4.47  15.71\n",
      "   7.11   0.13   6.     5.62   2.14   2.8   -1.27  -0.28  -1.51   2.75]\n",
      "episode: 53000 | action taken: [32.57 45.4  51.9  55.8  59.69 58.58 63.85 70.68 74.55 74.76 71.9  66.46\n",
      " 62.15 59.59 54.6  47.02 37.01 24.89  9.66  1.77]\n",
      "episode: 53000 | deltas [51.13 66.77 63.79 76.44 69.67 55.75 73.45 84.81 90.63 88.73 82.38 73.7\n",
      " 66.22 59.25 48.55 45.61 43.78 27.5  27.21 17.13  0.  ]\n",
      "episode: 53000 | stock price [100.   102.21 101.6  103.17 102.12 100.52 102.41 103.68 104.52 104.34\n",
      " 103.18 102.07 101.31 100.66  99.87  99.7   99.63  98.84  99.05  98.9\n",
      "  99.94]\n",
      "episode: 53000 | option price [225.84 345.31 284.57 382.19 297.19 192.87 307.21 398.13 467.66 455.07\n",
      " 351.92 262.54 206.22 155.02  99.85  83.53  70.1   31.9   25.51  10.46\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 54000}\n",
      "episode: 54000 | final wealth: 14.95; so far mean and variance of final wealth was -138.27829445704572 and 20764.149879454988\n",
      "episode: 54000 | so far Y(0): 354.42\n",
      "episode: 54000 | rewards: [-29.41   7.81  -6.49   5.67  21.33  -5.39  -6.77   1.82   8.66  16.91\n",
      "  -0.36 -32.73  20.48  12.97   9.65  11.33  -1.71   7.53 -18.25  -8.1 ]\n",
      "episode: 54000 | action taken: [32.57 37.3  41.3  43.86 42.73 41.43 43.37 51.03 54.13 55.1  53.25 50.83\n",
      " 44.33 44.09 41.43 37.57 32.27 24.37  9.    1.22]\n",
      "episode: 54000 | deltas [51.13 53.44 52.79 59.85 58.92 46.53 45.12 59.53 62.76 67.72 58.89 41.12\n",
      " 17.83 26.6  23.26 28.43 40.22 40.56 19.47  0.06  0.  ]\n",
      "episode: 54000 | stock price [100.   100.32 100.23 101.1  100.96  99.5   99.32 100.97 101.25 101.63\n",
      " 100.71  99.22  97.31  98.28  98.3   98.76  99.54  99.58  98.8   96.82\n",
      "  97.32]\n",
      "episode: 54000 | option price [225.84 233.17 217.13 255.75 241.11 156.52 153.11 229.38 234.31 242.82\n",
      " 174.14  93.62  26.94  42.74  30.51  37.24  51.35  49.13  14.76   0.01\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 55000}\n",
      "episode: 55000 | final wealth: 56.91; so far mean and variance of final wealth was -138.32628411680648 and 20780.21751924851\n",
      "episode: 55000 | so far Y(0): 354.56\n",
      "episode: 55000 | rewards: [-11.89  -9.39   6.5  -10.89 -18.88 -21.15 -67.34  24.27 -27.53 -19.55\n",
      "   4.3  -15.79  -6.29 -62.3   15.37  33.2   35.51  24.26 189.53  -5.05]\n",
      "episode: 55000 | action taken: [32.57 32.79 33.76 28.56 25.21 30.48 48.91 37.47 41.07 54.94 58.02 57.84\n",
      " 59.78 61.2  61.99 59.46 53.84 45.8  34.63 17.23]\n",
      "episode: 55000 | deltas [51.13 42.16 46.07 34.01 34.76 40.41 45.48 22.77 38.5  63.42 69.33 69.06\n",
      " 79.46 86.01 95.07 94.97 93.39 92.46 95.37 52.05  0.  ]\n",
      "episode: 55000 | stock price [100.    98.75  99.28  97.49  97.54  98.36  99.1   95.41  98.22 101.71\n",
      " 102.54 102.42 103.9  104.66 106.84 106.42 105.48 104.58 104.09 100.07\n",
      "  97.49]\n",
      "episode: 55000 | option price [225.84 164.35 191.12 123.15 130.32 166.58 205.19  73.93 143.87 311.04\n",
      " 362.33 347.93 449.39 498.95 692.99 650.84 558.79 468.82 413.99  73.74\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 56000}\n",
      "episode: 56000 | final wealth: -218.11; so far mean and variance of final wealth was -138.36206612394 and 20772.437381733536\n",
      "episode: 56000 | so far Y(0): 354.55\n",
      "episode: 56000 | rewards: [ -31.48  -46.97 -125.24   12.84   25.09   16.17    0.67   -3.03    5.5\n",
      "  -37.7     0.66    8.97   -5.01    1.12  -10.34  -16.23    7.67   49.46\n",
      "   -4.86  -65.38]\n",
      "episode: 56000 | action taken: [32.57 36.76 47.57 53.5  63.83 69.02 70.4  71.02 74.15 73.55 76.33 76.53\n",
      " 75.33 73.98 72.09 70.79 68.39 63.22 53.21 35.65]\n",
      "episode: 56000 | deltas [ 51.13  52.09  67.16  88.4   88.68  81.93  73.03  75.12  85.78  84.\n",
      "  95.65  96.12  95.13  96.88  97.84  98.96  99.85  99.9   99.89 100.\n",
      " 100.  ]\n",
      "episode: 56000 | stock price [100.   100.14 102.28 106.2  105.85 104.28 102.68 102.92 104.29 103.82\n",
      " 106.26 106.15 105.69 105.98 105.94 106.29 106.83 106.51 105.01 104.89\n",
      " 105.04]\n",
      "episode: 56000 | option price [225.84 229.22 350.8  651.23 613.66 477.37 345.14 359.8  459.75 416.26\n",
      " 632.48 620.92 576.63 601.63 596.41 630.06 683.06 650.77 501.34 489.32\n",
      " 504.12]\n",
      "\n",
      "{'path_row': 57000}\n",
      "episode: 57000 | final wealth: -235.60; so far mean and variance of final wealth was -138.40187406919506 and 20760.7754613601\n",
      "episode: 57000 | so far Y(0): 354.53\n",
      "episode: 57000 | rewards: [-27.8   -3.81 -18.57 -71.74  29.88   7.55   0.71   3.35   6.35 -23.17\n",
      "   4.87 -30.75 -26.42  36.87 -69.75   9.09  -5.87 -26.53 -36.93   7.08]\n",
      "episode: 57000 | action taken: [32.57 36.84 43.26 45.39 51.87 59.04 64.95 68.59 68.69 67.36 68.53 66.69\n",
      " 67.5  67.04 64.66 63.67 60.8  55.17 46.51 33.95]\n",
      "episode: 57000 | deltas [ 51.13  52.28  58.48  66.56  82.26  78.06  73.94  71.88  70.4   68.63\n",
      "  85.56  88.61  95.31  98.22  96.81  99.81  99.95 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 57000 | stock price [100.   100.16 100.96 101.99 104.43 103.45 102.76 102.42 102.14 101.85\n",
      " 104.12 104.24 105.52 106.45 105.26 107.27 106.99 107.06 107.52 108.04\n",
      " 107.17]\n",
      "episode: 57000 | option price [225.84 226.37 255.41 311.82 492.22 404.53 349.3  320.02 293.65 267.27\n",
      " 441.94 444.24 558.37 646.65 530.   726.82 699.06 706.25 751.98 803.63\n",
      " 717.26]\n",
      "\n",
      "{'path_row': 58000}\n",
      "episode: 58000 | final wealth: -53.98; so far mean and variance of final wealth was -138.3931493129547 and 20772.455354828897\n",
      "episode: 58000 | so far Y(0): 354.58\n",
      "episode: 58000 | rewards: [-23.49  13.17  -1.74  -4.71   7.41 -28.33 -20.96  -7.17   9.93   8.01\n",
      "   4.9    0.66 -42.07  13.15  16.75   4.68   2.25   3.65  -2.76  -7.3 ]\n",
      "episode: 58000 | action taken: [32.57 33.59 29.97 21.81 24.25 22.31 54.95 54.78 52.38 51.2  50.78 50.99\n",
      " 47.83 38.63 35.83 36.17 26.68 18.65  6.56  1.26]\n",
      "episode: 58000 | deltas [51.13 44.51 34.49 25.91 32.41 25.9  43.16 44.21 45.13 52.69 51.36 45.14\n",
      " 36.28 16.92 23.35 42.96 19.84 19.74 12.52  2.35  0.  ]\n",
      "episode: 58000 | stock price [100.    99.04  97.61  96.29  97.5   96.65  99.01  99.19  99.27 100.21\n",
      " 100.05  99.38  98.49  96.32  97.28  99.35  97.51  97.8   97.62  97.28\n",
      "  95.59]\n",
      "episode: 58000 | option price [225.84 185.34 123.44  82.05 105.24  74.77 154.01 152.5  163.7  200.59\n",
      " 183.39 143.73  97.72  32.83  48.1  102.83  31.1   27.32  12.49   1.18\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 59000}\n",
      "episode: 59000 | final wealth: -126.89; so far mean and variance of final wealth was -138.34916051870943 and 20734.012483679635\n",
      "episode: 59000 | so far Y(0): 354.34\n",
      "episode: 59000 | rewards: [-13.71   1.86   2.75  10.7    2.11   0.03  -3.83 -23.37 -12.45  -0.12\n",
      "  -9.31 -32.47 -17.67   8.76 -24.83   1.96 -14.86  -2.95   1.31  -0.81]\n",
      "episode: 59000 | action taken: [32.57 32.43 28.   24.71 26.44 27.81 42.89 41.97 38.52 34.78 30.48 25.97\n",
      " 17.51 11.32 12.45  6.46  6.3   2.9   1.33  0.52]\n",
      "episode: 59000 | deltas [51.13 41.39 32.57 34.37 34.1  33.39 34.09 28.7  19.61 17.19 13.05 11.31\n",
      "  5.55  2.43  4.16  0.49  0.7   0.    0.    0.    0.  ]\n",
      "episode: 59000 | stock price [100.    98.62  97.26  97.66  97.81  97.76  97.88  97.42  96.16  95.74\n",
      "  95.45  95.14  93.6   92.71  94.19  91.88  93.06  90.63  90.68  92.74\n",
      "  93.55]\n",
      "episode: 59000 | option price [225.84 161.95 116.02 120.03 109.89 104.74 106.71  76.24  45.7   38.78\n",
      "  24.99  20.81   8.9    3.18   5.38   0.45   0.61   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 60000}\n",
      "episode: 60000 | final wealth: -135.75; so far mean and variance of final wealth was -138.33041778262535 and 20741.75883628832\n",
      "episode: 60000 | so far Y(0): 354.36\n",
      "episode: 60000 | rewards: [-40.8   24.05  -4.27  -3.79  -9.19   3.01   0.95   2.72 -40.66 -51.31\n",
      " -15.03   5.57   3.72  -3.59   9.56   0.33 -10.63  -4.1   -0.08  -2.22]\n",
      "episode: 60000 | action taken: [32.57 39.08 42.42 40.18 33.91 31.01 32.63 42.32 44.11 37.97 28.94 19.51\n",
      " 17.12 16.41 13.23 13.87 11.58  7.19  2.7   0.9 ]\n",
      "episode: 60000 | deltas [51.13 57.98 49.23 40.48 35.09 37.22 31.16 39.56 36.01 16.84  7.46  4.83\n",
      "  4.89  3.63  2.02  3.93  2.32  0.32  0.05  0.02  0.  ]\n",
      "episode: 60000 | stock price [100.   100.94  99.78  98.65  97.94  98.2   97.41  98.59  98.28  95.81\n",
      "  93.99  93.56  94.27  94.47  94.16  95.27  95.19  94.3   94.28  95.81\n",
      "  96.22]\n",
      "episode: 60000 | option price [225.84 264.64 188.66 141.76 114.79 126.65  96.41 132.22 106.93  36.76\n",
      "  13.08   7.32   6.68   4.23   2.02   4.08   2.02   0.2    0.02   0.01\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 61000}\n",
      "episode: 61000 | final wealth: -254.01; so far mean and variance of final wealth was -138.4800753748248 and 20738.769115225918\n",
      "episode: 61000 | so far Y(0): 354.49\n",
      "episode: 61000 | rewards: [-124.66   -3.67   -2.08   -6.35  -31.16   17.36    9.54   -4.47   -1.2\n",
      "    6.35   19.66   10.93    0.11    8.04  -13.14  -11.21  -22.03    6.\n",
      " -128.43   16.41]\n",
      "episode: 61000 | action taken: [32.57 49.99 58.31 59.09 62.82 69.99 69.88 66.81 66.23 67.39 67.84 63.41\n",
      " 60.27 59.28 56.34 52.88 48.15 40.86 30.77 13.4 ]\n",
      "episode: 61000 | deltas [ 51.13  72.15  71.07  57.86  69.53  83.39  68.77  61.33  61.94  76.64\n",
      "  80.31  70.83  64.06  69.17  71.27  85.13  87.82  95.43  97.22 100.\n",
      " 100.  ]\n",
      "episode: 61000 | stock price [100.   103.19 102.89 100.95 102.68 105.1  102.37 101.24 101.33 103.25\n",
      " 103.55 102.1  101.24 101.67 101.74 102.82 103.09 103.66 103.46 105.2\n",
      " 104.63]\n",
      "episode: 61000 | option price [225.84 421.84 392.57 272.9  380.83 559.91 344.34 255.45 262.66 390.74\n",
      " 402.94 284.43 214.66 237.58 232.31 303.31 325.22 369.73 348.37 519.68\n",
      " 463.44]\n",
      "\n",
      "{'path_row': 62000}\n",
      "episode: 62000 | final wealth: 8.59; so far mean and variance of final wealth was -138.46602242588997 and 20733.023008954668\n",
      "episode: 62000 | so far Y(0): 354.45\n",
      "episode: 62000 | rewards: [-10.91  10.01  10.25 -12.46   9.58  -4.95 -14.87  19.34 -10.79   0.14\n",
      " -10.35 -16.04 -35.9  -11.92  57.7  -10.08 -85.54  92.97  37.21  -4.79]\n",
      "episode: 62000 | action taken: [32.57 32.92 32.73 34.73 36.81 34.91 51.79 52.04 51.81 53.96 57.17 59.41\n",
      " 59.82 61.5  60.79 56.19 50.53 44.91 33.42 15.46]\n",
      "episode: 62000 | deltas [ 51.13  42.44  42.7   48.59  51.72  39.18  52.31  43.3   50.43  66.3\n",
      "  74.12  82.6   89.9   97.15  98.72  96.31  97.73  99.97  99.82  99.97\n",
      " 100.  ]\n",
      "episode: 62000 | stock price [100.    98.8   98.9   99.72 100.09  98.55 100.16  99.17  99.96 101.61\n",
      " 102.29 103.07 103.83 105.01 105.32 103.78 103.93 105.58 103.78 103.04\n",
      " 102.69]\n",
      "episode: 62000 | option price [225.84 164.97 158.09 174.49 197.79 129.42 188.69 135.36 157.07 252.66\n",
      " 287.11 338.84 397.65 503.81 533.22 380.91 394.94 557.68 378.12 304.35\n",
      " 269.35]\n",
      "\n",
      "{'path_row': 63000}\n",
      "episode: 63000 | final wealth: -1.67; so far mean and variance of final wealth was -138.45784064118064 and 20745.086148291888\n",
      "episode: 63000 | so far Y(0): 354.51\n",
      "episode: 63000 | rewards: [-81.6    8.42   5.19  -2.75   4.24   2.4   -1.06  -6.36  14.96   4.59\n",
      "  -7.43  22.35   8.31  12.55   4.63   4.67  -5.72  38.33   0.66 -28.05]\n",
      "episode: 63000 | action taken: [32.57 44.52 51.31 52.83 53.45 56.04 58.37 62.93 66.86 66.92 65.79 62.58\n",
      " 60.26 58.99 55.04 48.17 39.46 30.48 17.19  2.51]\n",
      "episode: 63000 | deltas [ 51.13  65.31  65.44  59.99  52.22  60.81  59.89  66.12  77.15  74.72\n",
      "  75.17  78.03  67.49  65.95  57.27  52.41  56.93  67.98  44.55  48.13\n",
      " 100.  ]\n",
      "episode: 63000 | stock price [100.   102.06 101.91 101.15 100.15 101.24 101.09 101.85 103.21 102.59\n",
      " 102.56 102.97 101.56 101.32 100.51 100.13 100.4  100.94  99.76  99.94\n",
      " 100.56]\n",
      "episode: 63000 | option price [225.84 341.84 314.82 263.52 212.18 265.12 252.15 295.09 382.43 321.93\n",
      " 315.22 348.57 234.8  209.23 147.69 118.27 119.77 138.21  54.69  43.84\n",
      "  56.27]\n",
      "\n",
      "{'path_row': 64000}\n",
      "episode: 64000 | final wealth: -180.40; so far mean and variance of final wealth was -138.3697404043856 and 20725.4151277331\n",
      "episode: 64000 | so far Y(0): 354.31\n",
      "episode: 64000 | rewards: [ -55.55  -14.8   -16.31  -49.69    4.08    5.73    6.8   -10.68   -5.85\n",
      "    9.17   10.64   -2.48   13.85   -6.69   -3.26  -64.11   -6.     16.05\n",
      "  127.38 -138.67]\n",
      "episode: 64000 | action taken: [32.57 40.54 47.55 47.76 50.98 56.9  62.24 65.06 61.33 55.89 50.81 52.32\n",
      " 48.52 50.78 51.52 49.16 49.31 43.72 34.42 17.24]\n",
      "episode: 64000 | deltas [ 51.13  60.73  57.1   58.79  71.36  69.79  65.72  60.44  48.24  43.84\n",
      "  48.79  49.92  41.12  54.21  68.27  76.16  90.14  94.27  97.08  90.62\n",
      " 100.  ]\n",
      "episode: 64000 | stock price [100.   101.34 100.88 101.16 103.4  103.08 102.32 101.39  99.6   99.02\n",
      "  99.71  99.88  98.86 100.36 101.82 102.53 104.45 104.75 104.45 102.28\n",
      " 103.62]\n",
      "episode: 64000 | option price [225.84 292.62 280.38 303.01 459.29 436.   380.88 310.29 202.02 168.75\n",
      " 192.48 185.24 132.81 188.19 266.84 306.01 462.05 482.5  447.42 235.74\n",
      " 362.1 ]\n",
      "\n",
      "{'path_row': 65000}\n",
      "episode: 65000 | final wealth: -91.38; so far mean and variance of final wealth was -138.395573667477 and 20742.272010133813\n",
      "episode: 65000 | so far Y(0): 354.43\n",
      "episode: 65000 | rewards: [ -2.37  -3.67   6.67  -6.53   9.41   5.56   1.69 -52.62  -8.68   6.02\n",
      " -36.13 -10.34  16.06   2.32  -1.68   8.7   -6.01  -8.87  -8.73  -2.18]\n",
      "episode: 65000 | action taken: [32.57 33.02 34.2  32.   31.58 25.84 36.15 41.83 36.23 30.59 26.23 16.07\n",
      " 13.27 16.48 15.36 12.93 12.18  8.12  2.68  0.54]\n",
      "episode: 65000 | deltas [51.13 42.28 46.1  39.81 42.62 30.56 26.42 36.12 16.17 14.94 15.81  5.03\n",
      "  3.04  5.39  4.94  3.89  3.79  1.14  0.12  0.    0.  ]\n",
      "episode: 65000 | stock price [100.    98.83  99.35  98.52  98.89  97.25  96.83  98.21  95.3   95.1\n",
      "  95.5   93.26  92.97  94.61  94.86  94.72  95.51  94.84  94.12  92.76\n",
      "  93.32]\n",
      "episode: 65000 | option price [225.84 157.55 177.91 141.73 157.87  96.34  74.42 112.38  37.88  34.03\n",
      "  34.86   8.1    4.17   7.27   6.11   4.48   3.7    0.85   0.06   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 66000}\n",
      "episode: 66000 | final wealth: -156.05; so far mean and variance of final wealth was -138.3854627068202 and 20752.2593396165\n",
      "episode: 66000 | so far Y(0): 354.47\n",
      "episode: 66000 | rewards: [-22.54  20.27  10.92  -3.51 -11.36   2.02 -67.22  -3.     4.59  15.71\n",
      " -35.22   2.82 -60.76  -6.58  -2.53  -3.6    6.27   0.15   0.66  -3.14]\n",
      "episode: 66000 | action taken: [32.57 33.99 29.73 23.43 19.15 16.06 36.87 27.2  20.1  21.6  30.6  25.75\n",
      " 21.83 10.8   7.61  6.15  4.57  5.29  2.35  0.8 ]\n",
      "episode: 66000 | deltas [51.13 45.4  32.16 27.71 21.82 18.34 22.02  8.86  8.91 12.24 21.8  10.51\n",
      "  8.69  0.71  0.57  0.23  0.03  0.1   0.01  0.    0.  ]\n",
      "episode: 66000 | stock price [100.    99.18  97.39  97.    96.15  95.29  96.2   93.82  94.03  94.97\n",
      "  96.83  95.02  95.11  91.9   92.21  92.22  91.83  93.53  93.67  95.13\n",
      "  93.98]\n",
      "episode: 66000 | option price [225.84 188.99 106.74  79.97  57.4   48.28  57.83  17.5   17.1   24.59\n",
      "  47.75  18.84  13.64   0.72   0.53   0.18   0.02   0.06   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 67000}\n",
      "episode: 67000 | final wealth: -181.21; so far mean and variance of final wealth was -138.31137051798734 and 20738.312977742986\n",
      "episode: 67000 | so far Y(0): 354.32\n",
      "episode: 67000 | rewards: [-32.02  11.43   4.4   -0.32  11.97 -20.74  -9.22 -25.78  19.39 -29.17\n",
      "   8.98  -1.32  18.38 -70.25  -8.68 -16.89 -28.89  -3.73  -7.18  -1.57]\n",
      "episode: 67000 | action taken: [32.57 36.38 39.06 38.64 35.75 32.15 53.76 54.49 50.08 47.31 42.46 44.19\n",
      " 43.17 41.4  30.82 22.23 13.29  5.63  2.21  0.43]\n",
      "episode: 67000 | deltas [51.13 51.18 49.58 43.29 46.47 35.74 51.44 46.24 35.05 40.83 26.2  29.62\n",
      " 23.03 23.77  5.78  3.24  1.88  0.08  0.02  0.    0.  ]\n",
      "episode: 67000 | stock price [100.   100.01  99.8   98.97  99.4   98.05 100.06  99.47  98.11  98.91\n",
      "  97.17  97.7   97.13  97.51  94.92  94.83  94.37  92.7   93.29  91.48\n",
      "  92.55]\n",
      "episode: 67000 | option price [225.84 225.56 202.8  163.1  179.77 116.68 198.41 154.6  105.57 122.01\n",
      "  65.78  74.75  49.13  46.15   7.59   3.4    1.77   0.05   0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 68000}\n",
      "episode: 68000 | final wealth: -185.61; so far mean and variance of final wealth was -138.18539548158864 and 20731.95489308366\n",
      "episode: 68000 | so far Y(0): 354.16\n",
      "episode: 68000 | rewards: [ -66.78    5.54  -28.83    9.21  -11.24  -19.69   -0.35   -0.78    4.88\n",
      "    4.04    2.74    8.85  -36.44   18.45    2.57   -4.55   28.62   16.57\n",
      " -208.28   89.86]\n",
      "episode: 68000 | action taken: [32.57 41.85 49.7  51.76 56.38 62.66 70.82 72.76 73.   71.26 68.75 64.1\n",
      " 60.61 61.35 59.04 54.96 49.68 41.39 29.26 12.22]\n",
      "episode: 68000 | deltas [ 51.13  62.41  63.14  73.92  72.15  77.89  83.47  79.18  78.82  74.99\n",
      "  69.32  68.65  63.22  87.08  86.32  88.07  92.26  90.48  92.33 100.\n",
      " 100.  ]\n",
      "episode: 68000 | stock price [100.   101.61 101.61 103.1  102.76 103.49 104.38 103.62 103.54 102.91\n",
      " 102.08 101.93 101.21 103.95 103.47 103.47 103.67 102.97 102.61 105.47\n",
      " 104.09]\n",
      "episode: 68000 | option price [225.84 312.55 297.44 392.28 363.35 411.42 479.97 418.26 411.38 359.74\n",
      " 294.63 279.14 219.56 418.26 369.7  364.75 376.05 307.2  267.19 546.7\n",
      " 409.37]\n",
      "\n",
      "{'path_row': 69000}\n",
      "episode: 69000 | final wealth: 44.59; so far mean and variance of final wealth was -138.31019690345232 and 20728.77653190224\n",
      "episode: 69000 | so far Y(0): 354.27\n",
      "episode: 69000 | rewards: [ -4.55  13.4    0.85   6.06   1.64   5.12   8.36   3.62   5.11 -30.53\n",
      "  12.11  18.07  16.59   1.08   9.55  -3.14  24.58   3.68 -58.47  11.46]\n",
      "episode: 69000 | action taken: [32.57 31.93 27.57 27.25 21.84 22.62 38.08 43.78 44.46 44.21 40.8  42.92\n",
      " 47.04 51.4  45.79 42.11 37.77 26.52 11.29  2.49]\n",
      "episode: 69000 | deltas [ 51.13  39.69  30.75  37.6   24.75  25.21  24.94  34.72  33.69  35.84\n",
      "  19.05  25.79  33.06  59.74  35.97  51.83  66.33  39.58  28.05  74.15\n",
      " 100.  ]\n",
      "episode: 69000 | stock price [100.    98.44  97.3   98.37  96.63  96.87  96.97  98.34  98.34  98.6\n",
      "  96.77  97.58  98.46 100.69  99.   100.08 100.84  99.5   99.13 100.69\n",
      " 100.64]\n",
      "episode: 69000 | option price [225.84 146.9   96.56 120.88  67.3   65.65  62.07  90.74  81.66  87.16\n",
      "  36.66  54.48  71.79 156.11  64.11  98.25 129.49  50.27  25.43  86.49\n",
      "  63.51]\n",
      "\n",
      "{'path_row': 70000}\n",
      "episode: 70000 | final wealth: -23.92; so far mean and variance of final wealth was -138.40222801700008 and 20773.48389199878\n",
      "episode: 70000 | so far Y(0): 354.60\n",
      "episode: 70000 | rewards: [-11.72   2.22 -44.22 -20.4   -5.28 -46.97 -10.62   0.6   -4.42   4.29\n",
      "   1.55 -30.63  11.28  21.29   9.09   2.26  53.07   4.21  38.71   1.74]\n",
      "episode: 70000 | action taken: [32.57 29.17 24.4  33.28 36.29 44.28 58.37 65.26 69.33 63.67 59.25 56.88\n",
      " 59.16 59.59 57.33 53.06 47.67 35.5  22.28  4.02]\n",
      "episode: 70000 | deltas [51.13 33.46 31.25 48.53 50.94 60.18 76.99 76.26 78.87 52.52 57.13 69.1\n",
      " 84.79 84.31 80.66 80.89 84.76 61.87 63.96 33.12  0.  ]\n",
      "episode: 70000 | stock price [100.    97.4   97.13  99.63  99.97 101.23 103.49 103.35 103.53 100.18\n",
      " 100.65 101.83 103.62 103.31 102.63 102.44 102.52 100.64 100.62  99.42\n",
      "  98.35]\n",
      "episode: 70000 | option price [225.84 120.46 106.9  207.55 230.33 278.28 417.49 404.95 408.97 177.01\n",
      " 197.07 261.17 390.79 358.82 296.67 274.4  272.11 124.06 106.93  28.14\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 71000}\n",
      "episode: 71000 | final wealth: -152.98; so far mean and variance of final wealth was -138.41921968285084 and 20769.25747588051\n",
      "episode: 71000 | so far Y(0): 354.59\n",
      "episode: 71000 | rewards: [  -6.36   -3.67    7.7     8.54    9.     -6.34  -35.06   22.63   -2.46\n",
      "   -6.44  -41.56   27.8    18.14   15.85   11.72  -40.56   -0.01  -91.49\n",
      "  117.37 -157.77]\n",
      "episode: 71000 | action taken: [32.57 32.35 30.35 28.65 24.49 23.62 50.22 46.87 48.82 47.56 53.43 60.79\n",
      " 59.17 58.02 54.9  48.15 42.82 34.94 27.81  8.38]\n",
      "episode: 71000 | deltas [ 51.13  40.82  38.43  39.45  31.47  27.21  38.53  31.96  48.34  44.33\n",
      "  63.86  81.86  66.46  66.65  63.69  53.63  82.93  86.3   98.67  95.07\n",
      " 100.  ]\n",
      "episode: 71000 | stock price [100.    98.59  98.2   98.44  97.36  96.94  98.54  97.77  99.73  99.3\n",
      " 101.36 103.49 101.49 101.3  100.93 100.19 102.13 102.16 103.65 101.9\n",
      " 103.34]\n",
      "episode: 71000 | option price [225.84 153.63 144.46 142.27 101.07  77.69 120.97  90.97 157.14 136.79\n",
      " 239.96 389.3  231.93 201.39 162.47 107.26 234.53 230.32 365.75 192.29\n",
      " 333.65]\n",
      "\n",
      "{'path_row': 72000}\n",
      "episode: 72000 | final wealth: -388.10; so far mean and variance of final wealth was -138.46338216139208 and 20769.832839557654\n",
      "episode: 72000 | so far Y(0): 354.64\n",
      "episode: 72000 | rewards: [  -7.61   -6.73    4.04   -8.08   -5.1   -29.26  -22.72   -0.4    11.15\n",
      "    5.76   -0.19   -0.41  -15.33   12.99   12.96  -66.76   -0.37  -10.7\n",
      " -188.37  -72.97]\n",
      "episode: 72000 | action taken: [32.57 31.65 33.63 24.87 17.19 13.25 46.53 42.72 41.89 44.52 43.59 56.21\n",
      " 52.48 54.81 53.09 44.57 29.   17.6   8.32  3.29]\n",
      "episode: 72000 | deltas [ 51.13  39.19  48.42  22.05  19.47  13.12  29.29  29.73  31.07  37.06\n",
      "  32.29  64.61  49.2   73.23  70.4   38.84   8.97   8.55  44.78  96.91\n",
      " 100.  ]\n",
      "episode: 72000 | stock price [100.    98.33  99.65  95.9   95.51  94.4   97.05  97.22  97.42  98.28\n",
      "  97.84 101.46  99.85 102.18 101.76  99.07  96.15  96.59  99.73 102.66\n",
      " 103.35]\n",
      "episode: 72000 | option price [225.84 146.61 194.11  62.11  52.07  30.63  91.31  89.97  95.22 119.26\n",
      "  91.07 248.42 145.24 279.32 240.55  83.14  11.43   9.43  64.4  267.92\n",
      " 334.59]\n",
      "\n",
      "{'path_row': 73000}\n",
      "episode: 73000 | final wealth: -518.10; so far mean and variance of final wealth was -138.57758335858614 and 20785.489214657417\n",
      "episode: 73000 | so far Y(0): 354.84\n",
      "episode: 73000 | rewards: [ -34.37    1.19  -16.66    4.38  -54.49  -49.48  -12.9     2.15   -7.12\n",
      "    1.68    7.09    7.59    8.35   -7.13    9.74 -120.57   -3.79  -49.29\n",
      " -112.87  -91.61]\n",
      "episode: 73000 | action taken: [32.57 38.83 44.64 44.89 43.19 52.03 65.12 73.69 74.8  76.74 75.19 71.49\n",
      " 66.71 61.49 58.53 53.5  50.58 45.7  41.6  32.22]\n",
      "episode: 73000 | deltas [ 51.13  57.48  56.35  64.27  58.58  75.4   86.83  86.37  82.74  88.32\n",
      "  82.02  79.02  74.64  71.42  78.18  73.32  96.55  98.13  99.82 100.\n",
      " 100.  ]\n",
      "episode: 73000 | stock price [100.   100.85 100.69 101.72 100.99 103.39 105.18 105.11 104.28 105.24\n",
      " 104.18 103.52 102.72 102.15 102.83 102.21 105.91 105.97 106.82 108.68\n",
      " 109.36]\n",
      "episode: 73000 | option price [225.84 255.47 241.6  298.15 261.12 417.57 550.85 545.32 473.4  550.89\n",
      " 466.04 407.62 339.07 287.69 331.33 281.97 595.29 599.35 682.21 868.09\n",
      " 936.21]\n",
      "\n",
      "{'path_row': 74000}\n",
      "episode: 74000 | final wealth: -20.03; so far mean and variance of final wealth was -138.63479181251432 and 20805.087383860482\n",
      "episode: 74000 | so far Y(0): 354.99\n",
      "episode: 74000 | rewards: [-31.85  10.56   4.94   8.88 -10.58 -51.8  -24.04  -9.92  12.47 -52.06\n",
      "   6.57   3.1   32.15  10.05 -33.06  21.23  26.19  30.08  36.02  -8.95]\n",
      "episode: 74000 | action taken: [32.57 37.71 40.41 40.36 34.7  31.37 57.93 61.08 59.07 55.62 45.06 45.37\n",
      " 45.39 47.7  48.93 50.   43.92 32.29 19.36  2.45]\n",
      "episode: 74000 | deltas [51.13 54.46 48.98 44.22 38.46 36.34 57.38 58.59 46.79 52.12 28.18 31.68\n",
      " 31.87 44.33 56.89 79.61 72.09 60.57 50.46 13.04  0.  ]\n",
      "episode: 74000 | stock price [100.   100.46  99.73  99.12  98.43  98.1  100.85 101.    99.47 100.14\n",
      "  97.11  97.71  97.77  99.35 100.57 102.74 101.9  100.79 100.    97.93\n",
      "  97.21]\n",
      "episode: 74000 | option price [225.84 240.13 196.73 164.44 127.94 121.31 256.03 262.13 175.35 200.62\n",
      "  80.71  90.75  90.15 129.61 175.49 313.51 249.36 168.17 100.77  11.74\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 75000}\n",
      "episode: 75000 | final wealth: -423.64; so far mean and variance of final wealth was -138.69265308562996 and 20806.869996971338\n",
      "episode: 75000 | so far Y(0): 355.06\n",
      "episode: 75000 | rewards: [-172.09    0.54   -9.33   -5.28    6.65  -50.48   25.78    9.56   -0.76\n",
      "   11.77   11.66 -102.57  -22.63  -48.74  -56.21  -13.89   -5.3    -0.76\n",
      "   -0.26   -1.29]\n",
      "episode: 75000 | action taken: [32.57 55.09 62.43 60.9  58.58 55.49 46.4  46.19 46.58 45.74 45.6  49.56\n",
      " 39.03 30.75 19.62  6.45  2.91  1.81  1.04  0.33]\n",
      "episode: 75000 | deltas [51.13 77.86 71.87 55.84 51.44 46.43 27.77 39.54 41.35 42.24 37.58 43.45\n",
      " 12.15  7.1   2.33  0.29  0.04  0.    0.    0.    0.  ]\n",
      "episode: 75000 | stock price [100.   104.27 103.14 100.68 100.04  99.38  96.77  98.56  98.84  98.95\n",
      "  98.51  99.22  95.07  94.42  92.82  90.35  90.    89.26  89.38  89.8\n",
      "  88.71]\n",
      "episode: 75000 | option price [225.84 504.54 418.15 266.46 231.18 183.31  86.02 134.39 137.84 142.99\n",
      " 110.61 131.04  23.82  11.29   2.97   0.29   0.03   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 76000}\n",
      "episode: 76000 | final wealth: -92.94; so far mean and variance of final wealth was -138.7995579742492 and 20821.309815470355\n",
      "episode: 76000 | so far Y(0): 355.24\n",
      "episode: 76000 | rewards: [-16.11   7.63  -8.73   9.24  13.24   3.19   1.88 -24.89 -22.08  22.01\n",
      " -26.43 -11.02  34.96 -10.41  24.12 -50.57 -32.43   1.74  -5.83  -2.46]\n",
      "episode: 76000 | action taken: [32.57 31.96 26.89 30.23 26.38 24.55 37.84 46.35 44.15 39.47 40.93 36.72\n",
      " 32.62 32.65 29.07 27.7  17.93  8.08  3.15  0.75]\n",
      "episode: 76000 | deltas [51.13 40.4  30.66 43.7  33.78 27.23 26.36 44.35 30.71 21.8  26.34 10.37\n",
      "  6.41 14.73  9.28 17.71  0.94  0.02  0.03  0.    0.  ]\n",
      "episode: 76000 | stock price [100.    98.45  97.02  99.04  97.72  97.04  97.02  99.28  97.68  96.52\n",
      "  97.42  95.71  95.31  96.91  96.29  97.64  95.04  93.71  95.07  94.71\n",
      "  95.4 ]\n",
      "episode: 76000 | option price [225.84 158.76 104.84 163.05 110.57  75.59  70.11 141.07  83.46  52.1\n",
      "  61.06  16.01   8.23  21.49  11.66  23.46   0.64   0.01   0.01   0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 77000}\n",
      "episode: 77000 | final wealth: -228.34; so far mean and variance of final wealth was -138.76160210756464 and 20829.362536288918\n",
      "episode: 77000 | so far Y(0): 355.25\n",
      "episode: 77000 | rewards: [ -36.74   16.25   -3.19    7.28   -2.85   -1.8   -19.67    2.55   22.56\n",
      "    8.88    5.56   -1.05   -2.33  -10.65   30.7     6.4   -98.84   14.58\n",
      " -115.05  -50.92]\n",
      "episode: 77000 | action taken: [32.57 39.4  43.05 40.93 34.5  28.29 43.59 42.2  43.2  44.76 45.34 50.67\n",
      " 49.88 53.16 51.78 46.08 38.34 35.47 26.63  8.94]\n",
      "episode: 77000 | deltas [ 51.13  59.02  49.74  41.59  36.29  28.14  33.74  29.46  32.89  36.96\n",
      "  34.56  47.12  43.26  67.75  73.79  59.22  59.62  92.96  96.08  99.99\n",
      " 100.  ]\n",
      "episode: 77000 | stock price [100.   101.05  99.84  98.79  98.21  97.23  98.04  97.53  97.95  98.61\n",
      "  98.49  99.67  99.35 101.44 101.98 100.63 100.59 103.17 102.97 104.45\n",
      " 104.7 ]\n",
      "episode: 77000 | option price [225.84 264.25 193.37 147.84 114.45  77.31  95.95  78.64  92.11  97.31\n",
      "  81.59 128.91 108.36 214.3  250.28 147.89 134.12 324.21 299.32 444.72\n",
      " 470.07]\n",
      "\n",
      "{'path_row': 78000}\n",
      "episode: 78000 | final wealth: -88.68; so far mean and variance of final wealth was -138.72825309457158 and 20819.472540699742\n",
      "episode: 78000 | so far Y(0): 355.16\n",
      "episode: 78000 | rewards: [-14.17   8.84  -1.61   9.33   3.97  -1.89  -7.39  -5.08   1.08 -18.21\n",
      "  -7.28  -9.33 -10.71  -8.9   -0.98  -5.83 -10.01  -5.6   -3.14  -1.78]\n",
      "episode: 78000 | action taken: [32.57 35.04 37.42 38.71 35.79 28.83 35.11 35.3  31.75 29.48 23.86 19.03\n",
      " 15.97 12.22  8.67  7.53  5.25  2.79  1.1   0.26]\n",
      "episode: 78000 | deltas [51.13 47.7  48.67 49.01 46.1  26.97 27.37 19.34 19.31 19.19 12.83  9.12\n",
      "  3.88  1.55  0.67  0.97  0.28  0.01  0.    0.    0.  ]\n",
      "episode: 78000 | stock price [100.    99.54  99.7   99.75  99.41  97.06  97.21  96.32  96.21  96.31\n",
      "  95.2   94.71  93.9   93.19  92.66  92.97  92.24  90.69  89.48  88.\n",
      "  84.81]\n",
      "episode: 78000 | option price [225.84 192.61 186.9  187.85 164.14  73.19  72.5   42.7   43.75  42.2\n",
      "  25.51  15.86   5.11   1.65   0.61   0.93   0.23   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 79000}\n",
      "episode: 79000 | final wealth: -185.22; so far mean and variance of final wealth was -138.69192765106357 and 20831.096813929078\n",
      "episode: 79000 | so far Y(0): 355.19\n",
      "episode: 79000 | rewards: [ -9.27   4.96  17.81   2.6   -6.57  13.55  -4.34 -15.4    8.28  12.22\n",
      "  14.98 -22.84 -84.27 -89.49   3.91 -13.7  -17.21   3.02  -2.64  -0.8 ]\n",
      "episode: 79000 | action taken: [32.57 34.26 35.82 32.37 31.1  34.57 33.14 41.32 42.72 42.95 43.86 46.21\n",
      " 43.62 32.74 19.   10.32  5.73  2.45  1.77  0.41]\n",
      "episode: 79000 | deltas [51.13 45.63 46.82 35.88 40.18 43.81 32.21 35.23 31.63 31.35 28.86 29.7\n",
      " 20.92  5.72  0.61  0.72  0.12  0.    0.    0.    0.  ]\n",
      "episode: 79000 | stock price [100.    99.27  99.46  98.15  98.76  99.18  97.96  98.28  97.81  97.9\n",
      "  97.83  98.12  97.17  94.58  91.94  92.81  92.21  89.93  92.38  91.24\n",
      "  93.25]\n",
      "episode: 79000 | option price [225.84 178.76 178.62 112.54 126.3  144.6   85.51  98.86  86.68  81.07\n",
      "  65.8   62.44  39.23   7.97   0.6    0.66   0.09   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 80000}\n",
      "episode: 80000 | final wealth: -57.67; so far mean and variance of final wealth was -138.70544399155906 and 20836.439948586136\n",
      "episode: 80000 | so far Y(0): 355.23\n",
      "episode: 80000 | rewards: [-11.57 -20.95 -89.05  33.19  -7.96  15.48  19.    13.91 -11.52  13.05\n",
      "  -4.35   7.72  11.31   3.8  -33.1   24.4   21.59 -78.08  44.35  -8.89]\n",
      "episode: 80000 | action taken: [32.57 32.44 35.36 50.81 51.16 46.21 45.92 46.04 48.76 51.53 49.42 48.48\n",
      " 49.52 50.96 49.71 49.62 43.83 33.77 25.57  6.9 ]\n",
      "episode: 80000 | deltas [ 51.13  41.31  50.49  72.02  53.62  34.8   41.84  38.25  49.57  61.19\n",
      "  45.29  33.94  39.96  56.77  64.71  84.63  80.77  76.83  95.08  96.89\n",
      " 100.  ]\n",
      "episode: 80000 | stock price [100.    98.62  99.91 103.21 100.34  97.9   98.91  98.66  99.88 101.05\n",
      "  99.5   98.52  99.08 100.49 101.04 102.63 102.06 101.52 102.92 102.24\n",
      " 102.07]\n",
      "episode: 80000 | option price [225.84 159.95 222.49 425.23 230.62 113.37 139.64 108.72 151.03 217.\n",
      " 121.39  75.18  93.7  150.72 173.77 284.76 231.67 180.51 295.81 225.65\n",
      " 207.23]\n",
      "\n",
      "{'path_row': 81000}\n",
      "episode: 81000 | final wealth: -52.31; so far mean and variance of final wealth was -138.69337963719568 and 20831.785044088698\n",
      "episode: 81000 | so far Y(0): 355.19\n",
      "episode: 81000 | rewards: [ -8.47  15.89   7.46   0.28 -10.49   3.88 -18.85   1.77   6.78 -39.65\n",
      "   5.3   34.96 -34.35  17.94   6.84 -16.77  -7.01  -4.07  -8.6   -5.15]\n",
      "episode: 81000 | action taken: [32.57 33.23 34.3  33.43 25.26 29.01 42.72 41.45 41.22 41.13 34.94 31.78\n",
      " 39.11 37.1  34.74 30.14 21.85 15.02  4.9   1.1 ]\n",
      "episode: 81000 | deltas [51.13 43.07 45.39 42.2  23.49 34.41 33.11 25.89 25.77 24.64 10.33 10.87\n",
      " 36.54 14.16 16.96 13.71  4.47  1.77  0.62  0.03  0.  ]\n",
      "episode: 81000 | stock price [100.    98.9   99.31  98.95  96.56  98.06  98.    97.19  97.23  97.24\n",
      "  95.35  95.68  98.83  96.66  97.28  97.3   96.47  96.4   96.51  96.69\n",
      "  96.31]\n",
      "episode: 81000 | option price [225.84 166.06 163.06 142.08  60.92 101.53  92.09  63.3   61.84  55.3\n",
      "  17.16  17.41  79.45  21.56  24.75  16.54   3.7    1.07   0.27   0.01\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 82000}\n",
      "episode: 82000 | final wealth: -97.74; so far mean and variance of final wealth was -138.53921164566847 and 20823.31890727522\n",
      "episode: 82000 | so far Y(0): 354.99\n",
      "episode: 82000 | rewards: [-18.61  13.3  -20.67  -2.42  25.23 -12.1  -11.1    3.8   -0.4   -5.72\n",
      "  22.35  -1.05   9.09  -1.77 -69.23 -29.69   8.21  -1.62  -3.34  -2.  ]\n",
      "episode: 82000 | action taken: [32.57 34.34 35.71 41.47 41.58 41.18 52.67 58.19 59.29 56.29 56.36 53.86\n",
      " 50.96 49.14 43.36 30.77 19.75 13.6   4.58  1.2 ]\n",
      "episode: 82000 | deltas [51.13 46.12 46.37 59.45 59.56 48.5  62.16 69.77 63.19 54.84 68.96 57.59\n",
      " 50.43 47.08 33.76  8.27  3.48  4.52  3.3   1.56  0.  ]\n",
      "episode: 82000 | stock price [100.    99.3   99.4  101.07 101.06  99.72 101.27 102.06 101.28 100.41\n",
      " 101.85 100.61  99.98  99.72  98.74  96.04  95.25  96.23  96.43  97.22\n",
      "  98.69]\n",
      "episode: 82000 | option price [225.84 189.11 177.3  256.27 252.77 171.47 247.16 288.1  233.37 180.84\n",
      " 264.7  172.47 136.95 111.85  63.65  10.31   3.45   4.01   2.44   0.7\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 83000}\n",
      "episode: 83000 | final wealth: -106.64; so far mean and variance of final wealth was -138.58956351186634 and 20830.738018612017\n",
      "episode: 83000 | so far Y(0): 355.08\n",
      "episode: 83000 | rewards: [-20.86  15.74  -0.94 -11.25  13.99   2.    -9.87  28.44 -45.27 -37.37\n",
      "  17.96  -4.56 -17.69  -4.1  -13.36 -14.73  -1.73  -0.77  -0.75  -1.52]\n",
      "episode: 83000 | action taken: [32.57 34.85 34.77 32.43 33.85 33.33 37.14 36.89 37.49 30.53 19.84 21.78\n",
      " 18.43 14.   10.98  7.06  3.76  3.07  1.48  0.44]\n",
      "episode: 83000 | deltas [51.13 47.38 43.29 39.85 46.66 42.22 37.71 21.49 28.2   9.27  4.17  9.33\n",
      "  5.51  1.81  0.92  0.1   0.    0.    0.    0.    0.  ]\n",
      "episode: 83000 | stock price [100.    99.48  98.98  98.49  99.41  98.88  98.28  96.15  97.41  94.7\n",
      "  93.36  95.21  94.73  93.65  93.58  92.55  90.97  91.31  91.26  91.74\n",
      "  91.38]\n",
      "episode: 83000 | option price [225.84 197.15 161.68 145.41 184.36 150.89 128.33  55.51  73.18  16.31\n",
      "   6.12  14.98   7.33   1.89   0.8    0.06   0.     0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 84000}\n",
      "episode: 84000 | final wealth: -263.93; so far mean and variance of final wealth was -138.5208605702806 and 20830.461764781223\n",
      "episode: 84000 | so far Y(0): 355.01\n",
      "episode: 84000 | rewards: [-100.06    3.85  -61.96    7.68  -36.96  -26.74  -10.45   13.52    7.34\n",
      "   -2.26   10.98  -32.24   35.49   -2.37  -20.21  -21.71  -24.7   -28.35\n",
      "   36.4   -11.18]\n",
      "episode: 84000 | action taken: [32.57 47.71 55.21 63.98 69.06 76.94 81.97 84.02 84.24 84.15 84.59 83.3\n",
      " 83.14 80.86 78.46 76.11 73.56 70.45 65.89 47.8 ]\n",
      "episode: 84000 | deltas [ 51.13  69.75  69.85  85.55  83.36  93.05  97.01  97.74  95.8   95.7\n",
      "  97.23  95.22  99.36  97.35  98.08  99.74  99.99 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 84000 | stock price [100.   102.71 102.52 105.13 104.51 106.49 107.69 108.05 106.84 106.38\n",
      " 106.7  105.75 107.99 105.73 105.78 106.69 107.5  108.33 109.17 107.96\n",
      " 106.82]\n",
      "episode: 84000 | option price [225.84 381.44 353.06 551.74 494.93 663.51 774.11 808.52 691.41 644.76\n",
      " 674.24 581.99 799.24 575.8  580.1  668.84 749.83 832.93 917.49 796.16\n",
      " 682.34]\n",
      "\n",
      "{'path_row': 85000}\n",
      "episode: 85000 | final wealth: -53.91; so far mean and variance of final wealth was -138.48944100325082 and 20836.09330872645\n",
      "episode: 85000 | so far Y(0): 355.01\n",
      "episode: 85000 | rewards: [-57.99  12.7    4.79 -20.11  -2.1    7.96  -6.63   3.8    9.9   13.75\n",
      "  14.36 -18.2    2.71  -8.41  -0.52  13.22  -0.16  -8.54  -9.07  -5.38]\n",
      "episode: 85000 | action taken: [32.57 40.41 44.71 43.42 32.96 27.57 44.24 44.24 45.12 44.62 45.61 50.86\n",
      " 47.95 44.64 39.65 33.26 27.58 19.3   6.39  1.23]\n",
      "episode: 85000 | deltas [51.13 60.38 50.66 45.38 24.88 31.35 34.56 36.75 38.18 38.4  36.11 47.4\n",
      " 34.21 29.31 22.43 17.48 24.89 16.03  5.85  0.92  0.  ]\n",
      "episode: 85000 | stock price [100.   101.31  99.94  99.24  96.39  97.41  98.06  98.4   98.59  98.7\n",
      "  98.61  99.71  98.53  98.23  97.69  97.47  98.36  97.92  97.23  97.16\n",
      "  97.54]\n",
      "episode: 85000 | option price [225.84 294.   217.82 177.32  72.64  98.29 103.   108.28 112.82 107.19\n",
      "  88.89 123.88  76.78  56.73  37.69  24.49  34.62  17.14   4.31   0.37\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 86000}\n",
      "episode: 86000 | final wealth: -4.88; so far mean and variance of final wealth was -138.49662232688104 and 20828.492350262113\n",
      "episode: 86000 | so far Y(0): 354.98\n",
      "episode: 86000 | rewards: [-25.71 -12.9   17.82 -17.55  -9.25  -7.1  -46.2    5.62 -32.3  -17.51\n",
      "  -3.54   3.38  -6.66 -41.58  -0.15  43.63 -13.47  11.29  12.43 134.87]\n",
      "episode: 86000 | action taken: [32.57 37.49 44.13 42.85 42.59 46.65 54.28 63.18 67.81 72.09 75.13 75.51\n",
      " 74.86 74.19 75.03 75.27 71.99 67.53 59.82 41.81]\n",
      "episode: 86000 | deltas [ 51.13  53.94  58.87  46.9   59.42  61.77  68.78  81.32  80.38  90.12\n",
      "  92.87  94.84  95.25  97.43  99.64  99.84  99.59  99.91  99.98 100.\n",
      " 100.  ]\n",
      "episode: 86000 | stock price [100.   100.38 101.03  99.5  101.06 101.38 102.2  104.09 103.7  105.46\n",
      " 106.17 106.39 106.28 106.69 108.39 108.37 106.59 106.96 106.46 105.95\n",
      " 102.57]\n",
      "episode: 86000 | option price [225.84 231.52 263.79 171.53 254.64 277.42 318.72 459.77 419.73 566.66\n",
      " 630.93 647.65 635.79 672.37 839.74 837.38 659.32 695.61 646.26 594.89\n",
      " 256.66]\n",
      "\n",
      "{'path_row': 87000}\n",
      "episode: 87000 | final wealth: -135.04; so far mean and variance of final wealth was -138.55996952938347 and 20835.228653451148\n",
      "episode: 87000 | so far Y(0): 355.08\n",
      "episode: 87000 | rewards: [-53.11  -5.06   4.06  -0.86  -1.72 -19.7   -1.83  14.18 -11.47 -34.23\n",
      "   1.06  -2.8    7.88  -3.44 -16.19  -9.57  -0.68  -0.13   0.68  -2.14]\n",
      "episode: 87000 | action taken: [32.57 38.83 44.53 43.48 37.41 31.47 22.13 27.59 27.57 19.53 10.21 14.21\n",
      " 13.48 13.77 10.2   5.54  3.25  2.8   1.42  0.5 ]\n",
      "episode: 87000 | deltas [51.13 57.04 55.62 50.54 44.56 32.45 22.94 19.52 23.1  12.96  3.63  6.25\n",
      "  4.42  5.62  3.24  0.78  0.12  0.03  0.    0.    0.  ]\n",
      "episode: 87000 | stock price [100.   100.85 100.65  99.92  99.05  97.28  95.54  95.11  96.13  94.42\n",
      "  91.84  93.27  93.05  93.82  93.27  91.66  90.57  90.97  91.07  92.43\n",
      "  90.76]\n",
      "episode: 87000 | option price [225.84 274.21 265.08 222.5  184.61 114.11  73.3   56.67  65.4   29.83\n",
      "   6.1   11.11   6.94   8.78   4.37   0.84   0.1    0.02   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 88000}\n",
      "episode: 88000 | final wealth: -378.39; so far mean and variance of final wealth was -138.6021435521571 and 20851.65016312206\n",
      "episode: 88000 | so far Y(0): 355.20\n",
      "episode: 88000 | rewards: [-58.28   3.86   0.89  10.52   1.5   -9.82   3.4  -16.85  -2.53   0.29\n",
      " -22.09  -9.03 -27.5  -66.    12.18 -84.2  -48.14  21.55 -65.14 -23.02]\n",
      "episode: 88000 | action taken: [32.57 39.73 46.54 46.31 42.09 36.95 41.72 45.4  51.59 54.36 57.76 61.15\n",
      " 62.18 63.79 63.8  62.43 61.66 59.98 54.9  37.76]\n",
      "episode: 88000 | deltas [ 51.13  59.1   57.74  56.31  48.94  36.    45.05  41.33  61.46  66.21\n",
      "  72.56  83.95  88.13  93.78  99.08  99.43  99.99 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 88000 | stock price [100.   101.15 100.92 100.71  99.72  98.06  99.24  98.81 101.31 101.84\n",
      " 102.49 103.88 104.34 105.37 107.39 107.07 109.28 110.52 109.93 111.25\n",
      " 110.65]\n",
      "episode: 88000 | option price [ 225.84  288.94  268.92  251.11  194.81  119.14  167.3   141.31  268.08\n",
      "  291.52  323.75  422.68  456.39  547.04  740.27  707.44  928.46 1051.87\n",
      "  993.36 1125.4  1064.62]\n",
      "\n",
      "{'path_row': 89000}\n",
      "episode: 89000 | final wealth: 30.25; so far mean and variance of final wealth was -138.58768207618422 and 20863.227932214817\n",
      "episode: 89000 | so far Y(0): 355.25\n",
      "episode: 89000 | rewards: [-47.18  11.75  14.56 -10.05  -5.03 -19.8  -21.08  11.73  -3.4   14.44\n",
      "   7.05  -3.88  -9.6  -17.24   6.14  34.18   7.23  16.98  44.44  -1.02]\n",
      "episode: 89000 | action taken: [32.57 39.47 41.88 40.78 32.14 23.88 50.71 48.99 47.03 44.36 46.39 49.6\n",
      " 54.85 51.32 51.81 48.79 41.48 31.56 19.65  2.82]\n",
      "episode: 89000 | deltas [51.13 58.86 47.33 44.25 25.23 23.11 39.21 35.28 35.91 33.5  39.3  41.47\n",
      " 67.22 42.03 73.46 77.09 68.77 67.96 60.76 27.32  0.  ]\n",
      "episode: 89000 | stock price [100.   101.07  99.48  99.14  96.65  96.45  98.62  98.26  98.45  98.21\n",
      "  98.92  99.18 101.43  99.26 102.02 102.17 101.22 101.04 100.53  99.1\n",
      "  96.97]\n",
      "episode: 89000 | option price [225.84 275.42 193.85 162.41  70.1   60.36 124.05 100.28  96.2   86.19\n",
      " 100.69 103.55 215.8  101.36 256.53 257.85 174.02 151.93 108.81  24.4\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 90000}\n",
      "episode: 90000 | final wealth: -164.35; so far mean and variance of final wealth was -138.61494132143005 and 20858.637207580618\n",
      "episode: 90000 | so far Y(0): 355.25\n",
      "episode: 90000 | rewards: [-10.67   0.92 -18.34 -32.89  -1.88   0.15 -12.44  -5.21  -3.05  10.23\n",
      "   0.66  -2.8  -30.26  12.24  40.44  -5.9   21.5  -14.94 -67.86 -44.28]\n",
      "episode: 90000 | action taken: [32.57 28.62 23.79 27.19 36.46 38.02 46.77 52.65 57.15 58.03 56.04 51.78\n",
      " 56.22 58.19 57.34 52.01 45.73 34.44 23.75  6.02]\n",
      "episode: 90000 | deltas [ 51.13  32.01  30.78  39.1   50.97  47.38  50.61  59.32  68.7   68.46\n",
      "  62.94  43.9   70.43  83.97  83.55  65.41  72.76  69.13  79.17  96.58\n",
      " 100.  ]\n",
      "episode: 90000 | stock price [100.    97.19  97.07  98.3   99.98  99.48  99.94 101.11 102.29 102.24\n",
      " 101.46  99.21 102.13 103.76 103.45 101.31 101.89 101.36 101.85 102.93\n",
      " 103.16]\n",
      "episode: 90000 | option price [225.84 112.54 104.24 147.27 222.35 196.77 212.42 270.84 332.28 328.11\n",
      " 271.55 142.67 292.66 410.23 377.86 213.87 244.54 191.97 212.42 295.07\n",
      " 316.29]\n",
      "\n",
      "{'path_row': 91000}\n",
      "episode: 91000 | final wealth: -278.11; so far mean and variance of final wealth was -138.59492834059773 and 20863.26697817101\n",
      "episode: 91000 | so far Y(0): 355.26\n",
      "episode: 91000 | rewards: [-42.22 -41.96  -7.27  11.19   1.16   4.22 -48.92 -19.71  -9.42 -49.42\n",
      " -65.11  -5.52  13.94  -6.97  11.17   0.99  -7.86 -10.73  -3.1   -2.58]\n",
      "episode: 91000 | action taken: [32.57 39.97 52.2  56.29 61.04 62.52 63.28 56.89 51.42 44.37 36.87 26.93\n",
      " 18.31 18.03 14.42 14.52 11.97  7.76  2.49  0.71]\n",
      "episode: 91000 | deltas [51.13 60.11 75.31 76.03 73.44 68.67 56.82 33.37 27.19 25.64 13.75  4.34\n",
      "  3.82  6.95  3.31  4.57  2.56  0.49  0.01  0.    0.  ]\n",
      "episode: 91000 | stock price [100.   101.21 103.14 103.14 102.65 102.03 100.63  98.11  97.45  97.27\n",
      "  95.55  93.43  93.53  94.98  94.27  95.36  95.25  94.63  93.72  94.46\n",
      "  94.14]\n",
      "episode: 91000 | option price [225.84 274.75 386.57 381.14 338.03 294.47 201.32  89.56  65.53  60.33\n",
      "  26.78   6.41   5.27   9.9    3.86   4.96   2.27   0.31   0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 92000}\n",
      "episode: 92000 | final wealth: -187.31; so far mean and variance of final wealth was -138.57650219641957 and 20867.93434429516\n",
      "episode: 92000 | so far Y(0): 355.26\n",
      "episode: 92000 | rewards: [-11.38   8.3    4.45 -13.36  -0.39  -8.57 -50.97 -40.26  24.87  -5.68\n",
      " -37.53   9.69  -0.28 -51.75   1.76  -5.6   -6.4    0.8   -3.53  -1.49]\n",
      "episode: 92000 | action taken: [32.57 35.52 34.43 30.34 19.32 16.75 43.84 37.54 29.19 26.81 23.06 14.15\n",
      " 19.08 17.23  8.04  7.11  4.97  3.09  1.68  0.38]\n",
      "episode: 92000 | deltas [51.13 48.86 41.01 34.88 16.94 16.53 26.83 18.75 11.24 17.73 12.75  3.34\n",
      "  4.97  4.89  0.17  0.3   0.05  0.    0.    0.    0.  ]\n",
      "episode: 92000 | stock price [100.    99.71  98.69  97.89  95.19  95.5   97.11  95.93  94.46  96.09\n",
      "  95.44  93.13  94.54  94.75  91.5   92.77  92.08  91.18  91.99  90.66\n",
      "  90.77]\n",
      "episode: 92000 | option price [225.84 195.29 147.62 114.74  42.24  37.96  71.12  44.09  23.25  37.99\n",
      "  24.02   4.63   6.54   6.15   0.14   0.23   0.03   0.     0.     0.\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 93000}\n",
      "episode: 93000 | final wealth: -48.16; so far mean and variance of final wealth was -138.57527013588492 and 20874.40466865767\n",
      "episode: 93000 | so far Y(0): 355.29\n",
      "episode: 93000 | rewards: [-30.25 -26.91  18.14   2.29 -24.78   8.06 -42.32 -36.45  22.98  11.86\n",
      "   0.75 -15.33  -8.29  10.59  -5.32  12.08 -27.51 -11.96  54.46  39.77]\n",
      "episode: 93000 | action taken: [32.57 36.44 44.25 42.63 40.64 45.82 51.32 60.75 67.81 67.9  63.59 57.\n",
      " 51.98 46.1  42.26 43.48 37.56 31.19 19.88  3.45]\n",
      "episode: 93000 | deltas [ 51.13  51.31  60.88  43.82  54.39  62.85  61.06  78.54  87.42  73.31\n",
      "  57.89  48.51  31.55  29.    29.73  60.28  59.1   76.51  87.55  83.13\n",
      " 100.  ]\n",
      "episode: 93000 | stock price [100.   100.03 101.38  99.03 100.43 101.55 101.25 103.62 105.08 102.7\n",
      " 100.72  99.8   98.39  98.18  98.44 100.69 100.54 101.59 101.96 101.14\n",
      " 100.63]\n",
      "episode: 93000 | option price [225.84 224.44 296.66 166.83 222.42 290.71 263.9  422.19 537.42 345.49\n",
      " 199.36 135.54  64.31  56.58  52.32 148.62 129.08 189.8  207.05 124.67\n",
      "  63.05]\n",
      "\n",
      "{'path_row': 94000}\n",
      "episode: 94000 | final wealth: -69.27; so far mean and variance of final wealth was -138.66990867032328 and 20882.37958474826\n",
      "episode: 94000 | so far Y(0): 355.43\n",
      "episode: 94000 | rewards: [-24.72  17.83   5.82   9.92   0.13   2.29 -22.66  34.63  -2.73   4.03\n",
      "  -4.08 -25.47 -18.22  25.04 -63.83 -33.65  26.46  65.14 -75.42  10.26]\n",
      "episode: 94000 | action taken: [32.57 34.84 32.42 27.92 22.86 26.67 39.29 39.76 46.26 45.97 45.7  55.38\n",
      " 56.42 57.37 56.15 54.48 50.73 44.35 32.57 14.84]\n",
      "episode: 94000 | deltas [ 51.13  47.43  37.65  33.48  26.88  31.53  27.69  22.6   41.82  41.88\n",
      "  35.18  66.65  75.98  85.9   82.38  95.45  98.45  98.84  97.17  99.98\n",
      " 100.  ]\n",
      "episode: 94000 | stock price [100.    99.47  98.16  97.65  96.92  97.72  97.32  96.62  99.09  99.12\n",
      "  98.54 101.43 102.39 103.4  102.68 104.64 105.42 104.82 103.5  104.47\n",
      " 103.95]\n",
      "episode: 94000 | option price [225.84 200.84 135.02 110.31  75.71  88.9   72.06  54.97 118.39 115.98\n",
      "  84.72 220.68 289.79 363.85 296.41 468.86 543.62 482.48 352.47 447.23\n",
      " 395.32]\n",
      "\n",
      "{'path_row': 95000}\n",
      "episode: 95000 | final wealth: -54.69; so far mean and variance of final wealth was -138.62157561176488 and 20886.483424048194\n",
      "episode: 95000 | so far Y(0): 355.40\n",
      "episode: 95000 | rewards: [-17.32   0.2   -9.92  15.81   8.78  -3.05 -19.64 -15.05  -5.74  -8.67\n",
      " -11.15   4.11   3.3   13.51  13.01  10.23 -30.43   4.52  -2.95  -4.21]\n",
      "episode: 95000 | action taken: [32.57 33.   34.53 36.8  35.09 29.52 23.98 24.96 16.95 15.3  11.49  8.32\n",
      "  9.75  9.54 11.99 14.35 20.68 12.36  4.44  1.23]\n",
      "episode: 95000 | deltas [51.13 42.91 47.16 50.69 44.04 31.72 22.66 13.72  8.43  6.95  4.15  1.56\n",
      "  2.13  1.96  3.53  5.33 21.79  1.48  2.53  1.54  0.  ]\n",
      "episode: 95000 | stock price [100.    98.82  99.46  99.94  99.07  97.45  96.21  94.43  93.25  93.1\n",
      "  92.22  91.13  92.07  92.5   94.12  95.54  98.07  95.51  96.56  97.4\n",
      "  96.96]\n",
      "episode: 95000 | option price [225.84 172.32 192.64 217.72 167.45 100.3   61.33  32.9   17.57  13.35\n",
      "   7.04   2.13   2.89   2.47   4.31   5.96  29.78   1.04   1.63   0.65\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 96000}\n",
      "episode: 96000 | final wealth: -32.81; so far mean and variance of final wealth was -138.57173706618963 and 20881.06443768352\n",
      "episode: 96000 | so far Y(0): 355.33\n",
      "episode: 96000 | rewards: [-47.43 -48.39   2.04 -12.01  19.26  13.66  -5.56 -20.53  19.79  10.16\n",
      "   5.37   3.85   2.39 -12.02 -12.34   6.76   1.19   9.52   7.18  24.31]\n",
      "episode: 96000 | action taken: [32.57 36.44 47.46 47.91 50.16 54.16 54.94 55.81 50.83 47.5  49.19 54.83\n",
      " 50.79 49.99 43.21 34.3  26.49 22.53  8.68  1.92]\n",
      "episode: 96000 | deltas [51.13 51.37 66.54 66.84 71.39 67.62 54.92 48.3  32.95 40.96 48.55 60.72\n",
      " 47.79 51.66 30.76 20.66 20.66 40.23 40.08 35.84  0.  ]\n",
      "episode: 96000 | stock price [100.   100.03 102.35 102.27 102.96 102.26 100.5   99.65  97.76  98.84\n",
      "  99.75 101.01  99.72 100.09  98.22  97.39  97.72  99.39  99.49  99.47\n",
      "  98.75]\n",
      "episode: 96000 | option price [225.84 241.56 370.57 353.71 398.16 341.77 228.5  186.7  100.55 131.23\n",
      " 160.73 215.84 135.62 147.58  65.6   35.4   31.15  66.64  55.39  34.32\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 97000}\n",
      "episode: 97000 | final wealth: -97.58; so far mean and variance of final wealth was -138.50653089145456 and 20875.40786947138\n",
      "episode: 97000 | so far Y(0): 355.23\n",
      "episode: 97000 | rewards: [-30.69   1.19  -1.07  -5.61 -82.62  32.52  -5.02   2.34  -2.58 -19.69\n",
      " -32.41  45.8   10.89 -32.63  45.07 -20.39 -67.82  98.51 -72.25  38.88]\n",
      "episode: 97000 | action taken: [32.57 38.34 43.57 42.92 43.78 55.19 62.36 68.27 70.94 72.16 74.   74.41\n",
      " 72.   68.34 65.82 60.81 54.07 46.57 34.2  17.45]\n",
      "episode: 97000 | deltas [ 51.13  56.18  55.29  52.09  63.38  85.14  77.58  76.29  79.84  86.19\n",
      "  94.51  98.79  95.18  94.81  98.28  94.63  98.14  99.96  99.62 100.\n",
      " 100.  ]\n",
      "episode: 97000 | stock price [100.   100.68 100.55 100.14 101.52 104.55 103.1  102.92 103.15 103.8\n",
      " 105.11 106.53 104.55 104.07 105.11 103.61 104.1  105.45 103.46 104.36\n",
      " 103.46]\n",
      "episode: 97000 | option price [225.84 246.18 234.23 211.93 276.28 490.57 365.97 352.57 359.65 405.91\n",
      " 518.6  654.38 460.86 413.06 512.93 366.22 411.03 545.01 345.72 436.14\n",
      " 346.01]\n",
      "\n",
      "{'path_row': 98000}\n",
      "episode: 98000 | final wealth: -443.96; so far mean and variance of final wealth was -138.51765517895177 and 20872.54541185795\n",
      "episode: 98000 | so far Y(0): 355.23\n",
      "episode: 98000 | rewards: [ -52.88  -37.89   -8.43   15.96  -28.87    9.72    9.18   11.57   -0.71\n",
      "  -13.92  -28.1    33.32   28.84  -35.14  -72.63  -35.28  -63.9    36.37\n",
      " -103.07 -108.1 ]\n",
      "episode: 98000 | action taken: [32.57 39.76 51.33 54.21 58.35 64.36 69.3  70.69 67.02 64.41 64.19 64.03\n",
      " 63.59 61.48 59.47 57.39 53.17 48.19 40.53 30.2 ]\n",
      "episode: 98000 | deltas [ 51.13  59.31  70.44  70.97  66.23  77.92  73.59  75.14  62.68  60.16\n",
      "  79.92  91.12  85.58  75.51  92.07  99.15  99.89 100.   100.   100.\n",
      " 100.  ]\n",
      "episode: 98000 | stock price [100.   101.15 102.73 102.76 101.97 103.75 102.92 102.88 101.19 100.9\n",
      " 103.09 104.67 103.46 102.08 103.87 105.84 106.63 107.9  107.1  108.69\n",
      " 109.61]\n",
      "episode: 98000 | option price [225.84 283.74 377.02 374.94 313.38 442.09 372.77 355.6  223.   200.81\n",
      " 353.01 482.41 371.01 254.36 396.99 585.   663.53 790.46 709.88 869.39\n",
      " 960.75]\n",
      "\n",
      "{'path_row': 99000}\n",
      "episode: 99000 | final wealth: 64.08; so far mean and variance of final wealth was -138.57053373765737 and 20885.237125964046\n",
      "episode: 99000 | so far Y(0): 355.35\n",
      "episode: 99000 | rewards: [-65.96  16.83 -15.6   -1.25  14.56  -0.3   -6.17  19.28  10.33 -20.\n",
      "  -0.16  29.79   7.59   3.92   1.27  18.32   2.27  10.51  49.45 -10.61]\n",
      "episode: 99000 | action taken: [32.57 41.59 44.93 44.46 43.89 41.48 41.66 41.7  43.37 46.4  41.05 40.93\n",
      " 48.04 52.05 49.07 43.76 36.99 28.78 14.9   1.58]\n",
      "episode: 99000 | deltas [51.13 62.1  47.97 60.35 60.67 45.55 42.03 31.73 36.03 44.51 23.73 25.57\n",
      " 40.99 60.48 57.02 58.46 54.63 60.81 62.65  2.74  0.  ]\n",
      "episode: 99000 | stock price [100.   101.57  99.56 101.3  101.34  99.22  98.73  97.25  98.04  99.2\n",
      "  96.69  96.96  98.97 100.91 100.56 100.67 100.3  100.66 100.64  97.15\n",
      "  98.65]\n",
      "episode: 99000 | option price [225.84 310.31 200.81 291.1  293.97 185.64 163.25 107.57 120.98 159.35\n",
      "  60.08  66.19 118.59 197.16 171.05 172.03 132.05 136.27 116.89   1.52\n",
      "   0.  ]\n",
      "\n",
      "{'path_row': 100000}\n",
      "episode: 100000 | final wealth: -17.79; so far mean and variance of final wealth was -138.5771644110674 and 20877.213041757244\n",
      "episode: 100000 | so far Y(0): 355.31\n",
      "episode: 100000 | rewards: [-18.67 -70.47  -7.29  22.46   1.68   7.77  -7.48  -7.15  13.01   0.78\n",
      "  -4.56   3.14  11.67  19.7    9.6  -11.   -24.85 -21.81 -27.29  92.97]\n",
      "episode: 100000 | action taken: [32.57 35.82 48.54 49.47 49.69 51.94 54.37 58.42 58.21 57.23 54.35 57.84\n",
      " 56.3  55.98 51.72 43.31 30.77 18.27  8.68  2.4 ]\n",
      "episode: 100000 | deltas [51.13 49.71 70.53 71.61 58.75 61.63 59.39 63.16 54.95 63.53 58.75 70.15\n",
      " 68.06 71.05 51.71 38.45 23.26  7.71 50.05 70.89  0.  ]\n",
      "episode: 100000 | stock price [100.    99.82 102.75 102.81 101.02 101.38 101.04 101.54 100.5  101.51\n",
      " 100.93 102.23 101.93 102.08 100.09  99.05  97.95  96.62  99.98 100.77\n",
      "  99.95]\n",
      "episode: 100000 | option price [225.84 205.94 378.11 375.36 263.53 279.37 252.03 284.15 226.21 271.87\n",
      " 236.61 309.26 285.01 280.11 148.86  81.1   36.43   7.94  79.1  103.68\n",
      "   0.  ]\n",
      "\n"
     ]
    }
   ],
   "source": [
    " # episode for testing: 0 to 100000 inclusive\n",
    "ddpg_test.test(100001)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4e7578e8-3c7f-47ba-a1d4-52449188f9ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "import h5py"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9538581e-9c10-41b5-9fc8-9c39371c19ff",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['batch_normalization', 'batch_normalization_1', 'batch_normalization_2', 'dense', 'dense_1', 'dense_2', 'input_1', 'lambda', 'top_level_model_weights']\n"
     ]
    }
   ],
   "source": [
    "f = h5py.File('model/ddpg_actor_1.h5','r')\n",
    "ls = list(f.keys())\n",
    "print(ls)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "ae52cd0f-6069-4fd0-8365-c6fd4ec49941",
   "metadata": {},
   "outputs": [],
   "source": [
    "f.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f5d8073-cb26-41b6-b387-38509f37ab2a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
